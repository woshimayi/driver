<!--
 * @*************************************: 
 * @FilePath     : \undefinedt:\Documents\driver\tools\初始状态O1.md
 * @version      : 
 * @Author       : dof
 * @Date         : 2025-07-16 15:42:19
 * @LastEditors  : dof
 * @LastEditTime : 2025-07-16 15:42:30
 * @Descripttion :  
 * @compile      :  
 * @**************************************: 
-->

> 初始状态O1

Initial-state该状态的ONU刚刚上电，仍处于LOS/LOF。一旦接收到下行流，LOS和LOF消除，ONU 就转移到待机状态(O2)。

> 待机状态O2

Standby-state该状态的ONU已经接收到下行流，在等待接收网络参数。当ONU接收到 Upstream_Overhead消息后根据这些网络参数进行相关配置(如：定界符、功率模式、预 置的均衡时延)并转移到序列号状态(O3)。

> 序列号状态O3

Serial-Number-state OLT给所有处于该状态的ONU发送Serial-Number Request消息，以发现新的ONU以及 他们的序列号。当OLT发现了新的ONU后，ONU就等待OLT给它指配ONU-ID。OLT通过 Assign_ONU-ID消息来指配ONU-ID。ONU获得ONU-ID后就转移到测距状态(O4)

> 测距状态O4

Ranging-state不同的ONU发送信号到达OLT时应保持同步，为此每个ONU需要一个均衡时延，该参 数是在测距状态中测得的。ONU接收到Ranging_Time消息后转移到运行状态(O5)。

> 运行状态O5

Operation-state处于该状态的ONU可以在OLT的控制下发送上行数据以及PLOAM消息，该状态中的 ONU也可根据需求建立其他连接。当测距成功后，所有的ONU都依据各自的均衡时延发送 信号，以保持上行帧的同步。不同ONU发送的信号将分别到达OLT，但每个信号会正好出 现在上行帧中它应该出现的位置上。

暂停运行中的ONU：在正常运行时，OLT可能使ONU暂停发送信号以获得其它ONU的 序列号或对其它ONU进行测距。OLT持续一段时间停止对所有上行带宽的授权，ONU按照 正常的方式工作，由于没有接收到授权就不会发送信号，从而产生一个安静时段，这样OLT 就使得所有ONU暂停发送信号。

> POPUP 状态O6

POPUP-state当处于运行状态(O5)的ONU检测到LOS或LOF时就进入到该状态。在该状态中ONU 立即停止发送信号，这样OLT将检测到该ONU的LOS告警。

当ODN光纤中断时，许多ONU都会进入到该状态，从网络可靠性考虑，此时应采用以 下方式之一：
如果启用了保护倒换，所有的ONU将倒换到备用光纤上。这时所有ONU将重新进行测 距，为此OLT发送Broadcast POPUP消息通知所有ONU进入到测距状态(O4)。
如果没有保护倒换但ONU具有内部保护能力，OLT发送Directed POPUP消息通知ONU 进入运行状态(O5)。当ONU进入到O5状态时，OLT需要先对该ONU进行检测，之后再 恢复该ONU的业务。

如果ONU没有从LOS或LOF中恢复过来，ONU就不会收到Broadcast POPUP消息或 Directed POPUP消息，经过TO2时间后ONU进入初始状态(O1)。

> 紧急停止状态O7

Emergency-Stop-state当ONU接收到的Disable_Serial_Number消息带有“Disable”选项时，ONU就进入到紧急 停止状态(O7)并关闭激光器。

在O7状态下，ONU被禁止发送信号。如果ONU没有成功进入到O7状态，并且OLT仍 能继续接收到ONU发送的信号，OLT将产生Dfi告警。
当ONU的故障排除后，OLT发送带有“Enable”选项的
Disable_Serial_Number消息，从 而激活该ONU。ONU接收到消息后进入待机状态(O2)，所有的参数(包括序列号和ONU-ID) 将被重新检查。