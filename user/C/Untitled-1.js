/*
 * @*************************************: 
 * @FilePath: /user/C/Untitled-1.js
 * @version: 
 * @Author: dof
 * @Date: 2023-08-02 13:46:54
 * @LastEditors: dof
 * @LastEditTime: 2023-08-02 13:46:55
 * @Descripttion: 
 * @**************************************: 
 */

zs@zs-VirtualBox:3.9.4_0$ grep -rn "www.onenote.com" | grep  clipper
edgePageNavInject.js:30:!function(){function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return e}()({1:[function(e,t,n){"use strict";var r;!function(e){function t(e){var t=document.createElement("iframe");t.hidden=!0,t.style.display="none",t.src=e,document.body.appendChild(t)}function n(){return!window.addEventListener||navigator.appVersion.indexOf("MSIE 9")>=0}function r(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>=0)return"IE"+e.substring(t+5,e.indexOf(".",t));if(e.indexOf("Trident/")>=0){var n=e.indexOf("rv:");return"IE"+e.substring(n+3,e.indexOf(".",n))}return e.indexOf("Edge/")>=0?"Edge":void 0}function o(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=700);var r=screen.width?(screen.width-t)/2:0,o=screen.height?(screen.height-n)/2:0,i="height="+n+",width="+t+",top="+o+",left="+r+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no";return window.open(e,"_blank",i)}e.appendHiddenIframeToDocument=t,e.browserNotSupported=n,e.ieVersion=r,e.openPopupWindow=o}(r=n.BrowserUtils||(n.BrowserUtils={}))},{}],2:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(r=n.ClientType||(n.ClientType={}))},{}],3:[function(e,t,n){"use strict";var r=e("../communicator/smartValue"),o=e("../storage/remoteStorage"),i=function(){function e(){}return e.getUserSessionId=function(){return e.sessionId.get()},e.getUserSessionIdWhenDefined=function(){return new Promise(function(t){var n=e.sessionId.get();n?t(n):e.sessionId.subscribe(function(e){t(e)},{times:1,callOnSubscribe:!1})})},e.getInjectCommunicator=function(){return e.injectCommunicator},e.setInjectCommunicator=function(t){e.injectCommunicator=t},e.getExtensionCommunicator=function(){return e.extensionCommunicator},e.setExtensionCommunicator=function(t){e.extensionCommunicator=t,e.setUpRemoteStorage(t)},e.getCachedValue=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");return e.storage.getCachedValue(t)},e.getStoredValue=function(t,n,r){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValue(t,n,r)},e.preCacheStoredValues=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValues(t,function(){},!0)},e.storeValue=function(t,n){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.setValue(t,n,void 0)},e.setUpRemoteStorage=function(t){e.storage=new o.RemoteStorage(e.getExtensionCommunicator())},e}();i.sessionId=new r.SmartValue,n.Clipper=i},{"../communicator/smartValue":10,"../storage/remoteStorage":73}],4:[function(e,t,n){"use strict";var r,o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(r=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case r.Pdf:return o.InvokeSource.PdfTooltip;case r.Product:return o.InvokeSource.ProductTooltip;case r.Recipe:return o.InvokeSource.RecipeTooltip;case r.Video:return o.InvokeSource.VideoTooltip;case r.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":30}],5:[function(e,t,n){"use strict";var r,o=e("./clientType"),i=e("./constants"),a=e("./urlUtils");!function(e){function t(e,t,n){var r=a.UrlUtils.addUrlQueryValue(i.Constants.Urls.clipperFeedbackUrl,"LogCategory",n);return r=a.UrlUtils.addUrlQueryValue(r,"originalUrl",e.pageInfo.rawUrl),r=a.UrlUtils.addUrlQueryValue(r,"clipperId",e.clientInfo.clipperId),r=a.UrlUtils.addUrlQueryValue(r,"usid",t),r=a.UrlUtils.addUrlQueryValue(r,"type",o.ClientType[e.clientInfo.clipperType]),r=a.UrlUtils.addUrlQueryValue(r,"version",e.clientInfo.clipperVersion)}function n(e,t,n){return s(i.Constants.Urls.Authentication.signInUrl,e,t,n)}function r(e,t,n){return s(i.Constants.Urls.Authentication.signOutUrl,e,t,n)}function s(e,t,n,r){var o=a.UrlUtils.addUrlQueryValue(e,i.Constants.Urls.QueryParams.authType,r);return o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.clipperId,t),o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.userSessionId,n)}e.generateFeedbackUrl=t,e.generateSignInUrl=n,e.generateSignOutUrl=r}(r=n.ClipperUrls||(n.ClipperUrls={}))},{"./clientType":2,"./constants":11,"./urlUtils":75}],6:[function(e,t,n){"use strict";var r=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var r in this.functionMap)this.functionMap.hasOwnProperty(r)&&this.postMessage({data:r,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var o=t.data.toString();if(this.otherSideKeys[o]||(this.otherSideKeys[o]=!0),this.isSmartValueSubscription(o)){var i=o.substr(e.setValuePrefix.length),a=this.trackedSmartValues[i];a&&this.updateRemoteSmartValue(i,a.get())}else if(this.queuedCalls[o]){for(var s=this.queuedCalls[o],u=0;u<s.length;u++)this.postMessage(s[u]);delete this.queuedCalls[o]}}else{var l=this.functionMap[t.functionKey];if(l){var c=l(t.data);c&&c.then&&t.callbackKey&&c.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var r=n?n.param:void 0,o=void 0;n&&n.callback&&(o=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(o,n.callback));var i={data:r,functionKey:t};o&&(i.callbackKey=o),this.otherSideKeys[t]?this.postMessage(i):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(i))},e.prototype.subscribeAcrossCommunicator=function(t,n,r){r&&t.subscribe(r,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,r=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(r),this.trackedSmartValues[t]=e,e.subscribe(r)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();r.initializationKey="INITIALIZATION-K3Y",r.acknowledgeKey="ACKNOWLEDGE-K3Y",r.registrationKey="REGISTER-FUNCTION-K3Y",r.setValuePrefix="SETVALUE-",r.callbackPostfix="-CALLBACK",n.Communicator=r},{}],7:[function(e,t,n){"use strict";var r=e("./communicator"),o=function(){function e(e,t,n,o){var i=new r.Communicator(e,n);i.setErrorHandler(o),i.onInitialized=function(){var e=[];i.handleDataPackage=function(t){e.push(t)};var a=new r.Communicator(t,n);a.setErrorHandler(o),a.onInitialized=function(){i.onInitialized=void 0,a.onInitialized=void 0;for(var t=0,n=e;t<n.length;t++){var r=n[t];a.postMessage(r)}i.handleDataPackage=function(e){a.postMessage(e)},a.handleDataPackage=function(e){i.postMessage(e)}}}}return e}();n.CommunicatorPassthrough=o},{"./communicator":6}],8:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./messageHandler"),i=function(e){function t(t){var n=e.call(this)||this;return n.getOtherWindow=t,n.initMessageHandler(),window.addEventListener("message",n.messageHandler),n}return r(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t.data),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}},t.prototype.sendMessage=function(e){var t=this.getOtherWindow();t.postMessage(e,"*")},t.prototype.tearDown=function(){window.removeEventListener("message",this.messageHandler)},t}(o.MessageHandler);n.IFrameMessageHandler=i},{"./messageHandler":9}],9:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=r},{}],10:[function(e,t,n){"use strict";var r=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],r=0;r<e.length;r++)n.push(e[r].get());t.apply(this,n)})},e}();n.SmartValue=r},{}],11:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var r;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(r=e.Extension||(e.Extension={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var u;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(u=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.c="KeyC"}(l=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var f;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(f=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var d;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(d=e.Settings||(e.Settings={}));var h;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(h=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var m;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(m=e.AriaSet||(e.AriaSet={}))}(r=n.Constants||(n.Constants={}))},{}],12:[function(e,t,n){"use strict";var r=e("./objectUtils"),o=function(){function e(){}return e.readCookie=function(e,t){r.ObjectUtils.isNullOrUndefined(t)&&(t=document);for(var n=document.cookie.split(";").map(function(e){return e.split("=")}),o=0,i=n;o<i.length;o++){var a=i[o];if(a[0].trim()===e)return a[1].trim()}},e}();n.CookieUtils=o},{"./objectUtils":63}],13:[function(e,t,n){"use strict";var r,o=e("./khanAcademyVideoExtractor"),i=e("./videoUtils"),a=e("./vimeoVideoExtractor"),s=e("./YoutubeVideoExtractor");!function(e){function t(e){var t=i.SupportedVideoDomains;switch(e){case t.KhanAcademy:return new o.KhanAcademyVideoExtractor;case t.Vimeo:return new a.VimeoVideoExtractor;case t.YouTube:return new s.YoutubeVideoExtractor;default:return}}e.createVideoExtractor=t}(r=n.VideoExtractorFactory||(n.VideoExtractorFactory={}))},{"./YoutubeVideoExtractor":14,"./khanAcademyVideoExtractor":16,"./videoUtils":18,"./vimeoVideoExtractor":19}],14:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./domUtils"),i=e("./videoExtractor"),a=e("../urlUtils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",t.youTubeVideoIdQueryKey="v",t.dataOriginalSrcAttribute="data-original-src",t}return r(t,e),t.prototype.createEmbeddedVideosFromHtml=function(e){if(!e)return[];var t=document.createElement("div");t.innerHTML=e;for(var n=t.getElementsByTagName("iframe"),r=[],o=0;o<n.length;o++)if(this.isYoutubeUrl(n[o].src)){var i=this.createEmbeddedVideoFromUrl(n[o].src);i&&r.push(i)}return r},t.prototype.isYoutubeUrl=function(e){return/[^\w]youtube\.com\/watch(\?v=(\w+)|.*\&v=(\w+))/.test(e)||/[^\w]youtube\.com\/embed\/(\w+)/.test(e)},t.prototype.createEmbeddedVideoFromUrl=function(e){if(e){if(0===a.UrlUtils.getPathname(e).indexOf("/watch"))return this.createEmbeddedVideoFromId(a.UrlUtils.getQueryValue(e,this.youTubeVideoIdQueryKey));if(0===a.UrlUtils.getPathname(e).indexOf("/embed")){var t=e.match(/youtube\.com\/embed\/([^?|\/?]+)/);return this.createEmbeddedVideoFromId(t[1])}}},t.prototype.createEmbeddedVideoFromId=function(e){if(e){var t=o.DomUtils.createEmbedVideoIframe(),n="https://www.youtube.com/embed/"+e;t.src=n;var r=a.UrlUtils.addUrlQueryValue(this.youTubeWatchVideoBaseUrl,this.youTubeVideoIdQueryKey,e);return t.setAttribute(this.dataOriginalSrcAttribute,r),t}},t}(i.VideoExtractor);n.YoutubeVideoExtractor=s},{"../urlUtils":75,"./domUtils":15,"./videoExtractor":17}],15:[function(e,t,n){"use strict";var r=e("../constants"),o=e("../objectUtils"),i=e("./videoUtils"),a=e("./VideoExtractorFactory"),s=function(){function e(){}return e.cleanHtml=function(t){var n=[];for(var r in e.attributesAllowedByOnml)e.attributesAllowedByOnml.hasOwnProperty(r)&&(n=n.concat(e.attributesAllowedByOnml[r]));var o=e.htmlTags.concat(e.markupTags).concat(e.tableTags),i=sanitizeHtml(t,{allowedTags:o,allowedAttributes:e.attributesAllowedByOnml,allowedSchemes:sanitizeHtml.defaults.allowedSchemes.concat(["data"]),allowedClasses:{"*":["MainArticleContainer"]}});return i},e.removeStylesWithBase64EncodedBinaries=function(t){e.domReplacer(t,"style",function(e){return e.innerHTML.indexOf("data:application")!==-1?void 0:e})},e.removeElementsNotSupportedInOnml=function(t){e.domReplacer(t,e.tagsNotSupportedInOnml.join());var n=[e.tags.main,e.tags.article,e.tags.figure,e.tags.header,e.tags.center];e.domReplacer(t,n.join(),function(t){var n=document.createElement("div");return n.innerHTML=e.cleanHtml(t.innerHTML),n})},e.domReplacer=function(e,t,n){void 0===n&&(n=function(){});for(var r=e.querySelectorAll(t),o=0;o<r.length;o++){var i=r[o];try{var a=n(i,o);a?i!==a&&i.parentNode.replaceChild(a,i):i.parentNode.removeChild(i)}catch(e){}}},e.domReplacerAsync=function(e,t,n){return void 0===n&&(n=function(){return Promise.resolve(void 0)}),new Promise(function(r){var o=e.querySelectorAll(t),i=0;0===o.length&&r();for(var a=function(e){var t=o[e];n(t,e).then(function(e){e?t!==e&&t.parentNode.replaceChild(e,t):t.parentNode.removeChild(t)},function(){}).then(function(){++i===o.length&&r()})},s=0;s<o.length;s++)a(s)})},e.getPageContentType=function(e){var t=e.createElement("a");if(t.href=e.URL,/\.pdf$/i.test(t.pathname))return OneNoteApi.ContentType.EnhancedUrl;var n=e.querySelector("embed");return n&&/application\/pdf/i.test(n.type)?OneNoteApi.ContentType.EnhancedUrl:window&&window.PDFJS?OneNoteApi.ContentType.EnhancedUrl:OneNoteApi.ContentType.Html},e.fetchCanonicalUrl=function(e){var t=e.querySelectorAll("link[rel=canonical]");if(0===t.length)return e.URL;for(var n=t[0].href,r=void 0,o=1;o<t.length;o++)r=t.item(o).href,r.length<n.length&&(n=r);return n},e.getCleanDomOfCurrentPage=function(t){var n=e.cloneDocument(t);e.convertCanvasElementsToImages(n,t),e.addBaseTagIfNecessary(n,t.location),e.addImageSizeInformationToDom(n),e.removeUnwantedItems(n);var r=e.getDomString(n);return r},e.removeUnwantedItems=function(t){e.removeStylesWithBase64EncodedBinaries(t),e.removeClipperElements(t),e.removeUnwantedElements(t),e.removeUnwantedAttributes(t),e.removeUnsupportedHrefs(t)},e.addPreviewContainerStyling=function(e){e.setAttribute("style","margin-bottom: 16px")},e.addEmbeddedVideosWhereSupported=function(t,n,r){var o=i.VideoUtils.videoDomainIfSupported(r);if(!o)return Promise.resolve();var s=[];try{var u=i.SupportedVideoDomains[o],l=a.VideoExtractorFactory.createVideoExtractor(u);l&&(s=s.concat(l.createEmbeddedVideosFromPage(r,n)))}catch(e){return Promise.reject({error:JSON.stringify({doc:t.outerHTML,pageContent:n,message:e.message})})}return Promise.resolve(e.addVideosToElement(t,s))},e.createEmbedVideoIframe=function(){var e=document.createElement("iframe");return e.width="600",e.height="338",e.frameBorder="0",e.allowFullscreen=!1,e},e.addVideosToElement=function(t,n){if(!o.ObjectUtils.isNullOrUndefined(t)&&!o.ObjectUtils.isNullOrUndefined(n)&&0!==n.length){for(var r,i=[],a=0,s=n;a<s.length;a++){var u=s[a];o.ObjectUtils.isNullOrUndefined(u.src)||o.ObjectUtils.isNullOrUndefined(u.getAttribute(e.dataOriginalSrcAttribute))?i.push({srcAttribute:"",dataOriginalSrcAttribute:""}):(r=e.insertIFrame(t,u,r),r=e.insertSpacer(t,r.nextSibling),i.push({srcAttribute:u.src,dataOriginalSrcAttribute:u.getAttribute(e.dataOriginalSrcAttribute)}))}return i}},e.insertIFrame=function(e,t,n){var r;return r=o.ObjectUtils.isNullOrUndefined(n)?e.children[0]:n.nextSibling,e.insertBefore(t,r)},e.insertSpacer=function(e,t){var n=document.createElement("br");return e.insertBefore(n,t)},e.cloneDocument=function(e){return e.cloneNode(!0)},e.addBaseTagIfNecessary=function(t,n){if(!t.head){var r=t.createElement(e.tags.head),o=t.getElementsByTagName(e.tags.html)[0];o.insertBefore(r,o.children[0])}n||(n=document.location);var i=t.head.getElementsByTagName(e.tags.base);if(0===i.length){var a=n.href.split("#")[0].split("?")[0];a=a.substr(0,a.lastIndexOf("/")+1);var s=t.createElement(e.tags.base);s.href=a,t.head.insertBefore(s,t.head.firstChild)}},e.removeBlankImages=function(t){return e.domReplacerAsync(t,e.tags.img,function(t){return new Promise(function(n){
pageNav.js:2:}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();o.initializationKey="INITIALIZATION-K3Y",o.acknowledgeKey="ACKNOWLEDGE-K3Y",o.registrationKey="REGISTER-FUNCTION-K3Y",o.setValuePrefix="SETVALUE-",o.callbackPostfix="-CALLBACK",n.Communicator=o},{}],19:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("./messageHandler"),r=function(e){function t(t){var n=e.call(this)||this;return n.getOtherWindow=t,n.initMessageHandler(),window.addEventListener("message",n.messageHandler),n}return o(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t.data),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}},t.prototype.sendMessage=function(e){var t=this.getOtherWindow();t.postMessage(e,"*")},t.prototype.tearDown=function(){window.removeEventListener("message",this.messageHandler)},t}(i.MessageHandler);n.IFrameMessageHandler=r},{"./messageHandler":20}],20:[function(e,t,n){"use strict";var o=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=o},{}],21:[function(e,t,n){"use strict";var o=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],o=0;o<e.length;o++)n.push(e[o].get());t.apply(this,n)})},e}();n.SmartValue=o},{}],22:[function(e,t,n){"use strict";var o;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var o;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(o=e.Extension||(e.Extension={}));var i;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(i=e.Ids||(e.Ids={}));var r;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(r=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var l;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(l=e.KeyCodes||(e.KeyCodes={}));var p;!function(e){e.c="KeyC"}(p=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var u;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(u=e.Styles||(e.Styles={}));var g;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentationclipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(g=e.Urls||(e.Urls={}));var d;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(d=e.LogCategories||(e.LogCategories={}));var h;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(h=e.Settings||(e.Settings={}));var m;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(m=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var f;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(f=e.AriaSet||(e.AriaSet={}))}(o=n.Constants||(n.Constants={}))},{}],23:[function(e,t,n){"use strict";var o;!function(e){function t(e){return("images/"+e).toLowerCase()}e.getImageResourceUrl=t}(o=n.ExtensionUtils||(n.ExtensionUtils={}))},{}],24:[function(e,t,n){"use strict";var o;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(o=n.InvokeSource||(n.InvokeSource={}))},{}],25:[function(e,t,n){"use strict";var o;!function(t){function n(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(l){var t=l[e];if(t)return t}var n=c[e];if(n)return n;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function o(e){l=e}function i(e){return"font-family: "+r(e)+";"}function r(e){if(p[e])return p[e];var t="WebClipper.FontFamily."+s[e].toString(),o=n(t);return p[e]=a(o),p[e]}function a(e){if(!e)return"";for(var t=e.split(","),n=0;n<t.length;n++)t[n]=t[n].trim(),t[n].length>0&&t[n].indexOf(" ")>=0&&"'"!==t[n][0]&&"'"!==t[n][t.length-1]&&(t[n]="'"+t[n]+"'");return t.join(",")}var s;!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(s=t.FontFamily||(t.FontFamily={}));var l,p={},c=e("../../strings.json");t.getLocalizedString=n,t.setLocalizedStrings=o,t.getFontFamilyAsStyle=i,t.getFontFamily=r,t.formatFontFamily=a}(o=n.Localization||(n.Localization={}))},{"../../strings.json":44}],26:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../constants"),r=e("./log"),a=e("./logger"),s=function(e){function t(t){var n=e.call(this)||this;return n.communicator=t,n}return o(t,e),t.prototype.logEvent=function(e){e.timerWasStopped()||e.stopTimer(),this.sendDataPackage(r.LogMethods.LogEvent,[e.getEventCategory(),e.getEventData()])},t.prototype.logFailure=function(e,t,n,o){this.sendDataPackage(r.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){this.sendDataPackage(r.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){this.sendDataPackage(r.LogMethods.LogSessionStart,arguments)},t.prototype.logSessionEnd=function(e){this.sendDataPackage(r.LogMethods.LogSessionEnd,arguments)},t.prototype.logTrace=function(e,t,n){n?this.sendDataPackage(r.LogMethods.LogTrace,[e,t,n]):this.sendDataPackage(r.LogMethods.LogTrace,[e,t])},t.prototype.pushToStream=function(e,t){this.sendDataPackage(r.LogMethods.PushToStream,arguments)},t.prototype.logClickEvent=function(e){this.sendDataPackage(r.LogMethods.LogClickEvent,arguments)},t.prototype.setContextProperty=function(e,t){this.sendDataPackage(r.LogMethods.SetContextProperty,arguments)},t.prototype.sendDataPackage=function(e,t){var n={methodName:e,methodArgs:Object.keys(t).map(function(e){return t[e]})};this.communicator.callRemoteFunction(i.Constants.FunctionKeys.telemetry,{param:n})},t}(a.Logger);n.CommunicatorLoggerPure=s},{"../constants":22,"./log":27,"./logger":28}],27:[function(e,t,n){"use strict";function o(e,t){switch(e.methodName){case r.LogMethods.LogEvent:var n=e.methodArgs[0],o=e.methodArgs[1];t.logEvent.apply(t,[i.Event.createEvent(n,o)]);break;case r.LogMethods.LogFailure:t.logFailure.apply(t,e.methodArgs);break;case r.LogMethods.PushToStream:t.pushToStream.apply(t,e.methodArgs);break;case r.LogMethods.LogFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case r.LogMethods.LogSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case r.LogMethods.LogSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case r.LogMethods.LogClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case r.LogMethods.SetContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case r.LogMethods.LogTrace:default:t.logTrace.apply(t,e.methodArgs)}}var i=e("./submodules/event"),r=e("./submodules/logMethods");n.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,n.enableConsoleLogging="enable_console_logging",n.reportData="ReportData",n.unknownValue="unknown",n.parseAndLogDataPackage=o;var a=e("./submodules/click");n.Click=a.Click;var s=e("./submodules/context");n.Context=s.Context;var l=e("./submodules/errorUtils");n.ErrorUtils=l.ErrorUtils;var p=e("./submodules/event");n.Event=p.Event;var c=e("./submodules/failure");n.Failure=c.Failure;var u=e("./submodules/funnel");n.Funnel=u.Funnel;var g=e("./submodules/logMethods");n.LogMethods=g.LogMethods;var d=e("./submodules/noop");n.NoOp=d.NoOp;var h=e("./submodules/propertyName");n.PropertyName=h.PropertyName;var m=e("./submodules/session");n.Session=m.Session;var f=e("./submodules/status");n.Status=f.Status;var C=e("./submodules/trace");n.Trace=C.Trace},{"./submodules/click":29,"./submodules/context":30,"./submodules/errorUtils":31,"./submodules/event":32,"./submodules/failure":33,"./submodules/funnel":34,"./submodules/logMethods":35,"./submodules/noop":36,"./submodules/propertyName":37,"./submodules/session":38,"./submodules/status":39,"./submodules/trace":40}],28:[function(e,t,n){"use strict";var o=e("./log"),i=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(o.Failure.Label.JsonParse,o.Failure.Type.Unexpected,void 0,e)},e}();n.Logger=i},{"./log":27}],29:[function(e,t,n){"use strict";var o;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(o=n.Click||(n.Click={}))},{}],30:[function(e,t,n){"use strict";var o;!function(e){function t(e){return o[n[e]]}var n,o={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",ExtensionLifecycleId:"ExtensionLifecycle.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.ExtensionLifecycleId=2]="ExtensionLifecycleId",e[e.DeviceInfoId=3]="DeviceInfoId",e[e.SessionId=4]="SessionId",e[e.UserInfoId=5]="UserInfoId",e[e.UserInfoLanguage=6]="UserInfoLanguage",e[e.AuthType=7]="AuthType",e[e.BrowserLanguage=8]="BrowserLanguage",e[e.ClipperType=9]="ClipperType",e[e.ContentType=10]="ContentType",e[e.FlightInfo=11]="FlightInfo",e[e.InPrivateBrowsing=12]="InPrivateBrowsing",e[e.PageLanguage=13]="PageLanguage"}(n=e.Custom||(e.Custom={})),e.toString=t}(o=n.Context||(n.Context={}))},{}],31:[function(e,t,n){"use strict";var o,i=e("../../clientType"),r=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),l=e("../log");!function(e){function t(e){if(e){var t={};t[d[d.Error].toLowerCase()]=e.error;var n=e;return n&&void 0!==n.statusCode&&(t[d[d.StatusCode].toLowerCase()]=n.statusCode,t[d[d.Response].toLowerCase()]=n.response,t[d[d.ResponseHeaders].toLowerCase()]=n.responseHeaders,void 0!==n.timeout&&(t[d[d.Timeout].toLowerCase()]=n.timeout)),JSON.stringify(t)}}function n(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function o(t){var n={};n[r.Constants.Urls.QueryParams.failureType]=l.Failure.Type[t.properties.failureType],n[r.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),n[r.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,a.ObjectUtils.isNullOrUndefined(t.properties.failureId)||(n[r.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var o=t.clientInfo;g(n,o),LogManager.sendMiscLogRequest({label:l.Failure.Label[t.label],category:l.Failure.category,properties:n},!0)}function p(t,n,o,i){var r;throw r=i?JSON.stringify({message:i,error:n.toString()}):n.toString(),e.sendFailureLogRequest({label:l.Failure.Label.UnhandledExceptionThrown,properties:{failureType:l.Failure.Type.Unexpected,failureInfo:{error:r},failureId:"Channel "+t,stackTrace:l.Failure.getStackTrace(n)},clientInfo:o}),n}function c(e,t){void 0===t&&(t=!1);var n={};n[r.Constants.Urls.QueryParams.channel]=e.channel,n[r.Constants.Urls.QueryParams.timeoutInMs]=r.Constants.Settings.noOpTrackerTimeoutDuration.toString();var o=e.clientInfo;g(n,o),LogManager.sendMiscLogRequest({label:l.NoOp.Label[e.label],category:l.NoOp.category,properties:n},!0),t&&window&&window.alert(s.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function u(e,t){return void 0===t&&(t=!1),setTimeout(function(){c(e,t)},r.Constants.Settings.noOpTrackerTimeoutDuration)}function g(e,t){t&&(e[r.Constants.Urls.QueryParams.clientType]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:i.ClientType[t.get().clipperType],e[r.Constants.Urls.QueryParams.clipperVersion]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperVersion,e[r.Constants.Urls.QueryParams.clipperId]=a.ObjectUtils.isNullOrUndefined(t.get())?l.unknownValue:t.get().clipperId)}var d;!function(e){e[e.Error=0]="Error",e[e.StatusCode=1]="StatusCode",e[e.Response=2]="Response",e[e.ResponseHeaders=3]="ResponseHeaders",e[e.Timeout=4]="Timeout"}(d||(d={})),e.toString=t,e.clone=n,e.sendFailureLogRequest=o,e.handleCommunicatorError=p,e.sendNoOpTrackerRequest=c,e.setNoOpTrackerRequestTimeout=u}(o=n.ErrorUtils||(n.ErrorUtils={}))},{"../../clientType":1,"../../constants":22,"../../localization/localization":25,"../../objectUtils":41,"../log":27}],32:[function(e,t,n){"use strict";var o,i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("../log"),a=e("../../objectUtils");!function(e){function t(t,n){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(n);case e.Category.PromiseEvent:return new e.PromiseEvent(n);case e.Category.StreamEvent:return new e.StreamEvent(n)}}var n;!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(n=e.Category||(e.Category={}));var o;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipAugmentationOptions=6]="ClipAugmentationOptions",e[e.ClipCommonOptions=7]="ClipCommonOptions",e[e.ClipPdfOptions=8]="ClipPdfOptions",e[e.ClipRegionOptions=9]="ClipRegionOptions",e[e.ClipSelectionOptions=10]="ClipSelectionOptions",e[e.ClipToOneNoteAction=11]="ClipToOneNoteAction",e[e.CloseClipper=12]="CloseClipper",e[e.ClosePageNavTooltip=13]="ClosePageNavTooltip",e[e.CreateNotebook=14]="CreateNotebook",e[e.CreatePage=15]="CreatePage",e[e.CreateSection=16]="CreateSection",e[e.DebugFeedback=17]="DebugFeedback",e[e.DeviceIdMap=18]="DeviceIdMap",e[e.FetchNonLocalData=19]="FetchNonLocalData",e[e.FullPageScreenshotCall=20]="FullPageScreenshotCall",e[e.GetBinaryRequest=21]="GetBinaryRequest",e[e.GetCleanDom=22]="GetCleanDom",e[e.GetExistingUserInformation=23]="GetExistingUserInformation",e[e.GetFlightingAssignments=24]="GetFlightingAssignments",e[e.GetLocale=25]="GetLocale",e[e.GetLocalizedStrings=26]="GetLocalizedStrings",e[e.GetNotebookByName=27]="GetNotebookByName",e[e.GetNotebooks=28]="GetNotebooks",e[e.GetPage=29]="GetPage",e[e.GetPageContent=30]="GetPageContent",e[e.GetPages=31]="GetPages",e[e.HandleSignInEvent=32]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=33]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=34]="InvokeClipper",e[e.InvokeTooltip=35]="InvokeTooltip",e[e.InvokeWhatsNew=36]="InvokeWhatsNew",e[e.LocalFilesNotAllowedPanelShown=37]="LocalFilesNotAllowedPanelShown",e[e.PagesSearch=38]="PagesSearch",e[e.PdfByteMetadata=39]="PdfByteMetadata",e[e.PdfDataUrlMetadata=40]="PdfDataUrlMetadata",e[e.ProcessPdfIntoDataUrls=41]="ProcessPdfIntoDataUrls",e[e.RegionSelectionCapturing=42]="RegionSelectionCapturing",e[e.RegionSelectionLoading=43]="RegionSelectionLoading",e[e.RegionSelectionProcessing=44]="RegionSelectionProcessing",e[e.RetrieveUserInformation=45]="RetrieveUserInformation",e[e.SendBatchRequest=46]="SendBatchRequest",e[e.SetContextProperty=47]="SetContextProperty",e[e.SetDoNotPromptRatings=48]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=49]="ShouldShowRatingsPrompt",e[e.TooltipImpression=50]="TooltipImpression",e[e.UpdatePage=51]="UpdatePage",e[e.UserInfoUpdated=52]="UserInfoUpdated",e[e.WhatsNewImpression=53]="WhatsNewImpression"}(o=e.Label||(e.Label={}));var s=function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var n=e;this._label=n,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+r.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[r.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||a.ObjectUtils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in r.PropertyName.Reserved)if(r.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}();e.BaseEvent=s;var l=function(t){function n(e){var n=t.call(this,e)||this;if(n._logStatus=r.Status.Succeeded,n._failureType=r.Failure.Type.Unexpected,n.isEventData(e)){var o=e;n._logStatus=o.LogStatus,n._failureType=o.FailureType,n._failureInfo=r.ErrorUtils.clone(o.FailureInfo)}return n}return i(n,t),n.prototype.getEventCategory=function(){return e.Category.PromiseEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:r.ErrorUtils.clone(this._failureInfo)}},n.prototype.getStatus=function(){return r.Status[this._logStatus]},n.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},n.prototype.getFailureInfo=function(){return r.ErrorUtils.toString(this._failureInfo)},n.prototype.setFailureInfo=function(e){this._failureInfo=r.ErrorUtils.clone(e)},n.prototype.getFailureType=function(){return r.Failure.Type[this._failureType]},n.prototype.setFailureType=function(e){this._failureType=e},n}(s);e.PromiseEvent=l;var p=function(t){function n(e){var n=t.call(this,e)||this;if(n._stream=[],n.isEventData(e)){var o=e;n._stream=o.Stream}return n}return i(n,t),n.prototype.getEventCategory=function(){return e.Category.StreamEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},n.prototype.append=function(e){this._stream.push(e)},n}(s);e.StreamEvent=p,e.createEvent=t}(o=n.Event||(n.Event={}))},{"../../objectUtils":41,"../log":27}],33:[function(e,t,n){"use strict";var o;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure";var n;!function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(n=e.Type||(e.Type={})),e.getStackTrace=t;var o;!function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",
edgeDebugLoggingInject.js:1:!function(){function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return e}()({1:[function(e,t,n){"use strict";var r;!function(e){function t(e){var t=document.createElement("iframe");t.hidden=!0,t.style.display="none",t.src=e,document.body.appendChild(t)}function n(){return!window.addEventListener||navigator.appVersion.indexOf("MSIE 9")>=0}function r(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>=0)return"IE"+e.substring(t+5,e.indexOf(".",t));if(e.indexOf("Trident/")>=0){var n=e.indexOf("rv:");return"IE"+e.substring(n+3,e.indexOf(".",n))}return e.indexOf("Edge/")>=0?"Edge":void 0}function o(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=700);var r=screen.width?(screen.width-t)/2:0,o=screen.height?(screen.height-n)/2:0,i="height="+n+",width="+t+",top="+o+",left="+r+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no";return window.open(e,"_blank",i)}e.appendHiddenIframeToDocument=t,e.browserNotSupported=n,e.ieVersion=r,e.openPopupWindow=o}(r=n.BrowserUtils||(n.BrowserUtils={}))},{}],2:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(r=n.ClientType||(n.ClientType={}))},{}],3:[function(e,t,n){"use strict";var r=e("../communicator/smartValue"),o=e("../storage/remoteStorage"),i=function(){function e(){}return e.getUserSessionId=function(){return e.sessionId.get()},e.getUserSessionIdWhenDefined=function(){return new Promise(function(t){var n=e.sessionId.get();n?t(n):e.sessionId.subscribe(function(e){t(e)},{times:1,callOnSubscribe:!1})})},e.getInjectCommunicator=function(){return e.injectCommunicator},e.setInjectCommunicator=function(t){e.injectCommunicator=t},e.getExtensionCommunicator=function(){return e.extensionCommunicator},e.setExtensionCommunicator=function(t){e.extensionCommunicator=t,e.setUpRemoteStorage(t)},e.getCachedValue=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");return e.storage.getCachedValue(t)},e.getStoredValue=function(t,n,r){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValue(t,n,r)},e.preCacheStoredValues=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValues(t,function(){},!0)},e.storeValue=function(t,n){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.setValue(t,n,void 0)},e.setUpRemoteStorage=function(t){e.storage=new o.RemoteStorage(e.getExtensionCommunicator())},e}();i.sessionId=new r.SmartValue,n.Clipper=i},{"../communicator/smartValue":8,"../storage/remoteStorage":64}],4:[function(e,t,n){"use strict";var r,o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(r=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case r.Pdf:return o.InvokeSource.PdfTooltip;case r.Product:return o.InvokeSource.ProductTooltip;case r.Recipe:return o.InvokeSource.RecipeTooltip;case r.Video:return o.InvokeSource.VideoTooltip;case r.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":21}],5:[function(e,t,n){"use strict";var r,o=e("./clientType"),i=e("./constants"),a=e("./urlUtils");!function(e){function t(e,t,n){var r=a.UrlUtils.addUrlQueryValue(i.Constants.Urls.clipperFeedbackUrl,"LogCategory",n);return r=a.UrlUtils.addUrlQueryValue(r,"originalUrl",e.pageInfo.rawUrl),r=a.UrlUtils.addUrlQueryValue(r,"clipperId",e.clientInfo.clipperId),r=a.UrlUtils.addUrlQueryValue(r,"usid",t),r=a.UrlUtils.addUrlQueryValue(r,"type",o.ClientType[e.clientInfo.clipperType]),r=a.UrlUtils.addUrlQueryValue(r,"version",e.clientInfo.clipperVersion)}function n(e,t,n){return s(i.Constants.Urls.Authentication.signInUrl,e,t,n)}function r(e,t,n){return s(i.Constants.Urls.Authentication.signOutUrl,e,t,n)}function s(e,t,n,r){var o=a.UrlUtils.addUrlQueryValue(e,i.Constants.Urls.QueryParams.authType,r);return o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.clipperId,t),o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.userSessionId,n)}e.generateFeedbackUrl=t,e.generateSignInUrl=n,e.generateSignOutUrl=r}(r=n.ClipperUrls||(n.ClipperUrls={}))},{"./clientType":2,"./constants":9,"./urlUtils":66}],6:[function(e,t,n){"use strict";var r=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var r in this.functionMap)this.functionMap.hasOwnProperty(r)&&this.postMessage({data:r,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var o=t.data.toString();if(this.otherSideKeys[o]||(this.otherSideKeys[o]=!0),this.isSmartValueSubscription(o)){var i=o.substr(e.setValuePrefix.length),a=this.trackedSmartValues[i];a&&this.updateRemoteSmartValue(i,a.get())}else if(this.queuedCalls[o]){for(var s=this.queuedCalls[o],u=0;u<s.length;u++)this.postMessage(s[u]);delete this.queuedCalls[o]}}else{var l=this.functionMap[t.functionKey];if(l){var c=l(t.data);c&&c.then&&t.callbackKey&&c.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var r=n?n.param:void 0,o=void 0;n&&n.callback&&(o=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(o,n.callback));var i={data:r,functionKey:t};o&&(i.callbackKey=o),this.otherSideKeys[t]?this.postMessage(i):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(i))},e.prototype.subscribeAcrossCommunicator=function(t,n,r){r&&t.subscribe(r,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,r=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(r),this.trackedSmartValues[t]=e,e.subscribe(r)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();r.initializationKey="INITIALIZATION-K3Y",r.acknowledgeKey="ACKNOWLEDGE-K3Y",r.registrationKey="REGISTER-FUNCTION-K3Y",r.setValuePrefix="SETVALUE-",r.callbackPostfix="-CALLBACK",n.Communicator=r},{}],7:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=r},{}],8:[function(e,t,n){"use strict";var r=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],r=0;r<e.length;r++)n.push(e[r].get());t.apply(this,n)})},e}();n.SmartValue=r},{}],9:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var r;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(r=e.Extension||(e.Extension={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clippeFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var u;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(u=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.c="KeyC"}(l=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var f;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(f=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var d;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(d=e.Settings||(e.Settings={}));var h;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(h=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var v;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(v=e.AriaSet||(e.AriaSet={}))}(r=n.Constants||(n.Constants={}))},{}],10:[function(e,t,n){"use strict";var r=e("./objectUtils"),o=function(){function e(){}return e.readCookie=function(e,t){r.ObjectUtils.isNullOrUndefined(t)&&(t=document);for(var n=document.cookie.split(";").map(function(e){return e.split("=")}),o=0,i=n;o<i.length;o++){var a=i[o];if(a[0].trim()===e)return a[1].trim()}},e}();n.CookieUtils=o},{"./objectUtils":54}],11:[function(e,t,n){"use strict";var r,o=e("../objectUtils"),i=e("../urlUtils");!function(e){e[e.YouTube=0]="YouTube",e[e.Vimeo=1]="Vimeo",e[e.KhanAcademy=2]="KhanAcademy"}(r=n.SupportedVideoDomains||(n.SupportedVideoDomains={}));var a=function(){function e(){this.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",this.youTubeVideoIdQueryKey="v"}return e.videoDomainIfSupported=function(e){if(e){var t=e.toLowerCase();if(i.UrlUtils.onWhitelistedDomain(t)){var n=i.UrlUtils.getHostname(t).toLowerCase();for(var o in r){var a=r[o];if("string"==typeof a&&n.indexOf(a.toLowerCase()+".")>-1)return a}}}},e.matchRegexFromPageContent=function(e,t){if(!o.ObjectUtils.isNullOrUndefined(e)){var n,r=[];if(t.forEach(function(t){for(;n=t.exec(e);)n[2]?r.push(n[2]):n[3]&&r.push(n[3])}),0!==r.length)return r}},e}();n.VideoUtils=a},{"../objectUtils":54,"../urlUtils":66}],12:[function(e,t,n){"use strict";var r;!function(e){e[e.PUBLIC=0]="PUBLIC",e[e.GLOBAL=1]="GLOBAL",e[e.EUDB=2]="EUDB",e[e.EMEA=3]="EMEA",e[e.UNKNOWN=4]="UNKNOWN"}(r=n.DataBoundary||(n.DataBoundary={}))},{}],13:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},i=e("../communicator/smartValue"),a=e("../logging/log"),s=e("../http/HttpWithRetries"),u=e("../storage/clipperStorageKeys"),l=e("../userInfo"),c=e("../constants"),p=e("../objectUtils"),f=e("../stringUtils"),g=e("../urlUtils"),d=e("./userDataBoundaryHelper"),h=e("./DataBoundary"),v=function(){function e(e,t){this.user=new i.SmartValue,this.logger=t,this.clipperData=e}return e.prototype.updateUserInfoData=function(e,t){var n=this;return new Promise(function(i){var s=0,c=n.clipperData.getValue(u.ClipperStorageKeys.userInformation);if(c){var f=void 0;try{f=JSON.parse(c)}catch(e){n.logger.logJsonParseUnexpected(c)}f&&f.data&&p.ObjectUtils.isNumeric(f.data.accessTokenExpiration)&&(s=Math.max(1e3*f.data.accessTokenExpiration-18e4,0))}var g=function(){return n.retrieveUserInformation(e,void 0)},v=new a.Event.PromiseEvent(a.Event.Label.GetExistingUserInformation);v.setCustomProperty(a.PropertyName.Custom.UserInformationStored,!!c),n.clipperData.getFreshValue(u.ClipperStorageKeys.userInformation,g,s).then(function(e){return r(n,void 0,void 0,function(){var n,r,i,s;return o(this,function(o){switch(o.label){case 0:return n=this.isValidUserInformation(e.data),v.setCustomProperty(a.PropertyName.Custom.FreshUserInfoAvailable,n),r=this.isThirdPartyCookiesEnabled(e.data),v.setCustomProperty(a.PropertyName.Custom.WriteableCookies,r),v.setCustomProperty(a.PropertyName.Custom.UserUpdateReason,l.UpdateReason[t]),n?(i=new d.UserDataBoundaryHelper,[4,i.getUserDataBoundary(e.data)]):[3,2];case 1:return s=o.sent(),s!==h.DataBoundary[h.DataBoundary.GLOBAL]&&s!==h.DataBoundary[h.DataBoundary.PUBLIC]||LogManager.reInitLoggerForDataBoundaryChange(s),v.setCustomProperty(a.PropertyName.Custom.DataBoundary,s),e.data.dataBoundary=s,this.user.set({user:e.data,lastUpdated:e.lastUpdated,updateReason:t,writeableCookies:r}),[3,3];case 2:this.user.set({updateReason:t,writeableCookies:r}),o.label=3;case 3:return[2]}})})},function(e){v.setStatus(a.Status.Failed),v.setFailureInfo(e),n.user.set({updateReason:t})}).then(function(){n.logger.logEvent(v),i(n.user.get())})})},e.prototype.retrieveUserInformation=function(e,t){var n=this;return void 0===t&&(t=void 0),new Promise(function(r,o){var i=g.UrlUtils.addUrlQueryValue(c.Constants.Urls.Authentication.userInformationUrl,c.Constants.Urls.QueryParams.clipperId,e),u=new a.Event.PromiseEvent(a.Event.Label.RetrieveUserInformation),l=f.StringUtils.generateGuid();u.setCustomProperty(a.PropertyName.Custom.CorrelationId,l);var d={};d["Content-type"]="application/x-www-form-urlencoded",d[c.Constants.HeaderValues.correlationId]=l;var h="";p.ObjectUtils.isNullOrUndefined(t)||(h=t.replace(/\+/g,"%2B")),s.HttpWithRetries.post(i,h,d).then(function(e){var t=e.response;r({parsedResponse:t,request:e})},function(e){u.setStatus(a.Status.Failed),u.setFailureInfo(e),o(e)}).then(function(){n.logger.logEvent(u)})})},e.prototype.isValidUserInformation=function(e){return!!(e&&e.accessToken&&e.accessTokenExpiration>0&&e.authType)},e.prototype.isThirdPartyCookiesEnabled=function(e){return void 0===e.cookieInRequest||e.cookieInRequest},e}();n.AuthenticationHelper=v},{"../communicator/smartValue":8,"../constants":9,"../http/HttpWithRetries":29,"../logging/log":38,"../objectUtils":54,"../storage/clipperStorageKeys":62,"../stringUtils":65,"../urlUtils":66,"../userInfo":67,"./DataBoundary":12,"./userDataBoundaryHelper":23}],14:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../constants"),i=e("../communicator/communicator"),a=e("../logging/log"),s=e("../logging/consoleLoggerPure"),u=e("../logging/webConsole"),l=e("./injectBase"),c=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.main=function(e){var n=window;n.debugLoggingInjectObject||(n.debugLoggingInjectObject=new t(e))},t.prototype.generateInlineExtThunk=function(){return this.options.extMessageHandlerThunk},t.prototype.init=function(){this.debugLogger=new s.ConsoleLoggerPure(new u.WebConsole)},t.prototype.initializeExtCommunicator=function(e){var t=this;this.extCommunicator=new i.Communicator(e(),o.Constants.CommunicationChannels.debugLoggingInjectedAndExtension),this.extCommunicator.registerFunction(o.Constants.FunctionKeys.telemetry,function(e){a.parseAndLogDataPackage(e,t.debugLogger)})},t.prototype.initializeEventListeners=function(){var e=this;window.onbeforeunload=function(t){e.extCommunicator.callRemoteFunction(o.Constants.FunctionKeys.unloadHandler)}},t.prototype.handleConstructorError=function(e){a.ErrorUtils.sendFailureLogRequest({label:a.Failure.Label.UnhandledExceptionThrown,properties:{failureType:a.Failure.Type.Unexpected,failureInfo:{error:e.toString()},failureId:"PageNavInject",stackTrace:a.Failure.getStackTrace(e)}})},t}(l.InjectBase);n.DebugLoggingInject=c},{"../communicator/communicator":6,"../constants":9,"../logging/consoleLoggerPure":36,"../logging/log":38,"../logging/webConsole":53,"./injectBase":18}],15:[function(e,t,n){"use strict";var r=e("../webExtensionBase/webExtensionDebugLoggingInject"),o=e("../webExtensionBase/webExtension"),i=e("../webExtensionBase/webExtensionMessageHandler");o.WebExtension.browser="browser"in window?browser:chrome,r.invoke({extMessageHandlerThunk:function(){return new i.WebExtensionContentMessageHandler}})},{"../webExtensionBase/webExtension":24,"../webExtensionBase/webExtensionDebugLoggingInject":25,"../webExtensionBase/webExtensionMessageHandler":26}],16:[function(e,t,n){"use strict";var r=e("../clientType"),o=e("../constants"),i=e("../stringUtils"),a=e("../urlUtils"),s=e("../clipperUI/tooltipType"),u=e("../communicator/smartValue"),l=e("../http/HttpWithRetries"),c=e("../localization/localization"),p=e("../localization/localizationHelper"),f=e("../logging/log"),g=e("../storage/clipperStorageKeys"),d=e("../versioning/changeLog"),h=e("../versioning/changeLogHelper"),v=e("../versioning/version"),m=e("./authenticationHelper"),y=e("./tooltipHelper"),b=e("./workerPassthroughLogger"),C=function(){
clipper.js:7:e.generateSignOutUrl=o}(o=n.ClipperUrls||(n.ClipperUrls={}))},{"./clientType":3,"./constants":74,"./urlUtils":144}],69:[function(e,t,n){"use strict";var o=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var o in this.functionMap)this.functionMap.hasOwnProperty(o)&&this.postMessage({data:o,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var r=t.data.toString();if(this.otherSideKeys[r]||(this.otherSideKeys[r]=!0),this.isSmartValueSubscription(r)){var i=r.substr(e.setValuePrefix.length),a=this.trackedSmartValues[i];a&&this.updateRemoteSmartValue(i,a.get())}else if(this.queuedCalls[r]){for(var s=this.queuedCalls[r],l=0;l<s.length;l++)this.postMessage(s[l]);delete this.queuedCalls[r]}}else{var c=this.functionMap[t.functionKey];if(c){var u=c(t.data);u&&u.then&&t.callbackKey&&u.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var o=n?n.param:void 0,r=void 0;n&&n.callback&&(r=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(r,n.callback));var i={data:o,functionKey:t};r&&(i.callbackKey=r),this.otherSideKeys[t]?this.postMessage(i):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(i))},e.prototype.subscribeAcrossCommunicator=function(t,n,o){o&&t.subscribe(o,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,o=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(o),this.trackedSmartValues[t]=e,e.subscribe(o)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();o.initializationKey="INITIALIZATION-K3Y",o.acknowledgeKey="ACKNOWLEDGE-K3Y",o.registrationKey="REGISTER-FUNCTION-K3Y",o.setValuePrefix="SETVALUE-",o.callbackPostfix="-CALLBACK",n.Communicator=o},{}],70:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./messageHandler"),i=function(e){function t(t){var n=e.call(this)||this;return n.getOtherWindow=t,n.initMessageHandler(),window.addEventListener("message",n.messageHandler),n}return o(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t.data),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}},t.prototype.sendMessage=function(e){var t=this.getOtherWindow();t.postMessage(e,"*")},t.prototype.tearDown=function(){window.removeEventListener("message",this.messageHandler)},t}(r.MessageHandler);n.IFrameMessageHandler=i},{"./messageHandler":72}],71:[function(e,t,n){"use strict";var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=e("./messageHandler"),i=function(e){function t(t){var n=e.call(this)||this;return n.setOtherSide(t),n}return o(t,e),t.prototype.initMessageHandler=function(){},t.prototype.inlineMessage=function(e){this.onMessageReceived(e)},t.prototype.setOtherSide=function(e){this.otherSide=e},t.prototype.sendMessage=function(e){this.otherSide&&this.otherSide.inlineMessage(e)},t.prototype.tearDown=function(){},t}(r.MessageHandler);n.InlineMessageHandler=i},{"./messageHandler":72}],72:[function(e,t,n){"use strict";var o=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=o},{}],73:[function(e,t,n){"use strict";var o=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],o=0;o<e.length;o++)n.push(e[o].get());t.apply(this,n)})},e}();n.SmartValue=o},{}],74:[function(e,t,n){"use strict";var o;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var o;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(o=e.Extension||(e.Extension={}));var r;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(r=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var l;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(l=e.KeyCodes||(e.KeyCodes={}));var c;!function(e){e.c="KeyC"}(c=e.StringKeyCodes||(e.StringKeyCodes={}));var u;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(u=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var d;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(d=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var f;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(f=e.Settings||(e.Settings={}));var h;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(h=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var m;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(m=e.AriaSet||(e.AriaSet={}))}(o=n.Constants||(n.Constants={}))},{}],75:[function(e,t,n){"use strict";var o,r=e("../constants"),i=e("../settings"),a=e("../stringUtils"),s=e("../objectUtils"),l=e("../clipperUI/frontEndGlobals"),c=e("../clipperUI/oneNoteApiUtils"),u=e("../domParsers/domUtils"),p=e("../http/HttpWithRetries"),d=e("../logging/log");!function(e){e[e.None=0]="None",e[e.Article=1]="Article",e[e.BizCard=2]="BizCard",e[e.EntityKnowledge=3]="EntityKnowledge",e[e.Recipe=4]="Recipe",e[e.Product=5]="Product",e[e.Screenshot=6]="Screenshot",e[e.Wrapstar=7]="Wrapstar"}(o=n.AugmentationModel||(n.AugmentationModel={}));var g=function(){function e(){}return e.augmentPage=function(t,n,i){return new Promise(function(s,p){var g=new d.Event.PromiseEvent(d.Event.Label.AugmentationApiCall),f=a.StringUtils.generateGuid();g.setCustomProperty(d.PropertyName.Custom.CorrelationId,f),e.makeAugmentationRequest(t,n,i,f).then(function(n){var a=n.parsedResponse,l={ContentModel:o.None,ContentObjects:[]};if(g.setCustomProperty(d.PropertyName.Custom.CorrelationId,n.request.getResponseHeader(r.Constants.HeaderValues.correlationId)),a&&a.length>0&&a[0].ContentInHtml){l=a[0],g.setCustomProperty(d.PropertyName.Custom.AugmentationModel,o[l.ContentModel]);var c=(new DOMParser).parseFromString(l.ContentInHtml,"text/html"),p=e.getArticlePreviewElement(c);u.DomUtils.toOnml(c).then(function(){u.DomUtils.addPreviewContainerStyling(p),e.addSupportedVideosToElement(p,i,t),l.ContentInHtml=c.body.innerHTML,s(l)})}else s(l);g.setCustomProperty(d.PropertyName.Custom.AugmentationModel,o[l.ContentModel])}).catch(function(e){c.OneNoteApiUtils.logOneNoteApiRequestError(g,e),p()}).then(function(){l.Clipper.logger.logEvent(g)})})},e.getAugmentationType=function(t){var n=o[o.Article].toString();if(!t||!t.augmentationResult||!t.augmentationResult.data)return n;var r=t.augmentationResult.data.ContentModel;return e.isSupportedAugmentationType(r)&&(n=o[r].toString()),n},e.makeAugmentationRequest=function(e,t,n,o){return l.Clipper.getUserSessionIdWhenDefined().then(function(a){var s=r.Constants.Urls.augmentationApiUrl+"?renderMethod=extractAggressive&url="+e+"&lang="+t,c={};return c[r.Constants.HeaderValues.appIdKey]=i.Settings.getSetting("App_Id"),c[r.Constants.HeaderValues.noAuthKey]="true",c[r.Constants.HeaderValues.correlationId]=o,c[r.Constants.HeaderValues.userSessionIdKey]=a,p.HttpWithRetries.post(s,n,c).then(function(e){var t;try{t=JSON.parse(e.response)}catch(t){return l.Clipper.logger.logJsonParseUnexpected(e.response),Promise.reject(OneNoteApi.ErrorUtils.createRequestErrorObject(e,OneNoteApi.RequestErrorType.UNABLE_TO_PARSE_RESPONSE))}var n={parsedResponse:t,request:e};return Promise.resolve(n)})})},e.getArticlePreviewElement=function(e){var t=e.getElementsByClassName("MainArticleContainer");return s.ObjectUtils.isNullOrUndefined(t)||s.ObjectUtils.isNullOrUndefined(t[0])?e.body:t[0]},e.isSupportedAugmentationType=function(e){return e===o.Article||e===o.Recipe||e===o.Product},e.addSupportedVideosToElement=function(e,t,n){var o=new d.Event.PromiseEvent(d.Event.Label.AddEmbeddedVideo);u.DomUtils.addEmbeddedVideosWhereSupported(e,t,n).then(function(e){s.ObjectUtils.isNullOrUndefined(e)||l.Clipper.logger.logEvent(o)},function(e){o.setStatus(d.Status.Failed),o.setFailureInfo(e),l.Clipper.logger.logEvent(o)})},e}();n.AugmentationHelper=g},{"../clipperUI/frontEndGlobals":49,"../clipperUI/oneNoteApiUtils":51,"../constants":74,"../domParsers/domUtils":83,"../http/HttpWithRetries":102,"../logging/log":110,"../objectUtils":125,"../settings":137,"../stringUtils":143}],76:[function(e,t,n){"use strict";var o=e("../objectUtils"),r=e("../clipperUI/frontEndGlobals"),i=e("../domParsers/domUtils"),a=e("../logging/log"),s=function(){function e(){}return e.bookmarkPage=function(t,n,s,l,c,u){void 0===l&&(l=!1);var p=new a.Event.PromiseEvent(a.Event.Label.BookmarkPage);if(o.ObjectUtils.isNullOrUndefined(t)||""===t){var d={error:"Page url is null, undefined, or empty"};return p.setStatus(a.Status.Failed),p.setFailureInfo(d),r.Clipper.logger.logEvent(p),Promise.reject(d)}var g={url:t,title:n},f={metadataElementsExist:!0,pageTitleExists:!0,descriptionMetadataUsed:"",thumbnailSrcMetadataUsed:"",thumbnailSrcToDataUrlFailure:void 0};if((o.ObjectUtils.isNullOrUndefined(n)||0===n.length)&&(f.pageTitleExists=!1),o.ObjectUtils.isNullOrUndefined(s)||0===s.length)return f.metadataElementsExist=!1,r.Clipper.logger.logEvent(p),Promise.resolve(g);var h=this.getPrimaryDescription(s);l&&o.ObjectUtils.isNullOrUndefined(h)&&(h=e.getFallbackDescription(s),o.ObjectUtils.isNullOrUndefined(h)&&(h=e.getTextOnPage(u)));var m=this.getPrimaryThumbnailSrc(s);return l&&o.ObjectUtils.isNullOrUndefined(m)&&(m=e.getFallbackThumbnailSrc(s),o.ObjectUtils.isNullOrUndefined(m)&&(m=e.getFirstImageOnPage(c))),o.ObjectUtils.isNullOrUndefined(h)||(h.description=e.truncateString(h.description),g.description=h.description,f.descriptionMetadataUsed=h.metadataUsed.value),o.ObjectUtils.isNullOrUndefined(m)?(r.Clipper.logger.logEvent(p),Promise.resolve(g)):(f.thumbnailSrcMetadataUsed=m.metadataUsed.value,m.thumbnailSrc=i.DomUtils.toAbsoluteUrl(m.thumbnailSrc,t),i.DomUtils.getImageDataUrl(m.thumbnailSrc).then(function(e){o.ObjectUtils.isNullOrUndefined(e)?(g.thumbnailSrc=m.thumbnailSrc,f.thumbnailSrcToDataUrlFailure="thumbnail conversion to data url returned undefined. falling back to non-data url as source: "+m.thumbnailSrc):g.thumbnailSrc=e}).catch(function(e){f.thumbnailSrcToDataUrlFailure=e.error}).then(function(){return r.Clipper.logger.logEvent(p),Promise.resolve(g)}))},e.getElementsByTagName=function(e,t){if(!o.ObjectUtils.isNullOrUndefined(e)&&!o.ObjectUtils.isNullOrUndefined(t)){for(var n=new Array,r=0,i=t;r<i.length;r++){var a=i[r];n=n.concat(n,Array.prototype.slice.call(e.getElementsByTagName(a)))}return n}},e.getNonWhiteSpaceTextElements=function(e,t){return void 0===t&&(t=!1),t&&i.DomUtils.removeElementsNotSupportedInOnml(e),i.DomUtils.textNodesNoWhitespaceUnder(e)},e.getPrimaryDescription=function(t){var n=e.primaryDescriptionKeyValuePair,r=e.getMetaContent(t,n);if(!o.ObjectUtils.isNullOrUndefined(r))return{metadataUsed:n,description:r}},e.getFallbackDescription=function(t){for(var n=0,r=e.fallbackDescriptionKeyValuePairs;n<r.length;n++){var i=r[n],a=e.getMetaContent(t,i);if(!o.ObjectUtils.isNullOrUndefined(a))return{metadataUsed:i,description:a}}},e.getTextOnPage=function(t,n){if(void 0===n&&(n=50),!o.ObjectUtils.isNullOrUndefined(t)&&t.length>0){var r=e.textOnPageKeyValuePair,i=t.map(function(e){return e.wholeText.trim()}).join(" ");if(!o.ObjectUtils.isNullOrUndefined(i)&&i.length>0)return{metadataUsed:r,description:i}}},e.truncateString=function(t,n){if(void 0===n&&(n=e.maxNumCharsInDescription),!o.ObjectUtils.isNullOrUndefined(t)){if(0===t.length)return"";if(t.length<=n)return t;var r="...",i=new RegExp("^(.{"+n+"}[^\\s]*)"),a=t.replace(/\s+/g," ").match(i);if(!o.ObjectUtils.isNullOrUndefined(a))return a[1]+r}},e.getPrimaryThumbnailSrc=function(t){var n=e.primaryThumbnailKeyValuePair,r=e.getMetaContent(t,n);if(!o.ObjectUtils.isNullOrUndefined(r))return{metadataUsed:n,thumbnailSrc:r}},e.getFallbackThumbnailSrc=function(t){for(var n=0,r=e.fallbackThumbnailKeyValuePairs;n<r.length;n++){var i=r[n],a=e.getMetaContent(t,i);if(!o.ObjectUtils.isNullOrUndefined(a))return{metadataUsed:i,thumbnailSrc:a}}},e.getFirstImageOnPage=function(t){if(!o.ObjectUtils.isNullOrUndefined(t)&&t.length>0){var n=t[0].getAttribute(e.srcAttrName),r=e.firstImageOnPageKeyValuePair;if(!o.ObjectUtils.isNullOrUndefined(n)&&""!==n)return{metadataUsed:r,thumbnailSrc:n}}},e.getMetaContent=function(e,t){if(!(o.ObjectUtils.isNullOrUndefined(e)||o.ObjectUtils.isNullOrUndefined(t)||o.ObjectUtils.isNullOrUndefined(t.key)||o.ObjectUtils.isNullOrUndefined(t.value)))for(var n=0,r=e;n<r.length;n++){var i=r[n],a=i.getAttribute(t.key);if(a&&a.toLowerCase().split(/\s/).indexOf(t.value.toLowerCase())>-1){var s=void 0;"LINK"===i.nodeName&&(s="href"),"META"===i.nodeName&&(s="content");var l=i.getAttribute(s);if(o.ObjectUtils.isNullOrUndefined(l)||0===l.length)return;return l}}},e}();s.maxNumCharsInDescription=140,s.metadataTagNames=[i.DomUtils.tags.meta,i.DomUtils.tags.link],s.nameAttrName="name",s.propertyAttrName="property",s.relAttrName="rel",s.srcAttrName="src",s.primaryDescriptionKeyValuePair={key:s.propertyAttrName,value:"og:description"},s.primaryThumbnailKeyValuePair={key:s.propertyAttrName,value:"og:image"},s.firstImageOnPageKeyValuePair={key:"",value:"firstImageOnPage"},s.textOnPageKeyValuePair={key:"",value:"textOnPage"},s.fallbackDescriptionKeyValuePairs=[{key:s.nameAttrName,value:"description"},{key:s.nameAttrName,value:"twitter:description"},{key:s.nameAttrName,value:"keywords"},{key:s.propertyAttrName,value:"article:tag"}],s.fallbackThumbnailKeyValuePairs=[{key:s.nameAttrName,value:"twitter:image:src"},{key:s.nameAttrName,value:"twitter:image"},{key:s.relAttrName,value:"image_src"},{key:s.relAttrName,value:"icon"}],n.BookmarkHelper=s},{"../clipperUI/frontEndGlobals":49,"../domParsers/domUtils":83,"../logging/log":110,"../objectUtils":125}],77:[function(e,t,n){"use strict";var o=e("../clipperUI/frontEndGlobals"),r=e("../clippeUI/oneNoteApiUtils"),i=e("../http/httpWithRetries"),a=e("../logging/log"),s=e("../constants"),l=e("../settings"),c=e("../stringUtils"),u=function(){function e(){}return e.getFullPageScreenshot=function(t){return new Promise(function(n,u){o.Clipper.getUserSessionIdWhenDefined().then(function(p){var d=new a.Event.PromiseEvent(a.Event.Label.FullPageScreenshotCall),g=c.StringUtils.generateGuid();d.setCustomProperty(a.PropertyName.Custom.CorrelationId,g);var f={};f[s.Constants.HeaderValues.accept]="application/json",f[s.Constants.HeaderValues.appIdKey]=l.Settings.getSetting("App_Id"),f[s.Constants.HeaderValues.noAuthKey]="true",f[s.Constants.HeaderValues.correlationId]=g,f[s.Constants.HeaderValues.userSessionIdKey]=p;var h=function(e){d.setCustomProperty(a.PropertyName.Custom.CorrelationId,e.responseHeaders[s.Constants.HeaderValues.correlationId]),r.OneNoteApiUtils.logOneNoteApiRequestError(d,e)};i.HttpWithRetries.post(s.Constants.Urls.fullPageScreenshotUrl,t,f,[200,204],e.timeout).then(function(e){if(200===e.status)try{n(JSON.parse(e.response)),d.setCustomProperty(a.PropertyName.Custom.FullPageScreenshotContentFound,!0)}catch(t){h(OneNoteApi.ErrorUtils.createRequestErrorObject(e,OneNoteApi.RequestErrorType.UNABLE_TO_PARSE_RESPONSE)),u()}else d.setCustomProperty(a.PropertyName.Custom.FullPageScreenshotContentFound,!1),u()},function(e){h(e),u()}).then(function(){o.Clipper.logger.logEvent(d)})})})},e}();u.timeout=5e4,n.FullPageScreenshotHelper=u},{"../clipperUI/frontEndGlobals":49,"../clipperUI/oneNoteApiUtils":51,"../constants":74,"../http/httpWithRetries":106,"../logging/log":110,"../settings":137,"../stringUtils":143}],78:[function(e,t,n){"use strict";var o=e("../arrayUtils"),r=e("lodash"),i=function(){function e(e){this.pdf=e}return e.prototype.numPages=function(){return this.pdf.numPages},e.prototype.getByteLength=function(){return this.getData().then(function(e){return Promise.resolve(e.length)})},e.prototype.getData=function(){var e=this;return new Promise(function(t){e.pdf.getData().then(function(e){t(e)})})},e.prototype.getPageListAsDataUrls=function(e){var t=this,n=new Array(e.length);return new Promise(function(r){for(var i=function(i){t.getPageAsDataUrl(e[i]).then(function(e){n[i]=e,o.ArrayUtils.isArrayComplete(n)&&r(n)})},a=0;a<e.length;a++)i(a)})},e.prototype.getPageAsDataUrl=function(e){var t=this;return new Promise(function(n){t.pdf.getPage(e+1).then(function(e){var t=e.getViewport(2),o=document.createElement("canvas"),r=o.getContext("2d");o.height=t.height,o.width=t.width;var i={canvasContext:r,viewport:t};e.render(i).then(function(){n(o.toDataURL())})})})},e.prototype.getAllPageViewportDimensions=function(){var e=r.range(this.numPages());return this.getPageListViewportDimensions(e)},e.prototype.getPageListViewportDimensions=function(e){var t=this,n=new Array(e.length);return new Promise(function(r){for(var i=function(i){t.getPageViewportDimensions(e[i]).then(function(e){n[i]=e,o.ArrayUtils.isArrayComplete(n)&&r(n)})},a=0;a<e.length;a++)i(a);
edgeInject.js:2:!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LogManager=e()}}(function(){var e;return function(){function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return e}()({1:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(r=n.ClientType||(n.ClientType={}))},{}],2:[function(e,t,n){"use strict";var r,o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(r=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case r.Pdf:return o.InvokeSource.PdfTooltip;case r.Product:return o.InvokeSource.ProductTooltip;case r.Recipe:return o.InvokeSource.RecipeTooltip;case r.Video:return o.InvokeSource.VideoTooltip;case r.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":6}],3:[function(e,t,n){"use strict";var r=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],r=0;r<e.length;r++)n.push(e[r].get());t.apply(this,n)})},e}();n.SmartValue=r},{}],4:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var r;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(r=e.Extension||(e.Extension={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var u;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(u=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.c="KeyC"}(l=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var f;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(f=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var h;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(h=e.Settings||(e.Settings={}));var d;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(d=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var v;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(v=e.AriaSet||(e.AriaSet={}))}(r=n.Constants||(n.Constants={}))},{}],5:[function(e,t,n){"use strict";var r;!function(e){e[e.PUBLIC=0]="PUBLIC",e[e.GLOBAL=1]="GLOBAL",e[e.EUDB=2]="EUDB",e[e.EMEA=3]="EMEA",e[e.UNKNOWN=4]="UNKNOWN"}(r=n.DataBoundary||(n.DataBoundary={}))},{}],6:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(r=n.InvokeSource||(n.InvokeSource={}))},{}],7:[function(e,t,n){"use strict";var r;!function(t){function n(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(u){var t=u[e];if(t)return t}var n=c[e];if(n)return n;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function r(e){u=e}function o(e){return"font-family: "+i(e)+";"}function i(e){if(l[e])return l[e];var t="WebClipper.FontFamily."+s[e].toString(),r=n(t);return l[e]=a(r),l[e]}function a(e){if(!e)return"";for(var t=e.split(","),n=0;n<t.length;n++)t[n]=t[n].trim(),t[n].length>0&&t[n].indexOf(" ")>=0&&"'"!==t[n][0]&&"'"!==t[n][t.length-1]&&(t[n]="'"+t[n]+"'");return t.join(",")}var s;!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(s=t.FontFamily||(t.FontFamily={}));var u,l={},c=e("../../strings.json");t.getLocalizedString=n,t.setLocalizedStrings=r,t.getFontFamilyAsStyle=o,t.getFontFamily=i,t.formatFontFamily=a}(r=n.Localization||(n.Localization={}))},{"../../strings.json":41}],8:[function(e,t,n){"use strict";var r=e("./log"),o=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(r.Failure.Label.JsonParse,r.Failure.Type.Unexpected,void 0,e)},e}();n.Logger=o},{"./log":16}],9:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../objectUtils"),i=e("../settings"),a=e("./log"),s=e("./loggerDecorator"),u=e("./logHelpers"),l=e("../extensions/DataBoundary"),c=microsoft.applications.telemetry.EventProperties,p=function(e){function t(t,n){var r=e.call(this,n)||this;r.currentTenant=t,microsoft.applications.telemetry.LogManager.getDefaultToken()||microsoft.applications.telemetry.LogManager.initialize(t),r.logger=new microsoft.applications.telemetry.Logger,r.semanticContext=r.logger.getSemanticContext();var o="Debug console logger is ON - now logging to both Aria ("+i.Settings.getSetting("Misc_Data_Endpoint_Id").toUpperCase()+") and console.";return e.prototype.logTrace.call(r,a.Trace.Label.DebugMode,a.Trace.Level.Information,o),r}return r(t,e),t.prototype.reInitAriaLogger=function(e){microsoft.applications.telemetry.LogManager.isInitialized()&&(microsoft.applications.telemetry.LogManager.flush(),microsoft.applications.telemetry.LogManager.__backToUninitialized());var t=new microsoft.applications.telemetry.LogConfiguration;e!==l.DataBoundary[l.DataBoundary.GLOBAL]&&e!==l.DataBoundary[l.DataBoundary.PUBLIC]||(t.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),microsoft.applications.telemetry.LogManager.initialize(this.currentTenant,t),this.logger=new microsoft.applications.telemetry.Logger,this.semanticContext=this.logger.getSemanticContext()},t.prototype.generateSessionId=function(){return this.logger.getSessionId()},t.prototype.outputClickEvent=function(e){var t=u.LogHelpers.createClickEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputEvent=function(e){var t=u.LogHelpers.createLogEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputSessionStart=function(){var e=u.LogHelpers.createSessionStartEventAsJson(),t=this.createEventProperties(e);this.logger.logSession(a.Session.State.Started,t)},t.prototype.outputSessionEnd=function(e){var t=u.LogHelpers.createSessionEndEventAsJson(e),n=this.createEventProperties(t);this.logger.logSession(a.Session.State.Ended,n)},t.prototype.outputFailure=function(e,t,n,r){var o=u.LogHelpers.createFailureEventAsJson(e,t,n,r),i=this.createEventProperties(o);this.logger.logEvent(i)},t.prototype.outputUserFunnel=function(e){var t=u.LogHelpers.createFunnelEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputTrace=function(e,t,n){var r=u.LogHelpers.createTraceEventAsJson(e,t,n),o=this.createEventProperties(r);this.logger.logEvent(o)},t.prototype.outputSetContext=function(e,t){switch(e){case a.Context.Custom.AppInfoId:this.semanticContext.setAppId(t);break;case a.Context.Custom.AppInfoVersion:this.semanticContext.setAppVersion(t);break;case a.Context.Custom.DeviceInfoId:microsoft.applications.telemetry.LogManager.getSemanticContext().setDeviceId(t);break;case a.Context.Custom.UserInfoId:this.semanticContext.setUserId(t,0);break;case a.Context.Custom.UserInfoLanguage:this.semanticContext.setUserLanguage(t);break;case a.Context.Custom.SessionId:break;default:this.logger.setContext(a.Context.toString(e),t)}},t.prototype.onNavigateAway=function(){microsoft.applications.telemetry.LogManager.flush()},t.prototype.createEventProperties=function(e){var t=new c;for(var n in e)if(e.hasOwnProperty(n)){if(n===a.PropertyName.Reserved.EventType){t.name=e[n].toString();continue}var r=o.ObjectUtils.isNullOrUndefined(e[n])?a.unknownValue:e[n].toString();t.setProperty(n,r)}return t},t.prototype.formatUserLanguage=function(e){return e?e.replace("_","-"):void 0},t}(s.LoggerDecorator);n.AriaLoggerDecorator=p},{"../extensions/DataBoundary":5,"../objectUtils":35,"../settings":37,"./log":16,"./logHelpers":17,"./loggerDecorator":20}],10:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./communicatorLoggerPure"),i=e("./loggerDecorator"),a=function(e){function t(t,n){var r=e.call(this,{component:n})||this;return r.pureLogger=new o.CommunicatorLoggerPure(t),r}return r(t,e),t.prototype.outputEvent=function(e){this.pureLogger.logEvent(e)},t.prototype.outputFailure=function(e,t,n,r){this.pureLogger.logFailure(e,t,n,r)},t.prototype.outputUserFunnel=function(e){this.pureLogger.logUserFunnel(e)},t.prototype.outputSessionStart=function(){this.pureLogger.logSessionStart()},t.prototype.outputSessionEnd=function(e){this.pureLogger.logSessionEnd(e)},t.prototype.outputTrace=function(e,t,n){this.pureLogger.logTrace(e,t,n)},t.prototype.outputClickEvent=function(e){this.pureLogger.logClickEvent(e)},t.prototype.outputSetContext=function(e,t){this.pureLogger.setContextProperty(e,t)},t}(i.LoggerDecorator);n.CommunicatorLoggerDecorator=a},{"./communicatorLoggerPure":11,"./loggerDecorator":20}],11:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../constants"),i=e("./log"),a=e("./logger"),s=function(e){function t(t){var n=e.call(this)||this;return n.communicator=t,n}return r(t,e),t.prototype.logEvent=function(e){e.timerWasStopped()||e.stopTimer(),this.sendDataPackage(i.LogMethods.LogEvent,[e.getEventCategory(),e.getEventData()])},t.prototype.logFailure=function(e,t,n,r){this.sendDataPackage(i.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){this.sendDataPackage(i.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){this.sendDataPackage(i.LogMethods.LogSessionStart,arguments)},t.prototype.logSessionEnd=function(e){this.sendDataPackage(i.LogMethods.LogSessionEnd,arguments)},t.prototype.logTrace=function(e,t,n){n?this.sendDataPackage(i.LogMethods.LogTrace,[e,t,n]):this.sendDataPackage(i.LogMethods.LogTrace,[e,t])},t.prototype.pushToStream=function(e,t){this.sendDataPackage(i.LogMethods.PushToStream,arguments)},t.prototype.logClickEvent=function(e){this.sendDataPackage(i.LogMethods.LogClickEvent,arguments)},t.prototype.setContextProperty=function(e,t){this.sendDataPackage(i.LogMethods.SetContextProperty,arguments)},t.prototype.sendDataPackage=function(e,t){var n={methodName:e,methodArgs:Object.keys(t).map(function(e){return t[e]})};this.communicator.callRemoteFunction(o.Constants.FunctionKeys.telemetry,{param:n})},t}(a.Logger);n.CommunicatorLoggerPure=s},{"../constants":4,"./log":16,"./logger":19}],12:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./consoleLoggerPure"),i=e("./loggerDecorator"),a=function(e){function t(t,n){var r=e.call(this,n)||this;return r.pureConsoleLogger=new o.ConsoleLoggerPure(t),r}return r(t,e),t.prototype.outputEvent=function(e){this.pureConsoleLogger.logEvent(e)},t.prototype.outputFailure=function(e,t,n,r){this.pureConsoleLogger.logFailure(e,t,n,r)},t.prototype.outputUserFunnel=function(e){this.pureConsoleLogger.logUserFunnel(e)},t.prototype.outputSessionStart=function(){this.pureConsoleLogger.logSessionStart()},t.prototype.outputSessionEnd=function(e){this.pureConsoleLogger.logSessionEnd(e)},t.prototype.outputTrace=function(e,t,n){this.pureConsoleLogger.logTrace(e,t,n)},t.prototype.outputClickEvent=function(e){this.pureConsoleLogger.logClickEvent(e)},t.prototype.outputSetContext=function(e,t){this.pureConsoleLogger.setContextProperty(e,t)},t}(i.LoggerDecorator);n.ConsoleLoggerDecorator=a},{"./consoleLoggerPure":13,"./loggerDecorator":20}],13:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./log"),i=e("./consoleLoggerShell"),a=e("./Logger"),s=e("./logHelpers"),u=function(e){function t(t){var n=e.call(this)||this;return n.consoleShell=new i.ConsoleLoggerShell(t),n}return r(t,e),t.prototype.logEvent=function(e){var t=s.LogHelpers.createLogEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logFailure=function(e,t,n,r){var o=s.LogHelpers.createFailureEventAsJson(e,t,n,r);this.consoleShell.logToConsole(o)},t.prototype.logUserFunnel=function(e){var t=s.LogHelpers.createFunnelEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logSessionStart=function(){var e=s.LogHelpers.createSessionStartEventAsJson();this.consoleShell.logToConsole(e)},t.prototype.logSessionEnd=function(e){var t=s.LogHelpers.createSessionEndEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logTrace=function(e,t,n){var r=s.LogHelpers.createTraceEventAsJson(e,t,n);this.consoleShell.logToConsole(r)},t.prototype.pushToStream=function(e,t){},t.prototype.logClickEvent=function(e){var t=s.LogHelpers.createClickEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.setContextProperty=function(e,t){this.consoleShell.setContextProperty(o.Context.toString(e),t)},t}(a.Logger);n.ConsoleLoggerPure=u},{"./Logger":8,"./consoleLoggerShell":14,"./log":16,"./logHelpers":17}],14:[function(e,t,n){"use strict";var r=e("./log"),o=function(){function e(e){this.context={},this.consoleOutput=e}return e.prototype.logToConsole=function(e){if(!e)throw new Error("'event' argument to logToConsole was: "+e);var t=e[r.PropertyName.Reserved.Level];e[r.PropertyName.Reserved.Status]!==r.Status[r.Status.Failed]&&e[r.PropertyName.Reserved.Category]!==r.PropertyName.Reserved.WebClipper+"."+r.Failure.category||(t=r.Trace.Level[r.Trace.Level.Error]);var n=this.consoleOutput,o="";o+="["+e[r.PropertyName.Reserved.EventName]+"]",o+=t?" ["+t+"]":"",o+=r.PropertyName.Reserved.Message in e?" "+e[r.PropertyName.Reserved.Message]:"";var i=this.combineContextAndEvent(e);switch(r.Trace.Level[t]){case r.Trace.Level.Warning:n.warn(o,i);break;case r.Trace.Level.Error:n.error(o,i);break;case r.Trace.Level.Verbose:case r.Trace.Level.Information:n.info(o,i);break;default:n.log(o,i)}},e.prototype.setContextProperty=function(e,t){this.context[e]=t},e.prototype.combineContextAndEvent=function(e){var t={};for(var n in this.context)this.context.hasOwnProperty(n)&&(t[n]=this.context[n]);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},e}();n.ConsoleLoggerShell=o},{"./log":16}],15:[function(e,t,n){"use strict";var r=e("../objectUtils"),o=e("./log"),i=function(){function e(){}return e.prototype.requirementsAreMet=function(e){return!0},e}();n.NoRequirements=i;var a=function(){function e(e){this.prodProperties=[o.Context.toString(o.Context.Custom.AppInfoId),o.Context.toString(o.Context.Custom.AppInfoVersion),o.Context.toString(o.Context.Custom.BrowserLanguage),o.Context.toString(o.Context.Custom.ExtensionLifecycleId),o.Context.toString(o.Context.Custom.ClipperType),o.Context.toString(o.Context.Custom.DeviceInfoId),o.Context.toString(o.Context.Custom.FlightInfo),o.Context.toString(o.Context.Custom.InPrivateBrowsing)],this.requiredProperties=e?e:this.prodProperties}return e.prototype.requirementsAreMet=function(e){if(r.ObjectUtils.isNullOrUndefined(e))return!1;for(var t=0;t<this.requiredProperties.length;++t){var n=this.requiredProperties[t];if(!e.hasOwnProperty(n))return!1}return!0},e}();n.ProductionRequirements=a},{"../objectUtils":35,"./log":16}],16:[function(e,t,n){"use strict";function r(e,t){switch(e.methodName){case i.LogMethods.LogEvent:var n=e.methodArgs[0],r=e.methodArgs[1];t.logEvent.apply(t,[o.Event.createEvent(n,r)]);break;case i.LogMethods.LogFailure:t.logFailure.apply(t,e.methodArgs);break;case i.LogMethods.PushToStream:t.pushToStream.apply(t,e.methodArgs);break;case i.LogMethods.LogFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case i.LogMethods.LogClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case i.LogMethods.SetContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case i.LogMethods.LogTrace:default:t.logTrace.apply(t,e.methodArgs)}}var o=e("./submodules/event"),i=e("./submodules/logMethods");n.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,n.enableConsoleLogging="enable_console_logging",n.reportData="ReportData",n.unknownValue="unknown",n.parseAndLogDataPackage=r;var a=e("./submodules/click");n.Click=a.Click;var s=e("./submodules/context");n.Context=s.Context;var u=e("./submodules/errorUtils");n.ErrorUtils=u.ErrorUtils;var l=e("./submodules/event");n.Event=l.Event;var c=e("./submodules/failure");n.Failure=c.Failure;var p=e("./submodules/funnel");n.Funnel=p.Funnel;var f=e("./submodules/logMethods");n.LogMethods=f.LogMethods;var g=e("./submodules/noop");n.NoOp=g.NoOp;var h=e("./submodules/propertyName");n.PropertyName=h.PropertyName;var d=e("./submodules/session");n.Session=d.Session;var v=e("./submodules/status");n.Status=v.Status;var m=e("./submodules/trace");n.Trace=m.Trace},{"./submodules/click":22,"./submodules/context":23,"./submodules/errorUtils":24,"./submodules/event":25,"./submodules/failure":26,"./submodules/funnel":27,"./submodules/logMethods":28,"./submodules/noop":29,"./submodules/propertyName":30,"./submodules/session":31,"./submodules/status":32,"./submodules/trace":33}],17:[function(e,t,n){"use strict";var r,o=e("./log");!function(e){function t(e,t){var n={};n[o.PropertyName.Reserved.EventType]=o.reportData,n[o.PropertyName.Reserved.Label]=t;var r=o.PropertyName.Reserved.WebClipper+"."+e;return n[o.PropertyName.Reserved.Category]=r,n[o.PropertyName.Reserved.EventName]=r+"."+t,n}function n(t){if(!t)throw new Error("Button clicked without an ID! Logged with ID "+JSON.stringify(t));var n=e.createBaseEventAsJson(o.Click.category,t);return n}function r(t){t.timerWasStopped()||t.stopTimer();
edgeInject.js:3:var n=t.getEventCategory(),r=e.createBaseEventAsJson(o.Event.Category[n],t.getLabel());switch(r[o.PropertyName.Reserved.Duration]=t.getDuration(),g(r,t.getCustomProperties()),n){case o.Event.Category.BaseEvent:break;case o.Event.Category.PromiseEvent:i(r,t);break;case o.Event.Category.StreamEvent:a(r,t);break;default:throw new Error("createLogEvent does not specify a case for event category: "+o.Event.Category[n])}return r}function i(e,t){var n=t.getStatus();e[o.PropertyName.Reserved.Status]=n,n===o.Status[o.Status.Failed]&&(e[o.PropertyName.Reserved.FailureInfo]=t.getFailureInfo(),e[o.PropertyName.Reserved.FailureType]=t.getFailureType())}function a(e,t){e[o.PropertyName.Reserved.Stream]=JSON.stringify(t.getEventData().Stream)}function s(t,n){var r=new o.Event.BaseEvent(o.Event.Label.SetContextProperty),i=e.createBaseEventAsJson(o.Event.Category[r.getEventCategory()],r.getLabel()),a=o.Context.toString(t);return i[o.PropertyName.Custom[o.PropertyName.Custom.Key]]=a,i[o.PropertyName.Custom[o.PropertyName.Custom.Value]]=n,i}function u(t,n,r,i){var a=e.createBaseEventAsJson(o.Failure.category,o.Failure.Label[t]);return a[o.PropertyName.Reserved.FailureType]=o.Failure.Type[n],r&&(a[o.PropertyName.Reserved.FailureInfo]=o.ErrorUtils.toString(r)),i&&(a[o.PropertyName.Reserved.Id]=i),a[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace(),a}function l(t){var n=e.createBaseEventAsJson(o.Funnel.category,o.Funnel.Label[t]);return n}function c(){var t=e.createBaseEventAsJson(o.Session.category,o.Session.State[o.Session.State.Started]);return t}function p(t){var n=e.createBaseEventAsJson(o.Session.category,o.Session.State[o.Session.State.Ended]);return n[o.PropertyName.Reserved.Trigger]=o.Session.EndTrigger[t],n}function f(t,n,r){var i=e.createBaseEventAsJson(o.Trace.category,o.Trace.Label[t]);switch(r&&(i[o.PropertyName.Reserved.Message]=r),i[o.PropertyName.Reserved.Level]=o.Trace.Level[n],n){case o.Trace.Level.Warning:i[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace()}return i}function g(e,t){if(e[o.PropertyName.Reserved.Status]===o.Status[o.Status.Failed]&&(e[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace()),t)for(var n in t)if(t.hasOwnProperty(n)){var r=void 0;r="object"==typeof t[n]?JSON.stringify(t[n]):t[n],e[n]=r}}function h(){try{if(localStorage.getItem(o.enableConsoleLogging))return!0}catch(e){}return!1}e.createBaseEventAsJson=t,e.createClickEventAsJson=n,e.createLogEventAsJson=r,e.createSetContextEventAsJson=s,e.createFailureEventAsJson=u,e.createFunnelEventAsJson=l,e.createSessionStartEventAsJson=c,e.createSessionEndEventAsJson=p,e.createTraceEventAsJson=f,e.addToLogEvent=g,e.isConsoleOutputEnabled=h}(r=n.LogHelpers||(n.LogHelpers={}))},{"./log":16}],18:[function(e,t,n){"use strict";function r(e,t){var n=u.Settings.getSetting("Aria_Token"),r=new v.ProductionRequirements;return t?o(n,r,t,e):s=new g.AriaLoggerDecorator(n,{contextStrategy:r,sessionId:e})}function o(e,t,n,r){var o=n?new p.CommunicatorLoggerDecorator(n):void 0,i=d.LogHelpers.isConsoleOutputEnabled()?new m.WebConsole:void 0,a=new h.ConsoleLoggerDecorator(i,{component:o});return s=new g.AriaLoggerDecorator(e,{contextStrategy:t,component:a,sessionId:r})}function i(e){s.reInitAriaLogger(e)}function a(e,t){var n=new XMLHttpRequest,r=f.PropertyName.Reserved.WebClipper+"."+e.category,o=u.Settings.getSetting("Misc_Data_Endpoint_Id"),i="https://www.onenote.com/webclipper/data/"+o;i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.event,f.reportData,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.label,e.label,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.category,r,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.eventName,r+"."+e.label,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.HeaderValues.appIdKey.replace(/-/g,""),u.Settings.getSetting("App_Id"),t);for(var a in e.properties)e.properties.hasOwnProperty(a)&&(i=c.UrlUtils.addUrlQueryValue(i,a,e.properties[a],t));n.open("GET",i),n.send()}var s,u=e("../settings"),l=e("../constants"),c=e("../urlUtils"),p=e("../logging/communicatorLoggerDecorator"),f=e("../logging/log"),g=e("../logging/ariaLoggerDecorator_internal"),h=e("../logging/consoleLoggerDecorator"),d=e("../logging/logHelpers"),v=e("../logging/context"),m=e("../logging/webConsole");n.createExtLogger=r,n.reInitLoggerForDataBoundaryChange=i,n.sendMiscLogRequest=a},{"../constants":4,"../logging/ariaLoggerDecorator_internal":9,"../logging/communicatorLoggerDecorator":10,"../logging/consoleLoggerDecorator":12,"../logging/context":15,"../logging/log":16,"../logging/logHelpers":17,"../logging/webConsole":34,"../settings":37,"../urlUtils":39}],19:[function(e,t,n){arguments[4][8][0].apply(n,arguments)},{"./log":16,dup:8}],20:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../stringUtils"),i=e("./log"),a=e("./sessionLogger"),s=function(e){function t(t){var n=this,r=t&&t.contextStrategy?t.contextStrategy:void 0,o=t&&t.sessionId?t.sessionId:void 0;return n=e.call(this,{contextStrategy:r,sessionId:o})||this,n.component=t?t.component:void 0,n}return r(t,e),t.prototype.generateSessionId=function(){},t.prototype.handleSetUserSessionId=function(e){var t,n=this.sessionId.get(),r=this.generateSessionId();return n?t=n:e?t=e:r&&(t=r),this.component&&t?this.component.handleSetUserSessionId(t):this.component&&!t?t=this.component.handleSetUserSessionId():this.component||t||(t=this.currentSessionState===i.Session.State.Started?"cccccccc-"+o.StringUtils.generateGuid().substring(9):void 0),this.sessionId.set(t),this.setContextPropertyPure(i.Context.Custom.SessionId,t),this.outputSetContext(i.Context.Custom.SessionId,t),t},t.prototype.handleClickEvent=function(e){this.outputClickEvent(e),this.component&&this.component.executeClickEvent(e)},t.prototype.handleEvent=function(e){this.handleEventPure(e),this.component&&this.component.logEvent(e)},t.prototype.handleEventPure=function(e){this.outputEvent(e)},t.prototype.handleSessionStart=function(){this.outputSessionStart(),this.component&&this.component.executeSessionStart()},t.prototype.handleSessionEnd=function(e){this.outputSessionEnd(e),this.component&&this.component.executeSessionEnd(e)},t.prototype.handleFailure=function(e,t,n,r){this.outputFailure(e,t,n,r),this.component&&this.component.logFailure(e,t,n,r)},t.prototype.handleUserFunnel=function(e){this.outputUserFunnel(e),this.component&&this.component.logUserFunnel(e)},t.prototype.handleTrace=function(e,t,n){this.outputTrace(e,t,n),this.component&&this.component.logTrace(e,t,n)},t.prototype.handleSetContext=function(e,t){this.outputSetContext(e,t),this.component&&this.component.setContextProperty(e,t)},t}(a.SessionLogger);n.LoggerDecorator=s},{"../stringUtils":38,"./log":16,"./sessionLogger":21}],21:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../communicator/smartValue"),i=e("../constants"),a=e("../objectUtils"),s=e("./log"),u=e("./logger"),l=function(e){function t(t){var n=e.call(this)||this;return n.contextProperties={},n.currentSessionState=s.Session.State.Ended,n.logQueue=[],n.streams={},n.userHasInteracted=!1,n.sessionId=void 0,n.sessionId=t&&t.sessionId?t.sessionId:new o.SmartValue,n.contextStrategy=t?t.contextStrategy:void 0,n}return r(t,e),t.prototype.hasUserInteracted=function(){return this.userHasInteracted},t.prototype.getUserSessionId=function(e){return this.sessionId.get()},t.prototype.sendFunnelInteractionEvent=function(e){var t=[i.Constants.Ids.signInButtonMsa,i.Constants.Ids.signInButtonOrgId,i.Constants.Ids.signOutButton,i.Constants.Ids.closeButton,i.Constants.Ids.clipButton,i.Constants.Ids.launchOneNoteButton,i.Constants.Ids.checkOutWhatsNewButton,i.Constants.Ids.proceedToWebClipperButton];this.hasUserInteracted()||t.indexOf(e)!==-1||(this.userHasInteracted=!0,this.logUserFunnel(s.Funnel.Label.Interact))},t.prototype.logEvent=function(e){return a.ObjectUtils.isNullOrUndefined(e)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleEvent(e):void this.pushDataPackage(s.LogMethods.LogEvent,arguments)},t.prototype.logFailure=function(e,t,n,r){return a.ObjectUtils.isNullOrUndefined(e)||a.ObjectUtils.isNullOrUndefined(t)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleFailure(e,t,n,r):void this.pushDataPackage(s.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){return a.ObjectUtils.isNullOrUndefined(e)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleUserFunnel(e):void this.pushDataPackage(s.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){return this.areContextRequirementsMet()?(this.executeSessionStart(),void this.handleSetUserSessionId()):void this.pushDataPackage(s.LogMethods.LogSessionStart,arguments)},t.prototype.executeSessionStart=function(){if(this.currentSessionState===s.Session.State.Started){var e="Session already STARTED";return void this.logFailure(s.Failure.Label.SessionAlreadySet,s.Failure.Type.Unexpected,{error:e})}this.streams={},this.currentSessionState=s.Session.State.Started,this.handleSessionStart()},t.prototype.logSessionEnd=function(e){return this.areContextRequirementsMet()?(this.executeSessionEnd(e),void this.handleSetUserSessionId()):void this.pushDataPackage(s.LogMethods.LogSessionEnd,arguments)},t.prototype.executeSessionEnd=function(e){if(this.currentSessionState===s.Session.State.Ended){var t="Session already ENDED";return a.ObjectUtils.isNullOrUndefined(e)||(t+=". EndTrigger: "+s.Session.EndTrigger[e]),void this.logFailure(s.Failure.Label.SessionAlreadySet,s.Failure.Type.Unexpected,{error:t})}this.logAllStreams(),this.sessionId.set(void 0),this.userHasInteracted=!1,this.currentSessionState=s.Session.State.Ended,this.handleSessionEnd(e)},t.prototype.logTrace=function(e,t,n){return a.ObjectUtils.isNullOrUndefined(e)||a.ObjectUtils.isNullOrUndefined(t)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleTrace(e,t,n):void this.pushDataPackage(s.LogMethods.LogTrace,arguments)},t.prototype.pushToStream=function(e,t){if(a.ObjectUtils.isNullOrUndefined(e))return void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected);var n=s.Event.Label[e];t&&(this.streams[n]||(this.streams[n]=[]),this.streams[n].push(t))},t.prototype.logClickEvent=function(e){return this.areContextRequirementsMet()?(this.sendFunnelInteractionEvent(e),void this.executeClickEvent(e)):void this.pushDataPackage(s.LogMethods.LogClickEvent,arguments)},t.prototype.executeClickEvent=function(e){return e?(this.pushToStream(s.Event.Label.Click,e),void this.handleClickEvent(e)):void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected,{error:"Button clicked without an ID! Logged with ID "+JSON.stringify(e)})},t.prototype.setContextProperty=function(e,t){this.setContextPropertyPure(e,t),this.handleSetContext(e,t),this.areContextRequirementsMet()&&this.flushEventQueue()},t.prototype.setContextPropertyPure=function(e,t){var n=s.Context.toString(e);this.contextProperties[n]=t},t.prototype.areContextRequirementsMet=function(){return!this.contextStrategy||this.contextStrategy.requirementsAreMet(this.contextProperties)},t.prototype.flushEventQueue=function(){var e=this;this.isQueueFlushing||this.isQueueFlushed||(this.isQueueFlushing=!0,this.logQueue.forEach(function(t){switch(t.methodName){case s.LogMethods.LogEvent:e.logEvent.apply(e,t.methodArgs);break;case s.LogMethods.LogFailure:e.logFailure.apply(e,t.methodArgs);break;case s.LogMethods.PushToStream:e.pushToStream.apply(e,t.methodArgs);break;case s.LogMethods.LogFunnel:e.logUserFunnel.apply(e,t.methodArgs);break;case s.LogMethods.LogSessionStart:e.logSessionStart.apply(e,t.methodArgs);break;case s.LogMethods.LogSessionEnd:e.logSessionEnd.apply(e,t.methodArgs);break;case s.LogMethods.LogClickEvent:e.logClickEvent.apply(e,t.methodArgs);break;case s.LogMethods.SetContextProperty:e.setContextProperty.apply(e,t.methodArgs);break;case s.LogMethods.LogTrace:default:e.logTrace.apply(e,t.methodArgs)}}),this.isQueueFlushing=!1,this.isQueueFlushed=!0)},t.prototype.logAllStreams=function(){for(var e in this.streams)if(this.streams.hasOwnProperty(e)){for(var t=new s.Event.StreamEvent(s.Event.Label[e]),n=this.streams[e],r=0;r<n.length;r++)t.append(n[r]);this.handleEventPure(t)}},t.prototype.pushDataPackage=function(e,t){this.logQueue.push({methodName:e,methodArgs:t})},t}(u.Logger);n.SessionLogger=l},{"../communicator/smartValue":3,"../constants":4,"../objectUtils":35,"./log":16,"./logger":19}],22:[function(e,t,n){"use strict";var r;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(r=n.Click||(n.Click={}))},{}],23:[function(e,t,n){"use strict";var r;!function(e){function t(e){return r[n[e]]}var n,r={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",ExtensionLifecycleId:"ExtensionLifecycle.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.ExtensionLifecycleId=2]="ExtensionLifecycleId",e[e.DeviceInfoId=3]="DeviceInfoId",e[e.SessionId=4]="SessionId",e[e.UserInfoId=5]="UserInfoId",e[e.UserInfoLanguage=6]="UserInfoLanguage",e[e.AuthType=7]="AuthType",e[e.BrowserLanguage=8]="BrowserLanguage",e[e.ClipperType=9]="ClipperType",e[e.ContentType=10]="ContentType",e[e.FlightInfo=11]="FlightInfo",e[e.InPrivateBrowsing=12]="InPrivateBrowsing",e[e.PageLanguage=13]="PageLanguage"}(n=e.Custom||(e.Custom={})),e.toString=t}(r=n.Context||(n.Context={}))},{}],24:[function(e,t,n){"use strict";var r,o=e("../../clientType"),i=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),u=e("../log");!function(e){function t(e){if(e){var t={};t[g[g.Error].toLowerCase()]=e.error;var n=e;return n&&void 0!==n.statusCode&&(t[g[g.StatusCode].toLowerCase()]=n.statusCode,t[g[g.Response].toLowerCase()]=n.response,t[g[g.ResponseHeaders].toLowerCase()]=n.responseHeaders,void 0!==n.timeout&&(t[g[g.Timeout].toLowerCase()]=n.timeout)),JSON.stringify(t)}}function n(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function r(t){var n={};n[i.Constants.Urls.QueryParams.failureType]=u.Failure.Type[t.properties.failureType],n[i.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),n[i.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,a.ObjectUtils.isNullOrUndefined(t.properties.failureId)||(n[i.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var r=t.clientInfo;f(n,r),LogManager.sendMiscLogRequest({label:u.Failure.Label[t.label],category:u.Failure.category,properties:n},!0)}function l(t,n,r,o){var i;throw i=o?JSON.stringify({message:o,error:n.toString()}):n.toString(),e.sendFailureLogRequest({label:u.Failure.Label.UnhandledExceptionThrown,properties:{failureType:u.Failure.Type.Unexpected,failureInfo:{error:i},failureId:"Channel "+t,stackTrace:u.Failure.getStackTrace(n)},clientInfo:r}),n}function c(e,t){void 0===t&&(t=!1);var n={};n[i.Constants.Urls.QueryParams.channel]=e.channel,n[i.Constants.Urls.QueryParams.timeoutInMs]=i.Constants.Settings.noOpTrackerTimeoutDuration.toString();var r=e.clientInfo;f(n,r),LogManager.sendMiscLogRequest({label:u.NoOp.Label[e.label],category:u.NoOp.category,properties:n},!0),t&&window&&window.alert(s.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function p(e,t){return void 0===t&&(t=!1),setTimeout(function(){c(e,t)},i.Constants.Settings.noOpTrackerTimeoutDuration)}function f(e,t){t&&(e[i.Constants.Urls.QueryParams.clientType]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:o.ClientType[t.get().clipperType],e[i.Constants.Urls.QueryParams.clipperVersion]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:t.get().clipperVersion,e[i.Constants.Urls.QueryParams.clipperId]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:t.get().clipperId)}var g;!function(e){e[e.Error=0]="Error",e[e.StatusCode=1]="StatusCode",e[e.Response=2]="Response",e[e.ResponseHeaders=3]="ResponseHeaders",e[e.Timeout=4]="Timeout"}(g||(g={})),e.toString=t,e.clone=n,e.sendFailureLogRequest=r,e.handleCommunicatorError=l,e.sendNoOpTrackerRequest=c,e.setNoOpTrackerRequestTimeout=p}(r=n.ErrorUtils||(n.ErrorUtils={}))},{"../../clientType":1,"../../constants":4,"../../localization/localization":7,"../../objectUtils":35,"../log":16}],25:[function(e,t,n){"use strict";var r,o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../log"),a=e("../../objectUtils");!function(e){function t(t,n){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(n);case e.Category.PromiseEvent:return new e.PromiseEvent(n);case e.Category.StreamEvent:return new e.StreamEvent(n)}}var n;!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(n=e.Category||(e.Category={}));var r;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipAugmentationOptions=6]="ClipAugmentationOptions",e[e.ClipCommonOptions=7]="ClipCommonOptions",e[e.ClipPdfOptions=8]="ClipPdfOptions",e[e.ClipRegionOptions=9]="ClipRegionOptions",e[e.ClipSelectionOptions=10]="ClipSelectionOptions",e[e.ClipToOneNoteAction=11]="ClipToOneNoteAction",e[e.CloseClipper=12]="CloseClipper",e[e.ClosePageNavTooltip=13]="ClosePageNavTooltip",e[e.CreateNotebook=14]="CreateNotebook",e[e.CreatePage=15]="CreatePage",e[e.CreateSection=16]="CreateSection",e[e.DebugFeedback=17]="DebugFeedback",e[e.DeviceIdMap=18]="DeviceIdMap",e[e.FetchNonLocalData=19]="FetchNonLocalData",e[e.FullPageScreenshotCall=20]="FullPageScreenshotCall",e[e.GetBinaryRequest=21]="GetBinaryRequest",e[e.GetCleanDom=22]="GetCleanDom",e[e.GetExistingUserInformation=23]="GetExistingUserInformation",e[e.GetFlightingAssignments=24]="GetFlightingAssignments",e[e.GetLocale=25]="GetLocale",e[e.GetLocalizedStrings=26]="GetLocalizedStrings",e[e.GetNotebookByName=27]="GetNotebookByName",e[e.GetNotebooks=28]="GetNotebooks",e[e.GetPage=29]="GetPage",e[e.GetPageContent=30]="GetPageContent",e[e.GetPages=31]="GetPages",e[e.HandleSignInEvent=32]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=33]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=34]="InvokeClipper",e[e.InvokeTooltip=35]="InvokeTooltip",e[e.InvokeWhatsNew=36]="InvokeWhatsNew",e[e.LocalFilesNotAllowedPanelShown=37]="LocalFilesNotAllowedPanelShown",e[e.PagesSearch=38]="PagesSearch",e[e.PdfByteMetadata=39]="PdfByteMetadata",e[e.PdfDataUrlMetadata=40]="PdfDataUrlMetadata",e[e.ProcessPdfIntoDataUrls=41]="ProcessPdfIntoDataUrls",e[e.RegionSelectionCapturing=42]="RegionSelectionCapturing",e[e.RegionSelectionLoading=43]="RegionSelectionLoading",e[e.RegionSelectionProcessing=44]="RegionSelectionProcessing",e[e.RetrieveUserInformation=45]="RetrieveUserInformation",e[e.SendBatchRequest=46]="SendBatchRequest",e[e.SetContextProperty=47]="SetContextProperty",e[e.SetDoNotPromptRatings=48]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=49]="ShouldShowRatingsPrompt",e[e.TooltipImpression=50]="TooltipImpression",e[e.UpdatePage=51]="UpdatePage",e[e.UserInfoUpdated=52]="UserInfoUpdated",e[e.WhatsNewImpression=53]="WhatsNewImpression"}(r=e.Label||(e.Label={}));var s=function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var n=e;this._label=n,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+i.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[i.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||a.ObjectUtils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in i.PropertyName.Reserved)if(i.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}();e.BaseEvent=s;var u=function(t){function n(e){var n=t.call(this,e)||this;if(n._logStatus=i.Status.Succeeded,n._failureType=i.Failure.Type.Unexpected,n.isEventData(e)){var r=e;n._logStatus=r.LogStatus,n._failureType=r.FailureType,n._failureInfo=i.ErrorUtils.clone(r.FailureInfo)}return n}return o(n,t),n.prototype.getEventCategory=function(){return e.Category.PromiseEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:i.ErrorUtils.clone(this._failureInfo)}},n.prototype.getStatus=function(){return i.Status[this._logStatus]},n.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},n.prototype.getFailureInfo=function(){return i.ErrorUtils.toString(this._failureInfo)},n.prototype.setFailureInfo=function(e){this._failureInfo=i.ErrorUtils.clone(e)},n.prototype.getFailureType=function(){return i.Failure.Type[this._failureType]},n.prototype.setFailureType=function(e){this._failureType=e},n}(s);e.PromiseEvent=u;var l=function(t){function n(e){var n=t.call(this,e)||this;if(n._stream=[],n.isEventData(e)){var r=e;n._stream=r.Stream}return n}return o(n,t),n.prototype.getEventCategory=function(){return e.Category.StreamEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},n.prototype.append=function(e){this._stream.push(e)},n}(s);e.StreamEvent=l,e.createEvent=t}(r=n.Event||(n.Event={}))},{"../../objectUtils":35,"../log":16}],26:[function(e,t,n){"use strict";var r;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure";var n;!function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(n=e.Type||(e.Type={})),e.getStackTrace=t;var r;!function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",e[e.EndSessionWithoutTrigger=1]="EndSessionWithoutTrigger",e[e.GetChangeLog=2]="GetChangeLog",e[e.GetComputedStyle=3]="GetComputedStyle",e[e.GetLocalizedString=4]="GetLocalizedString",e[e.GetSetting=5]="GetSetting",e[e.IFrameMessageHandlerHasNoOtherWindow=6]="IFrameMessageHandlerHasNoOtherWindow",e[e.InvalidArgument=7]="InvalidArgument",e[e.IsFeatureEnabled=8]="IsFeatureEnabled",e[e.JsonParse=9]="JsonParse",e[e.NotImplemented=10]="NotImplemented",e[e.OnLaunchOneNoteButton=11]="OnLaunchOneNoteButton",e[e.OrphanedWebClippersDueToExtensionRefresh=12]="OrphanedWebClippersDueToExtensionRefresh",e[e.RegionSelectionProcessing=13]="RegionSelectionProcessing",e[e.RenderFailurePanel=14]="RenderFailurePanel",e[e.ReservedPropertyOverwriteAttempted=15]="ReservedPropertyOverwriteAttempted",e[e.SessionAlreadySet=16]="SessionAlreadySet",e[e.SetLoggerNoop=17]="SetLoggerNoop",e[e.SetUndefinedLocalizedStrings=18]="SetUndefinedLocalizedStrings",e[e.TraceLevelErrorWarningMessage=19]="TraceLevelErrorWarningMessage",e[e.UnhandledApiCode=20]="UnhandledApiCode",e[e.UnhandledExceptionThrown=21]="UnhandledExceptionThrown",e[e.UserSetWithInvalidExpiredData=22]="UserSetWithInvalidExpiredData",e[e.WebExtensionWindowCreate=23]="WebExtensionWindowCreate",e[e.UnclippablePage=24]="UnclippablePage",e[e.UnsupportedBrowser=25]="UnsupportedBrowser"}(r=e.Label||(e.Label={}))}(r=n.Failure||(n.Failure={}))},{}],27:[function(e,t,n){"use strict";var r;!function(e){e.category="Funnel";var t;!function(e){e[e.Invoke=0]="Invoke",e[e.AuthAlreadySignedIn=1]="AuthAlreadySignedIn",e[e.AuthAttempted=2]="AuthAttempted",e[e.AuthSignInCompleted=3]="AuthSignInCompleted",e[e.AuthSignInFailed=4]="AuthSignInFailed",e[e.ClipAttempted=5]="ClipAttempted",e[e.Interact=6]="Interact",e[e.ViewInWac=7]="ViewInWac",e[e.SignOut=8]="SignOut"}(t=e.Label||(e.Label={}))}(r=n.Funnel||(n.Funnel={}))},{}],28:[function(e,t,n){"use strict";var r;!function(e){e[e.LogEvent=0]="LogEvent",e[e.LogFailure=1]="LogFailure",e[e.PushToStream=2]="PushToStream",e[e.LogFunnel=3]="LogFunnel",e[e.LogSession=4]="LogSession",e[e.LogSessionStart=5]="LogSessionStart",e[e.LogSessionEnd=6]="LogSessionEnd",e[e.LogTrace=7]="LogTrace",e[e.LogClickEvent=8]="LogClickEvent",e[e.SetContextProperty=9]="SetContextProperty"}(r=n.LogMethods||(n.LogMethods={}))},{}],29:[function(e,t,n){"use strict";var r;!function(e){e.category="NoOp";var t;!function(e){e[e.InitializeCommunicator=0]="InitializeCommunicator",e[e.WebClipperUiFrameDidNotExist=1]="WebClipperUiFrameDidNotExist",e[e.WebClipperUiFrameIsNotVisible=2]="WebClipperUiFrameIsNotVisible"}(t=e.Label||(e.Label={}))}(r=n.NoOp||(n.NoOp={}))},{}],30:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e[e.AnnotationAdded=0]="AnnotationAdded",e[e.AugmentationModel=1]="AugmentationModel",e[e.AverageProcessingDurationPerPage=2]="AverageProcessingDurationPerPage",e[e.ByteLength=3]="ByteLength",e[e.BytesPerPdfPage=4]="BytesPerPdfPage",e[e.BytesTrimmed=5]="BytesTrimmed",e[e.Channel=6]="Channel",e[e.ClipMode=7]="ClipMode",e[e.CloseReason=8]="CloseReason",e[e.ContainsAtLeastOneHighlight=9]="ContainsAtLeastOneHighlight",e[e.ContentType=10]="ContentType",e[e.CorrelationId=11]="CorrelationId",e[e.CurrentPanel=12]="CurrentPanel",e[e.CurrentSectionStillExists=13]="CurrentSectionStillExists",e[e.DeviceIdInStorage=14]="DeviceIdInStorage",e[e.DeviceIdInCookie=15]="DeviceIdInCookie",e[e.DomSizeInBytes=16]="DomSizeInBytes",e[e.FeatureEnabled=17]="FeatureEnabled",e[e.FinalDataUrlLength=18]="FinalDataUrlLength",e[e.FontSize=19]="FontSize",e[e.ForceRetrieveFreshLocStrings=20]="ForceRetrieveFreshLocStrings",e[e.FreshUserInfoAvailable=21]="FreshUserInfoAvailable",e[e.FullPageScreenshotContentFound=22]="FullPageScreenshotContentFound",e[e.Height=23]="Height",e[e.InitialDataUrlLength=24]="InitialDataUrlLength",e[e.InvokeMode=25]="InvokeMode",e[e.InvokeSource=26]="InvokeSource",e[e.IsHighDpiScreen=27]="IsHighDpiScreen",e[e.IsRetryable=28]="IsRetryable",e[e.IsSerif=29]="IsSerif",e[e.Key=30]="Key",e[e.LastSeenTooltipTime=31]="LastSeenTooltipTime",e[e.LastUpdated=32]="LastUpdated",e[e.MaxDepth=33]="MaxDepth",e[e.NumPages=34]="NumPages",e[e.NumRegions=35]="NumRegions",e[e.NumTimesTooltipHasBeenSeen=36]="NumTimesTooltipHasBeenSeen",e[e.PageNavTooltipType=37]="PageNavTooltipType",e[e.PageTitleModified=38]="PageTitleModified",e[e.PdfAllPagesClipped=39]="PdfAllPagesClipped",e[e.PdfAttachmentClipped=40]="PdfAttachmentClipped",e[e.PdfFileSelectedPageCount=41]="PdfFileSelectedPageCount",e[e.PdfFileTotalPageCount=42]="PdfFileTotalPageCount",e[e.PdfIsBatched=43]="PdfIsBatched",e[e.PdfIsLocalFile=44]="PdfIsLocalFile",e[e.RatingsInfo=45]="RatingsInfo",e[e.ShouldShowRatingsPrompt=46]="ShouldShowRatingsPrompt",e[e.SignInCancelled=47]="SignInCancelled",e[e.StoredLocaleDifferentThanRequested=48]="StoredLocaleDifferentThanRequested",e[e.TimeToClearNoOpTracker=49]="TimeToClearNoOpTracker",e[e.TooltipType=50]="TooltipType",e[e.UpdateInterval=51]="UpdateInterval",e[e.UserInformationReturned=52]="UserInformationReturned",e[e.UserInformationStored=53]="UserInformationStored",e[e.UserUpdateReason=54]="UserUpdateReason",e[e.Value=55]="Value",e[e.Width=56]="Width",e[e.WriteableCookies=57]="WriteableCookies",e[e.DataBoundary=58]="DataBoundary"}(t=e.Custom||(e.Custom={}));var n;!function(e){e.Category="Category",e.Duration="Duration",e.EventName="EventName",e.EventType="EventType",e.FailureInfo="FailureInfo",e.FailureType="FailureType",e.Id="Id",e.Label="Label",e.Level="Level",e.Message="Message",e.Properties="Properties",e.StackTrace="StackTrace",e.Status="Status",e.Stream="Stream",e.Trigger="Trigger",e.WebClipper="WebClipper"}(n=e.Reserved||(e.Reserved={}))}(r=n.PropertyName||(n.PropertyName={}))},{}],31:[function(e,t,n){"use strict";var r;!function(e){e.category="Session";var t;!function(e){e[e.SignOut=0]="SignOut",e[e.Unload=1]="Unload"}(t=e.EndTrigger||(e.EndTrigger={}));var n;!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(n=e.State||(e.State={}))}(r=n.Session||(n.Session={}))},{}],32:[function(e,t,n){"use strict";var r;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(r=n.Status||(n.Status={}))},{}],33:[function(e,t,n){"use strict";var r;!function(e){e.category="Trace";var t;!function(e){e[e.DefaultingToConsoleLogger=0]="DefaultingToConsoleLogger",e[e.DebugMode=1]="DebugMode",e[e.RequestForClipperInstalledPageUrl=2]="RequestForClipperInstalledPageUrl",e[e.General=3]="General"}(t=e.Label||(e.Label={}));var n;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Verbose=4]="Verbose"}(n=e.Level||(e.Level={}))}(r=n.Trace||(n.Trace={}))},{}],34:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.warn=function(e,t){console.warn(e,t)},e.prototype.error=function(e,t){console.error(e,t)},e.prototype.info=function(e,t){console.info(e,t)},e.prototype.log=function(e,t){console.log(e,t)},e}();n.WebConsole=r},{}],35:[function(e,t,n){"use strict";var r;!function(e){function t(e){return"number"==typeof e&&!isNaN(e)}function n(e){return null===e||void 0===e}e.isNumeric=t,e.isNullOrUndefined=n}(r=n.ObjectUtils||(n.ObjectUtils={}))},{}],36:[function(e,t,n){"use strict";var r;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(r=n.OperationResult||(n.OperationResult={}))},{}],37:[function(e,t,n){"use strict";var r,o=e("../settings.json");!function(t){function n(e){var t=o[e];if(t&&t.Value)return t.Value}function r(t){o=t?t:e("../settings.json")}t.getSetting=n,t.setSettingsJsonForTesting=r}(r=n.Settings||(n.Settings={}))},{"../settings.json":40}],38:[function(e,t,n){"use strict";var r,o=e("./objectUtils"),i=e("./operationResult"),a=e("./localization/localization"),s=e("lodash");!function(e){function t(e,t){if(o.ObjectUtils.isNullOrUndefined(e))return r("");if(e=e.trim(),""===e)return r("");for(var i=e.split(","),a=[],u=0;u<i.length;++u){var l=[],c=void 0,p=i[u].trim();if(""!==p){
edgeInject.js:12181:!function(){function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return e}()({1:[function(e,t,n){"use strict";var r;!function(e){function t(e){var t=document.createElement("iframe");t.hidden=!0,t.style.display="none",t.src=e,document.body.appendChild(t)}function n(){return!window.addEventListener||navigator.appVersion.indexOf("MSIE 9")>=0}function r(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>=0)return"IE"+e.substring(t+5,e.indexOf(".",t));if(e.indexOf("Trident/")>=0){var n=e.indexOf("rv:");return"IE"+e.substring(n+3,e.indexOf(".",n))}return e.indexOf("Edge/")>=0?"Edge":void 0}function o(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=700);var r=screen.width?(screen.width-t)/2:0,o=screen.height?(screen.height-n)/2:0,i="height="+n+",width="+t+",top="+o+",left="+r+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no";return window.open(e,"_blank",i)}e.appendHiddenIframeToDocument=t,e.browserNotSupported=n,e.ieVersion=r,e.openPopupWindow=o}(r=n.BrowserUtils||(n.BrowserUtils={}))},{}],2:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(r=n.ClientType||(n.ClientType={}))},{}],3:[function(e,t,n){"use strict";var r=e("../communicator/smartValue"),o=e("../storage/remoteStorage"),i=function(){function e(){}return e.getUserSessionId=function(){return e.sessionId.get()},e.getUserSessionIdWhenDefined=function(){return new Promise(function(t){var n=e.sessionId.get();n?t(n):e.sessionId.subscribe(function(e){t(e)},{times:1,callOnSubscribe:!1})})},e.getInjectCommunicator=function(){return e.injectCommunicator},e.setInjectCommunicator=function(t){e.injectCommunicator=t},e.getExtensionCommunicator=function(){return e.extensionCommunicator},e.setExtensionCommunicator=function(t){e.extensionCommunicator=t,e.setUpRemoteStorage(t)},e.getCachedValue=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");return e.storage.getCachedValue(t)},e.getStoredValue=function(t,n,r){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValue(t,n,r)},e.preCacheStoredValues=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValues(t,function(){},!0)},e.storeValue=function(t,n){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.setValue(t,n,void 0)},e.setUpRemoteStorage=function(t){e.storage=new o.RemoteStorage(e.getExtensionCommunicator())},e}();i.sessionId=new r.SmartValue,n.Clipper=i},{"../communicator/smartValue":10,"../storage/remoteStorage":73}],4:[function(e,t,n){"use strict";var r,o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(r=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case r.Pdf:return o.InvokeSource.PdfTooltip;case r.Product:return o.InvokeSource.ProductTooltip;case r.Recipe:return o.InvokeSource.RecipeTooltip;case r.Video:return o.InvokeSource.VideoTooltip;case r.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":31}],5:[function(e,t,n){"use strict";var r,o=e("./clientType"),i=e("./constants"),a=e("./urlUtils");!function(e){function t(e,t,n){var r=a.UrlUtils.addUrlQueryValue(i.Constants.Urls.clipperFeedbackUrl,"LogCategory",n);return r=a.UrlUtils.addUrlQueryValue(r,"originalUrl",e.pageInfo.rawUrl),r=a.UrlUtils.addUrlQueryValue(r,"clipperId",e.clientInfo.clipperId),r=a.UrlUtils.addUrlQueryValue(r,"usid",t),r=a.UrlUtils.addUrlQueryValue(r,"type",o.ClientType[e.clientInfo.clipperType]),r=a.UrlUtils.addUrlQueryValue(r,"version",e.clientInfo.clipperVersion)}function n(e,t,n){return s(i.Constants.Urls.Authentication.signInUrl,e,t,n)}function r(e,t,n){return s(i.Constants.Urls.Authentication.signOutUrl,e,t,n)}function s(e,t,n,r){var o=a.UrlUtils.addUrlQueryValue(e,i.Constants.Urls.QueryParams.authType,r);return o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.clipperId,t),o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.userSessionId,n)}e.generateFeedbackUrl=t,e.generateSignInUrl=n,e.generateSignOutUrl=r}(r=n.ClipperUrls||(n.ClipperUrls={}))},{"./clientType":2,"./constants":11,"./urlUtils":75}],6:[function(e,t,n){"use strict";var r=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var r in this.functionMap)this.functionMap.hasOwnProperty(r)&&this.postMessage({data:r,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var o=t.data.toString();if(this.otherSideKeys[o]||(this.otherSideKeys[o]=!0),this.isSmartValueSubscription(o)){var i=o.substr(e.setValuePrefix.length),a=this.trackedSmartValues[i];a&&this.updateRemoteSmartValue(i,a.get())}else if(this.queuedCalls[o]){for(var s=this.queuedCalls[o],u=0;u<s.length;u++)this.postMessage(s[u]);delete this.queuedCalls[o]}}else{var l=this.functionMap[t.functionKey];if(l){var c=l(t.data);c&&c.then&&t.callbackKey&&c.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var r=n?n.param:void 0,o=void 0;n&&n.callback&&(o=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(o,n.callback));var i={data:r,functionKey:t};o&&(i.callbackKey=o),this.otherSideKeys[t]?this.postMessage(i):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(i))},e.prototype.subscribeAcrossCommunicator=function(t,n,r){r&&t.subscribe(r,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,r=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(r),this.trackedSmartValues[t]=e,e.subscribe(r)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();r.initializationKey="INITIALIZATION-K3Y",r.acknowledgeKey="ACKNOWLEDGE-K3Y",r.registrationKey="REGISTER-FUNCTION-K3Y",r.setValuePrefix="SETVALUE-",r.callbackPostfix="-CALLBACK",n.Communicator=r},{}],7:[function(e,t,n){"use strict";var r=e("./communicator"),o=function(){function e(e,t,n,o){var i=new r.Communicator(e,n);i.setErrorHandler(o),i.onInitialized=function(){var e=[];i.handleDataPackage=function(t){e.push(t)};var a=new r.Communicator(t,n);a.setErrorHandler(o),a.onInitialized=function(){i.onInitialized=void 0,a.onInitialized=void 0;for(var t=0,n=e;t<n.length;t++){var r=n[t];a.postMessage(r)}i.handleDataPackage=function(e){a.postMessage(e)},a.handleDataPackage=function(e){i.postMessage(e)}}}}return e}();n.CommunicatorPassthrough=o},{"./communicator":6}],8:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./messageHandler"),i=function(e){function t(t){var n=e.call(this)||this;return n.getOtherWindow=t,n.initMessageHandler(),window.addEventListener("message",n.messageHandler),n}return r(t,e),t.prototype.initMessageHandler=function(){var e=this;this.messageHandler=function(t){e.onMessageReceived(t.data),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}},t.prototype.sendMessage=function(e){var t=this.getOtherWindow();t.postMessage(e,"*")},t.prototype.tearDown=function(){window.removeEventListener("message",this.messageHandler)},t}(o.MessageHandler);n.IFrameMessageHandler=i},{"./messageHandler":9}],9:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=r},{}],10:[function(e,t,n){"use strict";var r=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],r=0;r<e.length;r++)n.push(e[r].get());t.apply(this,n)})},e}();n.SmartValue=r},{}],11:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var r;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(r=e.Extension||(e.Extension={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var u;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(u=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.c="KeyC"}(l=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var f;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(f=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var d;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(d=e.Settings||(e.Settings={}));var h;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(h=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var m;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(m=e.AriaSet||(e.AriaSet={}))}(r=n.Constants||(n.Constants={}))},{}],12:[function(e,t,n){"use strict";var r=e("./objectUtils"),o=function(){function e(){}return e.readCookie=function(e,t){r.ObjectUtils.isNullOrUndefined(t)&&(t=document);for(var n=document.cookie.split(";").map(function(e){return e.split("=")}),o=0,i=n;o<i.length;o++){var a=i[o];if(a[0].trim()===e)return a[1].trim()}},e}();n.CookieUtils=o},{"./objectUtils":63}],13:[function(e,t,n){"use strict";var r,o=e("./khanAcademyVideoExtractor"),i=e("./videoUtils"),a=e("./vimeoVideoExtractor"),s=e("./YoutubeVideoExtractor");!function(e){function t(e){var t=i.SupportedVideoDomains;switch(e){case t.KhanAcademy:return new o.KhanAcademyVideoExtractor;case t.Vimeo:return new a.VimeoVideoExtractor;case t.YouTube:return new s.YoutubeVideoExtractor;default:return}}e.createVideoExtractor=t}(r=n.VideoExtractorFactory||(n.VideoExtractorFactory={}))},{"./YoutubeVideoExtractor":14,"./khanAcademyVideoExtractor":16,"./videoUtils":18,"./vimeoVideoExtractor":19}],14:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./domUtils"),i=e("./videoExtractor"),a=e("../urlUtils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",t.youTubeVideoIdQueryKey="v",t.dataOriginalSrcAttribute="data-original-src",t}return r(t,e),t.prototype.createEmbeddedVideosFromHtml=function(e){if(!e)return[];var t=document.createElement("div");t.innerHTML=e;for(var n=t.getElementsByTagName("iframe"),r=[],o=0;o<n.length;o++)if(this.isYoutubeUrl(n[o].src)){var i=this.createEmbeddedVideoFromUrl(n[o].src);i&&r.push(i)}return r},t.prototype.isYoutubeUrl=function(e){return/[^\w]youtube\.com\/watch(\?v=(\w+)|.*\&v=(\w+))/.test(e)||/[^\w]youtube\.com\/embed\/(\w+)/.test(e)},t.prototype.createEmbeddedVideoFromUrl=function(e){if(e){if(0===a.UrlUtils.getPathname(e).indexOf("/watch"))return this.createEmbeddedVideoFromId(a.UrlUtils.getQueryValue(e,this.youTubeVideoIdQueryKey));if(0===a.UrlUtils.getPathname(e).indexOf("/embed")){var t=e.match(/youtube\.com\/embed\/([^?|\/?]+)/);return this.createEmbeddedVideoFromId(t[1])}}},t.prototype.createEmbeddedVideoFromId=function(e){if(e){var t=o.DomUtils.createEmbedVideoIframe(),n="https://www.youtube.com/embed/"+e;t.src=n;var r=a.UrlUtils.addUrlQueryValue(this.youTubeWatchVideoBaseUrl,this.youTubeVideoIdQueryKey,e);return t.setAttribute(this.dataOriginalSrcAttribute,r),t}},t}(i.VideoExtractor);n.YoutubeVideoExtractor=s},{"../urlUtils":75,"./domUtils":15,"./videoExtractor":17}],15:[function(e,t,n){"use strict";var r=e("../constants"),o=e("../objectUtils"),i=e("./videoUtils"),a=e("./VideoExtractorFactory"),s=function(){function e(){}return e.cleanHtml=function(t){var n=[];for(var r in e.attributesAllowedByOnml)e.attributesAllowedByOnml.hasOwnProperty(r)&&(n=n.concat(e.attributesAllowedByOnml[r]));var o=e.htmlTags.concat(e.markupTags).concat(e.tableTags),i=sanitizeHtml(t,{allowedTags:o,allowedAttributes:e.attributesAllowedByOnml,allowedSchemes:sanitizeHtml.defaults.allowedSchemes.concat(["data"]),allowedClasses:{"*":["MainArticleContainer"]}});return i},e.removeStylesWithBase64EncodedBinaries=function(t){e.domReplacer(t,"style",function(e){return e.innerHTML.indexOf("data:application")!==-1?void 0:e})},e.removeElementsNotSupportedInOnml=function(t){e.domReplacer(t,e.tagsNotSupportedInOnml.join());var n=[e.tags.main,e.tags.article,e.tags.figure,e.tags.header,e.tags.center];e.domReplacer(t,n.join(),function(t){var n=document.createElement("div");return n.innerHTML=e.cleanHtml(t.innerHTML),n})},e.domReplacer=function(e,t,n){void 0===n&&(n=function(){});for(var r=e.querySelectorAll(t),o=0;o<r.length;o++){var i=r[o];try{var a=n(i,o);a?i!==a&&i.parentNode.replaceChild(a,i):i.parentNode.removeChild(i)}catch(e){}}},e.domReplacerAsync=function(e,t,n){return void 0===n&&(n=function(){return Promise.resolve(void 0)}),new Promise(function(r){var o=e.querySelectorAll(t),i=0;0===o.length&&r();for(var a=function(e){var t=o[e];n(t,e).then(function(e){e?t!==e&&t.parentNode.replaceChild(e,t):t.parentNode.removeChild(t)},function(){}).then(function(){++i===o.length&&r()})},s=0;s<o.length;s++)a(s)})},e.getPageContentType=function(e){var t=e.createElement("a");if(t.href=e.URL,/\.pdf$/i.test(t.pathname))return OneNoteApi.ContentType.EnhancedUrl;var n=e.querySelector("embed");return n&&/application\/pdf/i.test(n.type)?OneNoteApi.ContentType.EnhancedUrl:window&&window.PDFJS?OneNoteApi.ContentType.EnhancedUrl:OneNoteApi.ContentType.Html},e.fetchCanonicalUrl=function(e){var t=e.querySelectorAll("link[rel=canonical]");if(0===t.length)return e.URL;for(var n=t[0].href,r=void 0,o=1;o<t.length;o++)r=t.item(o).href,r.length<n.length&&(n=r);return n},e.getCleanDomOfCurrentPage=function(t){var n=e.cloneDocument(t);e.convertCanvasElementsToImages(n,t),e.addBaseTagIfNecessary(n,t.location),e.addImageSizeInformationToDom(n),e.removeUnwantedItems(n);var r=e.getDomString(n);return r},e.removeUnwantedItems=function(t){e.removeStylesWithBase64EncodedBinaries(t),e.removeClipperElements(t),e.removeUnwantedElements(t),e.removeUnwantedAttributes(t),e.removeUnsupportedHrefs(t)},e.addPreviewContainerStyling=function(e){e.setAttribute("style","margin-bottom: 16px")},e.addEmbeddedVideosWhereSupported=function(t,n,r){var o=i.VideoUtils.videoDomainIfSupported(r);if(!o)return Promise.resolve();var s=[];try{var u=i.SupportedVideoDomains[o],l=a.VideoExtractorFactory.createVideoExtractor(u);l&&(s=s.concat(l.createEmbeddedVideosFromPage(r,n)))}catch(e){return Promise.reject({error:JSON.stringify({doc:t.outerHTML,pageContent:n,message:e.message})})}return Promise.resolve(e.addVideosToElement(t,s))},e.createEmbedVideoIframe=function(){var e=document.createElement("iframe");return e.width="600",e.height="338",e.frameBorder="0",e.allowFullscreen=!1,e},e.addVideosToElement=function(t,n){if(!o.ObjectUtils.isNullOrUndefined(t)&&!o.ObjectUtils.isNullOrUndefined(n)&&0!==n.length){for(var r,i=[],a=0,s=n;a<s.length;a++){var u=s[a];o.ObjectUtils.isNullOrUndefined(u.src)||o.ObjectUtils.isNullOrUndefined(u.getAttribute(e.dataOriginalSrcAttribute))?i.push({srcAttribute:"",dataOriginalSrcAttribute:""}):(r=e.insertIFrame(t,u,r),r=e.insertSpacer(t,r.nextSibling),i.push({srcAttribute:u.src,dataOriginalSrcAttribute:u.getAttribute(e.dataOriginalSrcAttribute)}))}return i}},e.insertIFrame=function(e,t,n){var r;return r=o.ObjectUtils.isNullOrUndefined(n)?e.children[0]:n.nextSibling,e.insertBefore(t,r)},e.insertSpacer=function(e,t){var n=document.createElement("br");return e.insertBefore(n,t)},e.cloneDocument=function(e){return e.cloneNode(!0)},e.addBaseTagIfNecessary=function(t,n){if(!t.head){var r=t.createElement(e.tags.head),o=t.getElementsByTagName(e.tags.html)[0];o.insertBefore(r,o.children[0])}n||(n=document.location);var i=t.head.getElementsByTagName(e.tags.base);if(0===i.length){var a=n.href.split("#")[0].split("?")[0];a=a.substr(0,a.lastIndexOf("/")+1);var s=t.createElement(e.tags.base);s.href=a,t.head.insertBefore(s,t.head.firstChild)}},e.removeBlankImages=function(t){return e.domReplacerAsync(t,e.tags.img,function(t){return new Promise(function(n){
edgeExtension.js:2:!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LogManager=e()}}(function(){var e;return function(){function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return e}()({1:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(r=n.ClientType||(n.ClientType={}))},{}],2:[function(e,t,n){"use strict";var r,o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(r=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case r.Pdf:return o.InvokeSource.PdfTooltip;case r.Product:return o.InvokeSource.ProductTooltip;case r.Recipe:return o.InvokeSource.RecipeTooltip;case r.Video:return o.InvokeSource.VideoTooltip;case r.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":6}],3:[function(e,t,n){"use strict";var r=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],r=0;r<e.length;r++)n.push(e[r].get());t.apply(this,n)})},e}();n.SmartValue=r},{}],4:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var r;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(r=e.Extension||(e.Extension={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var u;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(u=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.c="KeyC"}(l=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var f;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(f=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var h;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(h=e.Settings||(e.Settings={}));var d;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(d=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var v;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(v=e.AriaSet||(e.AriaSet={}))}(r=n.Constants||(n.Constants={}))},{}],5:[function(e,t,n){"use strict";var r;!function(e){e[e.PUBLIC=0]="PUBLIC",e[e.GLOBAL=1]="GLOBAL",e[e.EUDB=2]="EUDB",e[e.EMEA=3]="EMEA",e[e.UNKNOWN=4]="UNKNOWN"}(r=n.DataBoundary||(n.DataBoundary={}))},{}],6:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(r=n.InvokeSource||(n.InvokeSource={}))},{}],7:[function(e,t,n){"use strict";var r;!function(t){function n(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(u){var t=u[e];if(t)return t}var n=c[e];if(n)return n;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function r(e){u=e}function o(e){return"font-family: "+i(e)+";"}function i(e){if(l[e])return l[e];var t="WebClipper.FontFamily."+s[e].toString(),r=n(t);return l[e]=a(r),l[e]}function a(e){if(!e)return"";for(var t=e.split(","),n=0;n<t.length;n++)t[n]=t[n].trim(),t[n].length>0&&t[n].indexOf(" ")>=0&&"'"!==t[n][0]&&"'"!==t[n][t.length-1]&&(t[n]="'"+t[n]+"'");return t.join(",")}var s;!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(s=t.FontFamily||(t.FontFamily={}));var u,l={},c=e("../../strings.json");t.getLocalizedString=n,t.setLocalizedStrings=r,t.getFontFamilyAsStyle=o,t.getFontFamily=i,t.formatFontFamily=a}(r=n.Localization||(n.Localization={}))},{"../../strings.json":41}],8:[function(e,t,n){"use strict";var r=e("./log"),o=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(r.Failure.Label.JsonParse,r.Failure.Type.Unexpected,void 0,e)},e}();n.Logger=o},{"./log":16}],9:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../objectUtils"),i=e("../settings"),a=e("./log"),s=e("./loggerDecorator"),u=e("./logHelpers"),l=e("../extensions/DataBoundary"),c=microsoft.applications.telemetry.EventProperties,p=function(e){function t(t,n){var r=e.call(this,n)||this;r.currentTenant=t,microsoft.applications.telemetry.LogManager.getDefaultToken()||microsoft.applications.telemetry.LogManager.initialize(t),r.logger=new microsoft.applications.telemetry.Logger,r.semanticContext=r.logger.getSemanticContext();var o="Debug console logger is ON - now logging to both Aria ("+i.Settings.getSetting("Misc_Data_Endpoint_Id").toUpperCase()+") and console.";return e.prototype.logTrace.call(r,a.Trace.Label.DebugMode,a.Trace.Level.Information,o),r}return r(t,e),t.prototype.reInitAriaLogger=function(e){microsoft.applications.telemetry.LogManager.isInitialized()&&(microsoft.applications.telemetry.LogManager.flush(),microsoft.applications.telemetry.LogManager.__backToUninitialized());var t=new microsoft.applications.telemetry.LogConfiguration;e!==l.DataBoundary[l.DataBoundary.GLOBAL]&&e!==l.DataBoundary[l.DataBoundary.PUBLIC]||(t.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),microsoft.applications.telemetry.LogManager.initialize(this.currentTenant,t),this.logger=new microsoft.applications.telemetry.Logger,this.semanticContext=this.logger.getSemanticContext()},t.prototype.generateSessionId=function(){return this.logger.getSessionId()},t.prototype.outputClickEvent=function(e){var t=u.LogHelpers.createClickEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputEvent=function(e){var t=u.LogHelpers.createLogEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputSessionStart=function(){var e=u.LogHelpers.createSessionStartEventAsJson(),t=this.createEventProperties(e);this.logger.logSession(a.Session.State.Started,t)},t.prototype.outputSessionEnd=function(e){var t=u.LogHelpers.createSessionEndEventAsJson(e),n=this.createEventProperties(t);this.logger.logSession(a.Session.State.Ended,n)},t.prototype.outputFailure=function(e,t,n,r){var o=u.LogHelpers.createFailureEventAsJson(e,t,n,r),i=this.createEventProperties(o);this.logger.logEvent(i)},t.prototype.outputUserFunnel=function(e){var t=u.LogHelpers.createFunnelEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputTrace=function(e,t,n){var r=u.LogHelpers.createTraceEventAsJson(e,t,n),o=this.createEventProperties(r);this.logger.logEvent(o)},t.prototype.outputSetContext=function(e,t){switch(e){case a.Context.Custom.AppInfoId:this.semanticContext.setAppId(t);break;case a.Context.Custom.AppInfoVersion:this.semanticContext.setAppVersion(t);break;case a.Context.Custom.DeviceInfoId:microsoft.applications.telemetry.LogManager.getSemanticContext().setDeviceId(t);break;case a.Context.Custom.UserInfoId:this.semanticContext.setUserId(t,0);break;case a.Context.Custom.UserInfoLanguage:this.semanticContext.setUserLanguage(t);break;case a.Context.Custom.SessionId:break;default:this.logger.setContext(a.Context.toString(e),t)}},t.prototype.onNavigateAway=function(){microsoft.applications.telemetry.LogManager.flush()},t.prototype.createEventProperties=function(e){var t=new c;for(var n in e)if(e.hasOwnProperty(n)){if(n===a.PropertyName.Reserved.EventType){t.name=e[n].toString();continue}var r=o.ObjectUtils.isNullOrUndefined(e[n])?a.unknownValue:e[n].toString();t.setProperty(n,r)}return t},t.prototype.formatUserLanguage=function(e){return e?e.replace("_","-"):void 0},t}(s.LoggerDecorator);n.AriaLoggerDecorator=p},{"../extensions/DataBoundary":5,"../objectUtils":35,"../settings":37,"./log":16,"./logHelpers":17,"./loggerDecorator":20}],10:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./communicatorLoggerPure"),i=e("./loggerDecorator"),a=function(e){function t(t,n){var r=e.call(this,{component:n})||this;return r.pureLogger=new o.CommunicatorLoggerPure(t),r}return r(t,e),t.prototype.outputEvent=function(e){this.pureLogger.logEvent(e)},t.prototype.outputFailure=function(e,t,n,r){this.pureLogger.logFailure(e,t,n,r)},t.prototype.outputUserFunnel=function(e){this.pureLogger.logUserFunnel(e)},t.prototype.outputSessionStart=function(){this.pureLogger.logSessionStart()},t.prototype.outputSessionEnd=function(e){this.pureLogger.logSessionEnd(e)},t.prototype.outputTrace=function(e,t,n){this.pureLogger.logTrace(e,t,n)},t.prototype.outputClickEvent=function(e){this.pureLogger.logClickEvent(e)},t.prototype.outputSetContext=function(e,t){this.pureLogger.setContextProperty(e,t)},t}(i.LoggerDecorator);n.CommunicatorLoggerDecorator=a},{"./communicatorLoggerPure":11,"./loggerDecorator":20}],11:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../constants"),i=e("./log"),a=e("./logger"),s=function(e){function t(t){var n=e.call(this)||this;return n.communicator=t,n}return r(t,e),t.prototype.logEvent=function(e){e.timerWasStopped()||e.stopTimer(),this.sendDataPackage(i.LogMethods.LogEvent,[e.getEventCategory(),e.getEventData()])},t.prototype.logFailure=function(e,t,n,r){this.sendDataPackage(i.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){this.sendDataPackage(i.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){this.sendDataPackage(i.LogMethods.LogSessionStart,arguments)},t.prototype.logSessionEnd=function(e){this.sendDataPackage(i.LogMethods.LogSessionEnd,arguments)},t.prototype.logTrace=function(e,t,n){n?this.sendDataPackage(i.LogMethods.LogTrace,[e,t,n]):this.sendDataPackage(i.LogMethods.LogTrace,[e,t])},t.prototype.pushToStream=function(e,t){this.sendDataPackage(i.LogMethods.PushToStream,arguments)},t.prototype.logClickEvent=function(e){this.sendDataPackage(i.LogMethods.LogClickEvent,arguments)},t.prototype.setContextProperty=function(e,t){this.sendDataPackage(i.LogMethods.SetContextProperty,arguments)},t.prototype.sendDataPackage=function(e,t){var n={methodName:e,methodArgs:Object.keys(t).map(function(e){return t[e]})};this.communicator.callRemoteFunction(o.Constants.FunctionKeys.telemetry,{param:n})},t}(a.Logger);n.CommunicatorLoggerPure=s},{"../constants":4,"./log":16,"./logger":19}],12:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./consoleLoggerPure"),i=e("./loggerDecorator"),a=function(e){function t(t,n){var r=e.call(this,n)||this;return r.pureConsoleLogger=new o.ConsoleLoggerPure(t),r}return r(t,e),t.prototype.outputEvent=function(e){this.pureConsoleLogger.logEvent(e)},t.prototype.outputFailure=function(e,t,n,r){this.pureConsoleLogger.logFailure(e,t,n,r)},t.prototype.outputUserFunnel=function(e){this.pureConsoleLogger.logUserFunnel(e)},t.prototype.outputSessionStart=function(){this.pureConsoleLogger.logSessionStart()},t.prototype.outputSessionEnd=function(e){this.pureConsoleLogger.logSessionEnd(e)},t.prototype.outputTrace=function(e,t,n){this.pureConsoleLogger.logTrace(e,t,n)},t.prototype.outputClickEvent=function(e){this.pureConsoleLogger.logClickEvent(e)},t.prototype.outputSetContext=function(e,t){this.pureConsoleLogger.setContextProperty(e,t)},t}(i.LoggerDecorator);n.ConsoleLoggerDecorator=a},{"./consoleLoggerPure":13,"./loggerDecorator":20}],13:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./log"),i=e("./consoleLoggerShell"),a=e("./Logger"),s=e("./logHelpers"),u=function(e){function t(t){var n=e.call(this)||this;return n.consoleShell=new i.ConsoleLoggerShell(t),n}return r(t,e),t.prototype.logEvent=function(e){var t=s.LogHelpers.createLogEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logFailure=function(e,t,n,r){var o=s.LogHelpers.createFailureEventAsJson(e,t,n,r);this.consoleShell.logToConsole(o)},t.prototype.logUserFunnel=function(e){var t=s.LogHelpers.createFunnelEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logSessionStart=function(){var e=s.LogHelpers.createSessionStartEventAsJson();this.consoleShell.logToConsole(e)},t.prototype.logSessionEnd=function(e){var t=s.LogHelpers.createSessionEndEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logTrace=function(e,t,n){var r=s.LogHelpers.createTraceEventAsJson(e,t,n);this.consoleShell.logToConsole(r)},t.prototype.pushToStream=function(e,t){},t.prototype.logClickEvent=function(e){var t=s.LogHelpers.createClickEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.setContextProperty=function(e,t){this.consoleShell.setContextProperty(o.Context.toString(e),t)},t}(a.Logger);n.ConsoleLoggerPure=u},{"./Logger":8,"./consoleLoggerShell":14,"./log":16,"./logHelpers":17}],14:[function(e,t,n){"use strict";var r=e("./log"),o=function(){function e(e){this.context={},this.consoleOutput=e}return e.prototype.logToConsole=function(e){if(!e)throw new Error("'event' argument to logToConsole was: "+e);var t=e[r.PropertyName.Reserved.Level];e[r.PropertyName.Reserved.Status]!==r.Status[r.Status.Failed]&&e[r.PropertyName.Reserved.Category]!==r.PropertyName.Reserved.WebClipper+"."+r.Failure.category||(t=r.Trace.Level[r.Trace.Level.Error]);var n=this.consoleOutput,o="";o+="["+e[r.PropertyName.Reserved.EventName]+"]",o+=t?" ["+t+"]":"",o+=r.PropertyName.Reserved.Message in e?" "+e[r.PropertyName.Reserved.Message]:"";var i=this.combineContextAndEvent(e);switch(r.Trace.Level[t]){case r.Trace.Level.Warning:n.warn(o,i);break;case r.Trace.Level.Error:n.error(o,i);break;case r.Trace.Level.Verbose:case r.Trace.Level.Information:n.info(o,i);break;default:n.log(o,i)}},e.prototype.setContextProperty=function(e,t){this.context[e]=t},e.prototype.combineContextAndEvent=function(e){var t={};for(var n in this.context)this.context.hasOwnProperty(n)&&(t[n]=this.context[n]);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},e}();n.ConsoleLoggerShell=o},{"./log":16}],15:[function(e,t,n){"use strict";var r=e("../objectUtils"),o=e("./log"),i=function(){function e(){}return e.prototype.requirementsAreMet=function(e){return!0},e}();n.NoRequirements=i;var a=function(){function e(e){this.prodProperties=[o.Context.toString(o.Context.Custom.AppInfoId),o.Context.toString(o.Context.Custom.AppInfoVersion),o.Context.toString(o.Context.Custom.BrowserLanguage),o.Context.toString(o.Context.Custom.ExtensionLifecycleId),o.Context.toString(o.Context.Custom.ClipperType),o.Context.toString(o.Context.Custom.DeviceInfoId),o.Context.toString(o.Context.Custom.FlightInfo),o.Context.toString(o.Context.Custom.InPrivateBrowsing)],this.requiredProperties=e?e:this.prodProperties}return e.prototype.requirementsAreMet=function(e){if(r.ObjectUtils.isNullOrUndefined(e))return!1;for(var t=0;t<this.requiredProperties.length;++t){var n=this.requiredProperties[t];if(!e.hasOwnProperty(n))return!1}return!0},e}();n.ProductionRequirements=a},{"../objectUtils":35,"./log":16}],16:[function(e,t,n){"use strict";function r(e,t){switch(e.methodName){case i.LogMethods.LogEvent:var n=e.methodArgs[0],r=e.methodArgs[1];t.logEvent.apply(t,[o.Event.createEvent(n,r)]);break;case i.LogMethods.LogFailure:t.logFailure.apply(t,e.methodArgs);break;case i.LogMethods.PushToStream:t.pushToStream.apply(t,e.methodArgs);break;case i.LogMethods.LogFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case i.LogMethods.LogClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case i.LogMethods.SetContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case i.LogMethods.LogTrace:default:t.logTrace.apply(t,e.methodArgs)}}var o=e("./submodules/event"),i=e("./submodules/logMethods");n.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,n.enableConsoleLogging="enable_console_logging",n.reportData="ReportData",n.unknownValue="unknown",n.parseAndLogDataPackage=r;var a=e("./submodules/click");n.Click=a.Click;var s=e("./submodules/context");n.Context=s.Context;var u=e("./submodules/errorUtils");n.ErrorUtils=u.ErrorUtils;var l=e("./submodules/event");n.Event=l.Event;var c=e("./submodules/failure");n.Failure=c.Failure;var p=e("./submodules/funnel");n.Funnel=p.Funnel;var f=e("./submodules/logMethods");n.LogMethods=f.LogMethods;var g=e("./submodules/noop");n.NoOp=g.NoOp;var h=e("./submodules/propertyName");n.PropertyName=h.PropertyName;var d=e("./submodules/session");n.Session=d.Session;var v=e("./submodules/status");n.Status=v.Status;var m=e("./submodules/trace");n.Trace=m.Trace},{"./submodules/click":22,"./submodules/context":23,"./submodules/errorUtils":24,"./submodules/event":25,"./submodules/failure":26,"./submodules/funnel":27,"./submodules/logMethods":28,"./submodules/noop":29,"./submodules/propertyName":30,"./submodules/session":31,"./submodules/status":32,"./submodules/trace":33}],17:[function(e,t,n){"use strict";var r,o=e("./log");!function(e){function t(e,t){var n={};n[o.PropertyName.Reserved.EventType]=o.reportData,n[o.PropertyName.Reserved.Label]=t;var r=o.PropertyName.Reserved.WebClipper+"."+e;return n[o.PropertyName.Reserved.Category]=r,n[o.PropertyName.Reserved.EventName]=r+"."+t,n}function n(t){if(!t)throw new Error("Button clicked without an ID! Logged with ID "+JSON.stringify(t));var n=e.createBaseEventAsJson(o.Click.category,t);return n}function r(t){t.timerWasStopped()||t.stopTimer();
edgeExtension.js:3:var n=t.getEventCategory(),r=e.createBaseEventAsJson(o.Event.Category[n],t.getLabel());switch(r[o.PropertyName.Reserved.Duration]=t.getDuration(),g(r,t.getCustomProperties()),n){case o.Event.Category.BaseEvent:break;case o.Event.Category.PromiseEvent:i(r,t);break;case o.Event.Category.StreamEvent:a(r,t);break;default:throw new Error("createLogEvent does not specify a case for event category: "+o.Event.Category[n])}return r}function i(e,t){var n=t.getStatus();e[o.PropertyName.Reserved.Status]=n,n===o.Status[o.Status.Failed]&&(e[o.PropertyName.Reserved.FailureInfo]=t.getFailureInfo(),e[o.PropertyName.Reserved.FailureType]=t.getFailureType())}function a(e,t){e[o.PropertyName.Reserved.Stream]=JSON.stringify(t.getEventData().Stream)}function s(t,n){var r=new o.Event.BaseEvent(o.Event.Label.SetContextProperty),i=e.createBaseEventAsJson(o.Event.Category[r.getEventCategory()],r.getLabel()),a=o.Context.toString(t);return i[o.PropertyName.Custom[o.PropertyName.Custom.Key]]=a,i[o.PropertyName.Custom[o.PropertyName.Custom.Value]]=n,i}function u(t,n,r,i){var a=e.createBaseEventAsJson(o.Failure.category,o.Failure.Label[t]);return a[o.PropertyName.Reserved.FailureType]=o.Failure.Type[n],r&&(a[o.PropertyName.Reserved.FailureInfo]=o.ErrorUtils.toString(r)),i&&(a[o.PropertyName.Reserved.Id]=i),a[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace(),a}function l(t){var n=e.createBaseEventAsJson(o.Funnel.category,o.Funnel.Label[t]);return n}function c(){var t=e.createBaseEventAsJson(o.Session.category,o.Session.State[o.Session.State.Started]);return t}function p(t){var n=e.createBaseEventAsJson(o.Session.category,o.Session.State[o.Session.State.Ended]);return n[o.PropertyName.Reserved.Trigger]=o.Session.EndTrigger[t],n}function f(t,n,r){var i=e.createBaseEventAsJson(o.Trace.category,o.Trace.Label[t]);switch(r&&(i[o.PropertyName.Reserved.Message]=r),i[o.PropertyName.Reserved.Level]=o.Trace.Level[n],n){case o.Trace.Level.Warning:i[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace()}return i}function g(e,t){if(e[o.PropertyName.Reserved.Status]===o.Status[o.Status.Failed]&&(e[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace()),t)for(var n in t)if(t.hasOwnProperty(n)){var r=void 0;r="object"==typeof t[n]?JSON.stringify(t[n]):t[n],e[n]=r}}function h(){try{if(localStorage.getItem(o.enableConsoleLogging))return!0}catch(e){}return!1}e.createBaseEventAsJson=t,e.createClickEventAsJson=n,e.createLogEventAsJson=r,e.createSetContextEventAsJson=s,e.createFailureEventAsJson=u,e.createFunnelEventAsJson=l,e.createSessionStartEventAsJson=c,e.createSessionEndEventAsJson=p,e.createTraceEventAsJson=f,e.addToLogEvent=g,e.isConsoleOutputEnabled=h}(r=n.LogHelpers||(n.LogHelpers={}))},{"./log":16}],18:[function(e,t,n){"use strict";function r(e,t){var n=u.Settings.getSetting("Aria_Token"),r=new v.ProductionRequirements;return t?o(n,r,t,e):s=new g.AriaLoggerDecorator(n,{contextStrategy:r,sessionId:e})}function o(e,t,n,r){var o=n?new p.CommunicatorLoggerDecorator(n):void 0,i=d.LogHelpers.isConsoleOutputEnabled()?new m.WebConsole:void 0,a=new h.ConsoleLoggerDecorator(i,{component:o});return s=new g.AriaLoggerDecorator(e,{contextStrategy:t,component:a,sessionId:r})}function i(e){s.reInitAriaLogger(e)}function a(e,t){var n=new XMLHttpRequest,r=f.PropertyName.Reserved.WebClipper+"."+e.category,o=u.Settings.getSetting("Misc_Data_Endpoint_Id"),i="https://www.onenote.com/webclipper/data/"+o;i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.event,f.reportData,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.label,e.label,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.category,r,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.eventName,r+"."+e.label,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.HeaderValues.appIdKey.replace(/-/g,""),u.Settings.getSetting("App_Id"),t);for(var a in e.properties)e.properties.hasOwnProperty(a)&&(i=c.UrlUtils.addUrlQueryValue(i,a,e.properties[a],t));n.open("GET",i),n.send()}var s,u=e("../settings"),l=e("../constants"),c=e("../urlUtils"),p=e("../logging/communicatorLoggerDecorator"),f=e("../logging/log"),g=e("../logging/ariaLoggerDecorator_internal"),h=e("../logging/consoleLoggerDecorator"),d=e("../logging/logHelpers"),v=e("../logging/context"),m=e("../logging/webConsole");n.createExtLogger=r,n.reInitLoggerForDataBoundaryChange=i,n.sendMiscLogRequest=a},{"../constants":4,"../logging/ariaLoggerDecorator_internal":9,"../logging/communicatorLoggerDecorator":10,"../logging/consoleLoggerDecorator":12,"../logging/context":15,"../logging/log":16,"../logging/logHelpers":17,"../logging/webConsole":34,"../settings":37,"../urlUtils":39}],19:[function(e,t,n){arguments[4][8][0].apply(n,arguments)},{"./log":16,dup:8}],20:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../stringUtils"),i=e("./log"),a=e("./sessionLogger"),s=function(e){function t(t){var n=this,r=t&&t.contextStrategy?t.contextStrategy:void 0,o=t&&t.sessionId?t.sessionId:void 0;return n=e.call(this,{contextStrategy:r,sessionId:o})||this,n.component=t?t.component:void 0,n}return r(t,e),t.prototype.generateSessionId=function(){},t.prototype.handleSetUserSessionId=function(e){var t,n=this.sessionId.get(),r=this.generateSessionId();return n?t=n:e?t=e:r&&(t=r),this.component&&t?this.component.handleSetUserSessionId(t):this.component&&!t?t=this.component.handleSetUserSessionId():this.component||t||(t=this.currentSessionState===i.Session.State.Started?"cccccccc-"+o.StringUtils.generateGuid().substring(9):void 0),this.sessionId.set(t),this.setContextPropertyPure(i.Context.Custom.SessionId,t),this.outputSetContext(i.Context.Custom.SessionId,t),t},t.prototype.handleClickEvent=function(e){this.outputClickEvent(e),this.component&&this.component.executeClickEvent(e)},t.prototype.handleEvent=function(e){this.handleEventPure(e),this.component&&this.component.logEvent(e)},t.prototype.handleEventPure=function(e){this.outputEvent(e)},t.prototype.handleSessionStart=function(){this.outputSessionStart(),this.component&&this.component.executeSessionStart()},t.prototype.handleSessionEnd=function(e){this.outputSessionEnd(e),this.component&&this.component.executeSessionEnd(e)},t.prototype.handleFailure=function(e,t,n,r){this.outputFailure(e,t,n,r),this.component&&this.component.logFailure(e,t,n,r)},t.prototype.handleUserFunnel=function(e){this.outputUserFunnel(e),this.component&&this.component.logUserFunnel(e)},t.prototype.handleTrace=function(e,t,n){this.outputTrace(e,t,n),this.component&&this.component.logTrace(e,t,n)},t.prototype.handleSetContext=function(e,t){this.outputSetContext(e,t),this.component&&this.component.setContextProperty(e,t)},t}(a.SessionLogger);n.LoggerDecorator=s},{"../stringUtils":38,"./log":16,"./sessionLogger":21}],21:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../communicator/smartValue"),i=e("../constants"),a=e("../objectUtils"),s=e("./log"),u=e("./logger"),l=function(e){function t(t){var n=e.call(this)||this;return n.contextProperties={},n.currentSessionState=s.Session.State.Ended,n.logQueue=[],n.streams={},n.userHasInteracted=!1,n.sessionId=void 0,n.sessionId=t&&t.sessionId?t.sessionId:new o.SmartValue,n.contextStrategy=t?t.contextStrategy:void 0,n}return r(t,e),t.prototype.hasUserInteracted=function(){return this.userHasInteracted},t.prototype.getUserSessionId=function(e){return this.sessionId.get()},t.prototype.sendFunnelInteractionEvent=function(e){var t=[i.Constants.Ids.signInButtonMsa,i.Constants.Ids.signInButtonOrgId,i.Constants.Ids.signOutButton,i.Constants.Ids.closeButton,i.Constants.Ids.clipButton,i.Constants.Ids.launchOneNoteButton,i.Constants.Ids.checkOutWhatsNewButton,i.Constants.Ids.proceedToWebClipperButton];this.hasUserInteracted()||t.indexOf(e)!==-1||(this.userHasInteracted=!0,this.logUserFunnel(s.Funnel.Label.Interact))},t.prototype.logEvent=function(e){return a.ObjectUtils.isNullOrUndefined(e)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleEvent(e):void this.pushDataPackage(s.LogMethods.LogEvent,arguments)},t.prototype.logFailure=function(e,t,n,r){return a.ObjectUtils.isNullOrUndefined(e)||a.ObjectUtils.isNullOrUndefined(t)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleFailure(e,t,n,r):void this.pushDataPackage(s.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){return a.ObjectUtils.isNullOrUndefined(e)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleUserFunnel(e):void this.pushDataPackage(s.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){return this.areContextRequirementsMet()?(this.executeSessionStart(),void this.handleSetUserSessionId()):void this.pushDataPackage(s.LogMethods.LogSessionStart,arguments)},t.prototype.executeSessionStart=function(){if(this.currentSessionState===s.Session.State.Started){var e="Session already STARTED";return void this.logFailure(s.Failure.Label.SessionAlreadySet,s.Failure.Type.Unexpected,{error:e})}this.streams={},this.currentSessionState=s.Session.State.Started,this.handleSessionStart()},t.prototype.logSessionEnd=function(e){return this.areContextRequirementsMet()?(this.executeSessionEnd(e),void this.handleSetUserSessionId()):void this.pushDataPackage(s.LogMethods.LogSessionEnd,arguments)},t.prototype.executeSessionEnd=function(e){if(this.currentSessionState===s.Session.State.Ended){var t="Session already ENDED";return a.ObjectUtils.isNullOrUndefined(e)||(t+=". EndTrigger: "+s.Session.EndTrigger[e]),void this.logFailure(s.Failure.Label.SessionAlreadySet,s.Failure.Type.Unexpected,{error:t})}this.logAllStreams(),this.sessionId.set(void 0),this.userHasInteracted=!1,this.currentSessionState=s.Session.State.Ended,this.handleSessionEnd(e)},t.prototype.logTrace=function(e,t,n){return a.ObjectUtils.isNullOrUndefined(e)||a.ObjectUtils.isNullOrUndefined(t)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleTrace(e,t,n):void this.pushDataPackage(s.LogMethods.LogTrace,arguments)},t.prototype.pushToStream=function(e,t){if(a.ObjectUtils.isNullOrUndefined(e))return void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected);var n=s.Event.Label[e];t&&(this.streams[n]||(this.streams[n]=[]),this.streams[n].push(t))},t.prototype.logClickEvent=function(e){return this.areContextRequirementsMet()?(this.sendFunnelInteractionEvent(e),void this.executeClickEvent(e)):void this.pushDataPackage(s.LogMethods.LogClickEvent,arguments)},t.prototype.executeClickEvent=function(e){return e?(this.pushToStream(s.Event.Label.Click,e),void this.handleClickEvent(e)):void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected,{error:"Button clicked without an ID! Logged with ID "+JSON.stringify(e)})},t.prototype.setContextProperty=function(e,t){this.setContextPropertyPure(e,t),this.handleSetContext(e,t),this.areContextRequirementsMet()&&this.flushEventQueue()},t.prototype.setContextPropertyPure=function(e,t){var n=s.Context.toString(e);this.contextProperties[n]=t},t.prototype.areContextRequirementsMet=function(){return!this.contextStrategy||this.contextStrategy.requirementsAreMet(this.contextProperties)},t.prototype.flushEventQueue=function(){var e=this;this.isQueueFlushing||this.isQueueFlushed||(this.isQueueFlushing=!0,this.logQueue.forEach(function(t){switch(t.methodName){case s.LogMethods.LogEvent:e.logEvent.apply(e,t.methodArgs);break;case s.LogMethods.LogFailure:e.logFailure.apply(e,t.methodArgs);break;case s.LogMethods.PushToStream:e.pushToStream.apply(e,t.methodArgs);break;case s.LogMethods.LogFunnel:e.logUserFunnel.apply(e,t.methodArgs);break;case s.LogMethods.LogSessionStart:e.logSessionStart.apply(e,t.methodArgs);break;case s.LogMethods.LogSessionEnd:e.logSessionEnd.apply(e,t.methodArgs);break;case s.LogMethods.LogClickEvent:e.logClickEvent.apply(e,t.methodArgs);break;case s.LogMethods.SetContextProperty:e.setContextProperty.apply(e,t.methodArgs);break;case s.LogMethods.LogTrace:default:e.logTrace.apply(e,t.methodArgs)}}),this.isQueueFlushing=!1,this.isQueueFlushed=!0)},t.prototype.logAllStreams=function(){for(var e in this.streams)if(this.streams.hasOwnProperty(e)){for(var t=new s.Event.StreamEvent(s.Event.Label[e]),n=this.streams[e],r=0;r<n.length;r++)t.append(n[r]);this.handleEventPure(t)}},t.prototype.pushDataPackage=function(e,t){this.logQueue.push({methodName:e,methodArgs:t})},t}(u.Logger);n.SessionLogger=l},{"../communicator/smartValue":3,"../constants":4,"../objectUtils":35,"./log":16,"./logger":19}],22:[function(e,t,n){"use strict";var r;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(r=n.Click||(n.Click={}))},{}],23:[function(e,t,n){"use strict";var r;!function(e){function t(e){return r[n[e]]}var n,r={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",ExtensionLifecycleId:"ExtensionLifecycle.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.ExtensionLifecycleId=2]="ExtensionLifecycleId",e[e.DeviceInfoId=3]="DeviceInfoId",e[e.SessionId=4]="SessionId",e[e.UserInfoId=5]="UserInfoId",e[e.UserInfoLanguage=6]="UserInfoLanguage",e[e.AuthType=7]="AuthType",e[e.BrowserLanguage=8]="BrowserLanguage",e[e.ClipperType=9]="ClipperType",e[e.ContentType=10]="ContentType",e[e.FlightInfo=11]="FlightInfo",e[e.InPrivateBrowsing=12]="InPrivateBrowsing",e[e.PageLanguage=13]="PageLanguage"}(n=e.Custom||(e.Custom={})),e.toString=t}(r=n.Context||(n.Context={}))},{}],24:[function(e,t,n){"use strict";var r,o=e("../../clientType"),i=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),u=e("../log");!function(e){function t(e){if(e){var t={};t[g[g.Error].toLowerCase()]=e.error;var n=e;return n&&void 0!==n.statusCode&&(t[g[g.StatusCode].toLowerCase()]=n.statusCode,t[g[g.Response].toLowerCase()]=n.response,t[g[g.ResponseHeaders].toLowerCase()]=n.responseHeaders,void 0!==n.timeout&&(t[g[g.Timeout].toLowerCase()]=n.timeout)),JSON.stringify(t)}}function n(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function r(t){var n={};n[i.Constants.Urls.QueryParams.failureType]=u.Failure.Type[t.properties.failureType],n[i.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),n[i.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,a.ObjectUtils.isNullOrUndefined(t.properties.failureId)||(n[i.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var r=t.clientInfo;f(n,r),LogManager.sendMiscLogRequest({label:u.Failure.Label[t.label],category:u.Failure.category,properties:n},!0)}function l(t,n,r,o){var i;throw i=o?JSON.stringify({message:o,error:n.toString()}):n.toString(),e.sendFailureLogRequest({label:u.Failure.Label.UnhandledExceptionThrown,properties:{failureType:u.Failure.Type.Unexpected,failureInfo:{error:i},failureId:"Channel "+t,stackTrace:u.Failure.getStackTrace(n)},clientInfo:r}),n}function c(e,t){void 0===t&&(t=!1);var n={};n[i.Constants.Urls.QueryParams.channel]=e.channel,n[i.Constants.Urls.QueryParams.timeoutInMs]=i.Constants.Settings.noOpTrackerTimeoutDuration.toString();var r=e.clientInfo;f(n,r),LogManager.sendMiscLogRequest({label:u.NoOp.Label[e.label],category:u.NoOp.category,properties:n},!0),t&&window&&window.alert(s.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function p(e,t){return void 0===t&&(t=!1),setTimeout(function(){c(e,t)},i.Constants.Settings.noOpTrackerTimeoutDuration)}function f(e,t){t&&(e[i.Constants.Urls.QueryParams.clientType]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:o.ClientType[t.get().clipperType],e[i.Constants.Urls.QueryParams.clipperVersion]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:t.get().clipperVersion,e[i.Constants.Urls.QueryParams.clipperId]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:t.get().clipperId)}var g;!function(e){e[e.Error=0]="Error",e[e.StatusCode=1]="StatusCode",e[e.Response=2]="Response",e[e.ResponseHeaders=3]="ResponseHeaders",e[e.Timeout=4]="Timeout"}(g||(g={})),e.toString=t,e.clone=n,e.sendFailureLogRequest=r,e.handleCommunicatorError=l,e.sendNoOpTrackerRequest=c,e.setNoOpTrackerRequestTimeout=p}(r=n.ErrorUtils||(n.ErrorUtils={}))},{"../../clientType":1,"../../constants":4,"../../localization/localization":7,"../../objectUtils":35,"../log":16}],25:[function(e,t,n){"use strict";var r,o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../log"),a=e("../../objectUtils");!function(e){function t(t,n){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(n);case e.Category.PromiseEvent:return new e.PromiseEvent(n);case e.Category.StreamEvent:return new e.StreamEvent(n)}}var n;!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(n=e.Category||(e.Category={}));var r;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipAugmentationOptions=6]="ClipAugmentationOptions",e[e.ClipCommonOptions=7]="ClipCommonOptions",e[e.ClipPdfOptions=8]="ClipPdfOptions",e[e.ClipRegionOptions=9]="ClipRegionOptions",e[e.ClipSelectionOptions=10]="ClipSelectionOptions",e[e.ClipToOneNoteAction=11]="ClipToOneNoteAction",e[e.CloseClipper=12]="CloseClipper",e[e.ClosePageNavTooltip=13]="ClosePageNavTooltip",e[e.CreateNotebook=14]="CreateNotebook",e[e.CreatePage=15]="CreatePage",e[e.CreateSection=16]="CreateSection",e[e.DebugFeedback=17]="DebugFeedback",e[e.DeviceIdMap=18]="DeviceIdMap",e[e.FetchNonLocalData=19]="FetchNonLocalData",e[e.FullPageScreenshotCall=20]="FullPageScreenshotCall",e[e.GetBinaryRequest=21]="GetBinaryRequest",e[e.GetCleanDom=22]="GetCleanDom",e[e.GetExistingUserInformation=23]="GetExistingUserInformation",e[e.GetFlightingAssignments=24]="GetFlightingAssignments",e[e.GetLocale=25]="GetLocale",e[e.GetLocalizedStrings=26]="GetLocalizedStrings",e[e.GetNotebookByName=27]="GetNotebookByName",e[e.GetNotebooks=28]="GetNotebooks",e[e.GetPage=29]="GetPage",e[e.GetPageContent=30]="GetPageContent",e[e.GetPages=31]="GetPages",e[e.HandleSignInEvent=32]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=33]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=34]="InvokeClipper",e[e.InvokeTooltip=35]="InvokeTooltip",e[e.InvokeWhatsNew=36]="InvokeWhatsNew",e[e.LocalFilesNotAllowedPanelShown=37]="LocalFilesNotAllowedPanelShown",e[e.PagesSearch=38]="PagesSearch",e[e.PdfByteMetadata=39]="PdfByteMetadata",e[e.PdfDataUrlMetadata=40]="PdfDataUrlMetadata",e[e.ProcessPdfIntoDataUrls=41]="ProcessPdfIntoDataUrls",e[e.RegionSelectionCapturing=42]="RegionSelectionCapturing",e[e.RegionSelectionLoading=43]="RegionSelectionLoading",e[e.RegionSelectionProcessing=44]="RegionSelectionProcessing",e[e.RetrieveUserInformation=45]="RetrieveUserInformation",e[e.SendBatchRequest=46]="SendBatchRequest",e[e.SetContextProperty=47]="SetContextProperty",e[e.SetDoNotPromptRatings=48]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=49]="ShouldShowRatingsPrompt",e[e.TooltipImpression=50]="TooltipImpression",e[e.UpdatePage=51]="UpdatePage",e[e.UserInfoUpdated=52]="UserInfoUpdated",e[e.WhatsNewImpression=53]="WhatsNewImpression"}(r=e.Label||(e.Label={}));var s=function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var n=e;this._label=n,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+i.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[i.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||a.ObjectUtils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in i.PropertyName.Reserved)if(i.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}();e.BaseEvent=s;var u=function(t){function n(e){var n=t.call(this,e)||this;if(n._logStatus=i.Status.Succeeded,n._failureType=i.Failure.Type.Unexpected,n.isEventData(e)){var r=e;n._logStatus=r.LogStatus,n._failureType=r.FailureType,n._failureInfo=i.ErrorUtils.clone(r.FailureInfo)}return n}return o(n,t),n.prototype.getEventCategory=function(){return e.Category.PromiseEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:i.ErrorUtils.clone(this._failureInfo)}},n.prototype.getStatus=function(){return i.Status[this._logStatus]},n.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},n.prototype.getFailureInfo=function(){return i.ErrorUtils.toString(this._failureInfo)},n.prototype.setFailureInfo=function(e){this._failureInfo=i.ErrorUtils.clone(e)},n.prototype.getFailureType=function(){return i.Failure.Type[this._failureType]},n.prototype.setFailureType=function(e){this._failureType=e},n}(s);e.PromiseEvent=u;var l=function(t){function n(e){var n=t.call(this,e)||this;if(n._stream=[],n.isEventData(e)){var r=e;n._stream=r.Stream}return n}return o(n,t),n.prototype.getEventCategory=function(){return e.Category.StreamEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},n.prototype.append=function(e){this._stream.push(e)},n}(s);e.StreamEvent=l,e.createEvent=t}(r=n.Event||(n.Event={}))},{"../../objectUtils":35,"../log":16}],26:[function(e,t,n){"use strict";var r;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure";var n;!function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(n=e.Type||(e.Type={})),e.getStackTrace=t;var r;!function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",e[e.EndSessionWithoutTrigger=1]="EndSessionWithoutTrigger",e[e.GetChangeLog=2]="GetChangeLog",e[e.GetComputedStyle=3]="GetComputedStyle",e[e.GetLocalizedString=4]="GetLocalizedString",e[e.GetSetting=5]="GetSetting",e[e.IFrameMessageHandlerHasNoOtherWindow=6]="IFrameMessageHandlerHasNoOtherWindow",e[e.InvalidArgument=7]="InvalidArgument",e[e.IsFeatureEnabled=8]="IsFeatureEnabled",e[e.JsonParse=9]="JsonParse",e[e.NotImplemented=10]="NotImplemented",e[e.OnLaunchOneNoteButton=11]="OnLaunchOneNoteButton",e[e.OrphanedWebClippersDueToExtensionRefresh=12]="OrphanedWebClippersDueToExtensionRefresh",e[e.RegionSelectionProcessing=13]="RegionSelectionProcessing",e[e.RenderFailurePanel=14]="RenderFailurePanel",e[e.ReservedPropertyOverwriteAttempted=15]="ReservedPropertyOverwriteAttempted",e[e.SessionAlreadySet=16]="SessionAlreadySet",e[e.SetLoggerNoop=17]="SetLoggerNoop",e[e.SetUndefinedLocalizedStrings=18]="SetUndefinedLocalizedStrings",e[e.TraceLevelErrorWarningMessage=19]="TraceLevelErrorWarningMessage",e[e.UnhandledApiCode=20]="UnhandledApiCode",e[e.UnhandledExceptionThrown=21]="UnhandledExceptionThrown",e[e.UserSetWithInvalidExpiredData=22]="UserSetWithInvalidExpiredData",e[e.WebExtensionWindowCreate=23]="WebExtensionWindowCreate",e[e.UnclippablePage=24]="UnclippablePage",e[e.UnsupportedBrowser=25]="UnsupportedBrowser"}(r=e.Label||(e.Label={}))}(r=n.Failure||(n.Failure={}))},{}],27:[function(e,t,n){"use strict";var r;!function(e){e.category="Funnel";var t;!function(e){e[e.Invoke=0]="Invoke",e[e.AuthAlreadySignedIn=1]="AuthAlreadySignedIn",e[e.AuthAttempted=2]="AuthAttempted",e[e.AuthSignInCompleted=3]="AuthSignInCompleted",e[e.AuthSignInFailed=4]="AuthSignInFailed",e[e.ClipAttempted=5]="ClipAttempted",e[e.Interact=6]="Interact",e[e.ViewInWac=7]="ViewInWac",e[e.SignOut=8]="SignOut"}(t=e.Label||(e.Label={}))}(r=n.Funnel||(n.Funnel={}))},{}],28:[function(e,t,n){"use strict";var r;!function(e){e[e.LogEvent=0]="LogEvent",e[e.LogFailure=1]="LogFailure",e[e.PushToStream=2]="PushToStream",e[e.LogFunnel=3]="LogFunnel",e[e.LogSession=4]="LogSession",e[e.LogSessionStart=5]="LogSessionStart",e[e.LogSessionEnd=6]="LogSessionEnd",e[e.LogTrace=7]="LogTrace",e[e.LogClickEvent=8]="LogClickEvent",e[e.SetContextProperty=9]="SetContextProperty"}(r=n.LogMethods||(n.LogMethods={}))},{}],29:[function(e,t,n){"use strict";var r;!function(e){e.category="NoOp";var t;!function(e){e[e.InitializeCommunicator=0]="InitializeCommunicator",e[e.WebClipperUiFrameDidNotExist=1]="WebClipperUiFrameDidNotExist",e[e.WebClipperUiFrameIsNotVisible=2]="WebClipperUiFrameIsNotVisible"}(t=e.Label||(e.Label={}))}(r=n.NoOp||(n.NoOp={}))},{}],30:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e[e.AnnotationAdded=0]="AnnotationAdded",e[e.AugmentationModel=1]="AugmentationModel",e[e.AverageProcessingDurationPerPage=2]="AverageProcessingDurationPerPage",e[e.ByteLength=3]="ByteLength",e[e.BytesPerPdfPage=4]="BytesPerPdfPage",e[e.BytesTrimmed=5]="BytesTrimmed",e[e.Channel=6]="Channel",e[e.ClipMode=7]="ClipMode",e[e.CloseReason=8]="CloseReason",e[e.ContainsAtLeastOneHighlight=9]="ContainsAtLeastOneHighlight",e[e.ContentType=10]="ContentType",e[e.CorrelationId=11]="CorrelationId",e[e.CurrentPanel=12]="CurrentPanel",e[e.CurrentSectionStillExists=13]="CurrentSectionStillExists",e[e.DeviceIdInStorage=14]="DeviceIdInStorage",e[e.DeviceIdInCookie=15]="DeviceIdInCookie",e[e.DomSizeInBytes=16]="DomSizeInBytes",e[e.FeatureEnabled=17]="FeatureEnabled",e[e.FinalDataUrlLength=18]="FinalDataUrlLength",e[e.FontSize=19]="FontSize",e[e.ForceRetrieveFreshLocStrings=20]="ForceRetrieveFreshLocStrings",e[e.FreshUserInfoAvailable=21]="FreshUserInfoAvailable",e[e.FullPageScreenshotContentFound=22]="FullPageScreenshotContentFound",e[e.Height=23]="Height",e[e.InitialDataUrlLength=24]="InitialDataUrlLength",e[e.InvokeMode=25]="InvokeMode",e[e.InvokeSource=26]="InvokeSource",e[e.IsHighDpiScreen=27]="IsHighDpiScreen",e[e.IsRetryable=28]="IsRetryable",e[e.IsSerif=29]="IsSerif",e[e.Key=30]="Key",e[e.LastSeenTooltipTime=31]="LastSeenTooltipTime",e[e.LastUpdated=32]="LastUpdated",e[e.MaxDepth=33]="MaxDepth",e[e.NumPages=34]="NumPages",e[e.NumRegions=35]="NumRegions",e[e.NumTimesTooltipHasBeenSeen=36]="NumTimesTooltipHasBeenSeen",e[e.PageNavTooltipType=37]="PageNavTooltipType",e[e.PageTitleModified=38]="PageTitleModified",e[e.PdfAllPagesClipped=39]="PdfAllPagesClipped",e[e.PdfAttachmentClipped=40]="PdfAttachmentClipped",e[e.PdfFileSelectedPageCount=41]="PdfFileSelectedPageCount",e[e.PdfFileTotalPageCount=42]="PdfFileTotalPageCount",e[e.PdfIsBatched=43]="PdfIsBatched",e[e.PdfIsLocalFile=44]="PdfIsLocalFile",e[e.RatingsInfo=45]="RatingsInfo",e[e.ShouldShowRatingsPrompt=46]="ShouldShowRatingsPrompt",e[e.SignInCancelled=47]="SignInCancelled",e[e.StoredLocaleDifferentThanRequested=48]="StoredLocaleDifferentThanRequested",e[e.TimeToClearNoOpTracker=49]="TimeToClearNoOpTracker",e[e.TooltipType=50]="TooltipType",e[e.UpdateInterval=51]="UpdateInterval",e[e.UserInformationReturned=52]="UserInformationReturned",e[e.UserInformationStored=53]="UserInformationStored",e[e.UserUpdateReason=54]="UserUpdateReason",e[e.Value=55]="Value",e[e.Width=56]="Width",e[e.WriteableCookies=57]="WriteableCookies",e[e.DataBoundary=58]="DataBoundary"}(t=e.Custom||(e.Custom={}));var n;!function(e){e.Category="Category",e.Duration="Duration",e.EventName="EventName",e.EventType="EventType",e.FailureInfo="FailureInfo",e.FailureType="FailureType",e.Id="Id",e.Label="Label",e.Level="Level",e.Message="Message",e.Properties="Properties",e.StackTrace="StackTrace",e.Status="Status",e.Stream="Stream",e.Trigger="Trigger",e.WebClipper="WebClipper"}(n=e.Reserved||(e.Reserved={}))}(r=n.PropertyName||(n.PropertyName={}))},{}],31:[function(e,t,n){"use strict";var r;!function(e){e.category="Session";var t;!function(e){e[e.SignOut=0]="SignOut",e[e.Unload=1]="Unload"}(t=e.EndTrigger||(e.EndTrigger={}));var n;!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(n=e.State||(e.State={}))}(r=n.Session||(n.Session={}))},{}],32:[function(e,t,n){"use strict";var r;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(r=n.Status||(n.Status={}))},{}],33:[function(e,t,n){"use strict";var r;!function(e){e.category="Trace";var t;!function(e){e[e.DefaultingToConsoleLogger=0]="DefaultingToConsoleLogger",e[e.DebugMode=1]="DebugMode",e[e.RequestForClipperInstalledPageUrl=2]="RequestForClipperInstalledPageUrl",e[e.General=3]="General"}(t=e.Label||(e.Label={}));var n;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Verbose=4]="Verbose"}(n=e.Level||(e.Level={}))}(r=n.Trace||(n.Trace={}))},{}],34:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.warn=function(e,t){console.warn(e,t)},e.prototype.error=function(e,t){console.error(e,t)},e.prototype.info=function(e,t){console.info(e,t)},e.prototype.log=function(e,t){console.log(e,t)},e}();n.WebConsole=r},{}],35:[function(e,t,n){"use strict";var r;!function(e){function t(e){return"number"==typeof e&&!isNaN(e)}function n(e){return null===e||void 0===e}e.isNumeric=t,e.isNullOrUndefined=n}(r=n.ObjectUtils||(n.ObjectUtils={}))},{}],36:[function(e,t,n){"use strict";var r;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(r=n.OperationResult||(n.OperationResult={}))},{}],37:[function(e,t,n){"use strict";var r,o=e("../settings.json");!function(t){function n(e){var t=o[e];if(t&&t.Value)return t.Value}function r(t){o=t?t:e("../settings.json")}t.getSetting=n,t.setSettingsJsonForTesting=r}(r=n.Settings||(n.Settings={}))},{"../settings.json":40}],38:[function(e,t,n){"use strict";var r,o=e("./objectUtils"),i=e("./operationResult"),a=e("./localization/localization"),s=e("lodash");!function(e){function t(e,t){if(o.ObjectUtils.isNullOrUndefined(e))return r("");if(e=e.trim(),""===e)return r("");for(var i=e.split(","),a=[],u=0;u<i.length;++u){var l=[],c=void 0,p=i[u].trim();if(""!==p){
edgeExtension.js:37:!function(){function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return e}()({1:[function(e,t,n){"use strict";var r;!function(e){function t(e){var t=document.createElement("iframe");t.hidden=!0,t.style.display="none",t.src=e,document.body.appendChild(t)}function n(){return!window.addEventListener||navigator.appVersion.indexOf("MSIE 9")>=0}function r(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>=0)return"IE"+e.substring(t+5,e.indexOf(".",t));if(e.indexOf("Trident/")>=0){var n=e.indexOf("rv:");return"IE"+e.substring(n+3,e.indexOf(".",n))}return e.indexOf("Edge/")>=0?"Edge":void 0}function o(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=700);var r=screen.width?(screen.width-t)/2:0,o=screen.height?(screen.height-n)/2:0,i="height="+n+",width="+t+",top="+o+",left="+r+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no";return window.open(e,"_blank",i)}e.appendHiddenIframeToDocument=t,e.browserNotSupported=n,e.ieVersion=r,e.openPopupWindow=o}(r=n.BrowserUtils||(n.BrowserUtils={}))},{}],2:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(r=n.ClientType||(n.ClientType={}))},{}],3:[function(e,t,n){"use strict";var r=e("../communicator/smartValue"),o=e("../storage/remoteStorage"),i=function(){function e(){}return e.getUserSessionId=function(){return e.sessionId.get()},e.getUserSessionIdWhenDefined=function(){return new Promise(function(t){var n=e.sessionId.get();n?t(n):e.sessionId.subscribe(function(e){t(e)},{times:1,callOnSubscribe:!1})})},e.getInjectCommunicator=function(){return e.injectCommunicator},e.setInjectCommunicator=function(t){e.injectCommunicator=t},e.getExtensionCommunicator=function(){return e.extensionCommunicator},e.setExtensionCommunicator=function(t){e.extensionCommunicator=t,e.setUpRemoteStorage(t)},e.getCachedValue=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");return e.storage.getCachedValue(t)},e.getStoredValue=function(t,n,r){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValue(t,n,r)},e.preCacheStoredValues=function(t){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.getValues(t,function(){},!0)},e.storeValue=function(t,n){if(!e.storage)throw new Error("The remote storage needs to be set up with the extension communicator first");e.storage.setValue(t,n,void 0)},e.setUpRemoteStorage=function(t){e.storage=new o.RemoteStorage(e.getExtensionCommunicator())},e}();i.sessionId=new r.SmartValue,n.Clipper=i},{"../communicator/smartValue":8,"../storage/remoteStorage":57}],4:[function(e,t,n){"use strict";var r,o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(r=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case r.Pdf:return o.InvokeSource.PdfTooltip;case r.Product:return o.InvokeSource.ProductTooltip;case r.Recipe:return o.InvokeSource.RecipeTooltip;case r.Video:return o.InvokeSource.VideoTooltip;case r.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":19}],5:[function(e,t,n){"use strict";var r,o=e("./clientType"),i=e("./constants"),a=e("./urlUtils");!function(e){function t(e,t,n){var r=a.UrlUtils.addUrlQueryValue(i.Constants.Urls.clipperFeedbackUrl,"LogCategory",n);return r=a.UrlUtils.addUrlQueryValue(r,"originalUrl",e.pageInfo.rawUrl),r=a.UrlUtils.addUrlQueryValue(r,"clipperId",e.clientInfo.clipperId),r=a.UrlUtils.addUrlQueryValue(r,"usid",t),r=a.UrlUtils.addUrlQueryValue(r,"type",o.ClientType[e.clientInfo.clipperType]),r=a.UrlUtils.addUrlQueryValue(r,"version",e.clientInfo.clipperVersion)}function n(e,t,n){return s(i.Constants.Urls.Authentication.signInUrl,e,t,n)}function r(e,t,n){return s(i.Constants.Urls.Authentication.signOutUrl,e,t,n)}function s(e,t,n,r){var o=a.UrlUtils.addUrlQueryValue(e,i.Constants.Urls.QueryParams.authType,r);return o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.clipperId,t),o=a.UrlUtils.addUrlQueryValue(o,i.Constants.Urls.QueryParams.userSessionId,n)}e.generateFeedbackUrl=t,e.generateSignInUrl=n,e.generateSignOutUrl=r}(r=n.ClipperUrls||(n.ClipperUrls={}))},{"./clientType":2,"./constants":9,"./urlUtils":59}],6:[function(e,t,n){"use strict";var r=function(){function e(e,t){this.otherSideKeys={},this.queuedCalls={},this.callbackIdPostfix=0,this.functionMap={},this.svFunctions={},this.trackedSmartValues={},this.channel=t,this.messageHandler=e,this.messageHandler.onMessageReceived=this.parseMessage.bind(this),this.sendInitializationMessage()}return e.prototype.getMessageHandler=function(){return this.messageHandler},e.prototype.onInitialized=function(){},e.prototype.tearDown=function(){for(var e in this.trackedSmartValues)if(this.trackedSmartValues.hasOwnProperty(e)&&this.svFunctions[e])for(var t=0;t<this.svFunctions[e].length;t++)this.trackedSmartValues[e].unsubscribe(this.svFunctions[e][t]);this.messageHandler.tearDown()},e.prototype.setErrorHandler=function(e){this.communicatorErrorHandler=e},e.prototype.parseMessage=function(e){var t;try{t=JSON.parse(e)}catch(e){return}if(t&&(!this.channel||t.channel&&t.channel===this.channel)&&(this.channel||!t.channel))try{this.handleDataPackage(t)}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e.prototype.handleDataPackage=function(t){var n=this;if(t.functionKey===e.initializationKey){this.sendAcknowledgementMessage();for(var r in this.functionMap)this.functionMap.hasOwnProperty(r)&&this.postMessage({data:r,functionKey:e.registrationKey});this.onInitialized()}else if(t.functionKey===e.acknowledgeKey)this.onInitialized();else if(t.functionKey===e.registrationKey){var o=t.data.toString();if(this.otherSideKeys[o]||(this.otherSideKeys[o]=!0),this.isSmartValueSubscription(o)){var i=o.substr(e.setValuePrefix.length),a=this.trackedSmartValues[i];a&&this.updateRemoteSmartValue(i,a.get())}else if(this.queuedCalls[o]){for(var s=this.queuedCalls[o],u=0;u<s.length;u++)this.postMessage(s[u]);delete this.queuedCalls[o]}}else{var l=this.functionMap[t.functionKey];if(l){var c=l(t.data);c&&c.then&&t.callbackKey&&c.then(function(e){n.callRemoteFunction(t.callbackKey,{param:e})},function(e){n.callRemoteFunction(t.callbackKey,{param:e})})}}},e.prototype.registerFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");this.functionMap[t]=n,this.postMessage({data:t,functionKey:e.registrationKey})},e.prototype.callRemoteFunction=function(t,n){if(!t)throw new Error("param 'name' is invalid");var r=n?n.param:void 0,o=void 0;n&&n.callback&&(o=t+e.callbackPostfix+"-"+this.callbackIdPostfix++,this.registerFunction(o,n.callback));var i={data:r,functionKey:t};o&&(i.callbackKey=o),this.otherSideKeys[t]?this.postMessage(i):this.isSmartValueSubscription(t)||(this.queuedCalls[t]=this.queuedCalls[t]||[],this.queuedCalls[t].push(i))},e.prototype.subscribeAcrossCommunicator=function(t,n,r){r&&t.subscribe(r,{callOnSubscribe:!1}),this.registerFunction(e.setValuePrefix+n,function(e){t.set(e)})},e.prototype.broadcastAcrossCommunicator=function(e,t){var n=this,r=function(e){n.updateRemoteSmartValue(t,e)};this.svFunctions[t]||(this.svFunctions[t]=[]),this.svFunctions[t].push(r),this.trackedSmartValues[t]=e,e.subscribe(r)},e.prototype.updateRemoteSmartValue=function(t,n){this.callRemoteFunction(e.setValuePrefix+t,{param:n})},e.prototype.sendInitializationMessage=function(){this.postMessage({functionKey:e.initializationKey})},e.prototype.sendAcknowledgementMessage=function(){this.postMessage({functionKey:e.acknowledgeKey})},e.prototype.isSmartValueSubscription=function(t){return t.substr(0,e.setValuePrefix.length)===e.setValuePrefix},e.prototype.postMessage=function(e){this.channel&&(e.channel=this.channel);try{this.messageHandler.sendMessage(JSON.stringify(e))}catch(e){if(!this.communicatorErrorHandler)throw e;this.communicatorErrorHandler(e)}},e}();r.initializationKey="INITIALIZATION-K3Y",r.acknowledgeKey="ACKNOWLEDGE-K3Y",r.registrationKey="REGISTER-FUNCTION-K3Y",r.setValuePrefix="SETVALUE-",r.callbackPostfix="-CALLBACK",n.Communicator=r},{}],7:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.onMessageReceived=function(e){},e}();n.MessageHandler=r},{}],8:[function(e,t,n){"use strict";var r=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],r=0;r<e.length;r++)n.push(e[r].get());t.apply(this,n)})},e}();n.SmartValue=r},{}],9:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var r;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(r=e.Extension||(e.Extension={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var u;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(u=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.c="KeyC"}(l=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var f;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(f=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var d;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(d=e.Settings||(e.Settings={}));var h;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(h=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var v;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(v=e.AriaSet||(e.AriaSet={}))}(r=n.Constants||(n.Constants={}))},{}],10:[function(e,t,n){"use strict";var r=e("./objectUtils"),o=function(){function e(){}return e.readCookie=function(e,t){r.ObjectUtils.isNullOrUndefined(t)&&(t=document);for(var n=document.cookie.split(";").map(function(e){return e.split("=")}),o=0,i=n;o<i.length;o++){var a=i[o];if(a[0].trim()===e)return a[1].trim()}},e}();n.CookieUtils=o},{"./objectUtils":47}],11:[function(e,t,n){"use strict";var r,o=e("../objectUtils"),i=e("../urlUtils");!function(e){e[e.YouTube=0]="YouTube",e[e.Vimeo=1]="Vimeo",e[e.KhanAcademy=2]="KhanAcademy"}(r=n.SupportedVideoDomains||(n.SupportedVideoDomains={}));var a=function(){function e(){this.youTubeWatchVideoBaseUrl="https://www.youtube.com/watch",this.youTubeVideoIdQueryKey="v"}return e.videoDomainIfSupported=function(e){if(e){var t=e.toLowerCase();if(i.UrlUtils.onWhitelistedDomain(t)){var n=i.UrlUtils.getHostname(t).toLowerCase();for(var o in r){var a=r[o];if("string"==typeof a&&n.indexOf(a.toLowerCase()+".")>-1)return a}}}},e.matchRegexFromPageContent=function(e,t){if(!o.ObjectUtils.isNullOrUndefined(e)){var n,r=[];if(t.forEach(function(t){for(;n=t.exec(e);)n[2]?r.push(n[2]):n[3]&&r.push(n[3])}),0!==r.length)return r}},e}();n.VideoUtils=a},{"../objectUtils":47,"../urlUtils":59}],12:[function(e,t,n){"use strict";var r;!function(e){e[e.PUBLIC=0]="PUBLIC",e[e.GLOBAL=1]="GLOBAL",e[e.EUDB=2]="EUDB",e[e.EMEA=3]="EMEA",e[e.UNKNOWN=4]="UNKNOWN"}(r=n.DataBoundary||(n.DataBoundary={}))},{}],13:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},i=e("../communicator/smartValue"),a=e("../logging/log"),s=e("../http/HttpWithRetries"),u=e("../storage/clipperStorageKeys"),l=e("../userInfo"),c=e("../constants"),p=e("../objectUtils"),f=e("../stringUtils"),g=e("../urlUtils"),d=e("./userDataBoundaryHelper"),h=e("./DataBoundary"),v=function(){function e(e,t){this.user=new i.SmartValue,this.logger=t,this.clipperData=e}return e.prototype.updateUserInfoData=function(e,t){var n=this;return new Promise(function(i){var s=0,c=n.clipperData.getValue(u.ClipperStorageKeys.userInformation);if(c){var f=void 0;try{f=JSON.parse(c)}catch(e){n.logger.logJsonParseUnexpected(c)}f&&f.data&&p.ObjectUtils.isNumeric(f.data.accessTokenExpiration)&&(s=Math.max(1e3*f.data.accessTokenExpiration-18e4,0))}var g=function(){return n.retrieveUserInformation(e,void 0)},v=new a.Event.PromiseEvent(a.Event.Label.GetExistingUserInformation);v.setCustomProperty(a.PropertyName.Custom.UserInformationStored,!!c),n.clipperData.getFreshValue(u.ClipperStorageKeys.userInformation,g,s).then(function(e){return r(n,void 0,void 0,function(){var n,r,i,s;return o(this,function(o){switch(o.label){case 0:return n=this.isValidUserInformation(e.data),v.setCustomProperty(a.PropertyName.Custom.FreshUserInfoAvailable,n),r=this.isThirdPartyCookiesEnabled(e.data),v.setCustomProperty(a.PropertyName.Custom.WriteableCookies,r),v.setCustomProperty(a.PropertyName.Custom.UserUpdateReason,l.UpdateReason[t]),n?(i=new d.UserDataBoundaryHelper,[4,i.getUserDataBoundary(e.data)]):[3,2];case 1:return s=o.sent(),s!==h.DataBoundary[h.DataBoundary.GLOBAL]&&s!==h.DataBoundary[h.DataBoundary.PUBLIC]||LogManager.reInitLoggerForDataBoundaryChange(s),v.setCustomProperty(a.PropertyName.Custom.DataBoundary,s),e.data.dataBoundary=s,this.user.set({user:e.data,lastUpdated:e.lastUpdated,updateReason:t,writeableCookies:r}),[3,3];case 2:this.user.set({updateReason:t,writeableCookies:r}),o.label=3;case 3:return[2]}})})},function(e){v.setStatus(a.Status.Failed),v.setFailureInfo(e),n.user.set({updateReason:t})}).then(function(){n.logger.logEvent(v),i(n.user.get())})})},e.prototype.retrieveUserInformation=function(e,t){var n=this;return void 0===t&&(t=void 0),new Promise(function(r,o){var i=g.UrlUtils.addUrlQueryValue(c.Constants.Urls.Authentication.userInformationUrl,c.Constants.Urls.QueryParams.clipperId,e),u=new a.Event.PromiseEvent(a.Event.Label.RetrieveUserInformation),l=f.StringUtils.generateGuid();u.setCustomProperty(a.PropertyName.Custom.CorrelationId,l);var d={};d["Content-type"]="application/x-www-form-urlencoded",d[c.Constants.HeaderValues.correlationId]=l;var h="";p.ObjectUtils.isNullOrUndefined(t)||(h=t.replace(/\+/g,"%2B")),s.HttpWithRetries.post(i,h,d).then(function(e){var t=e.response;r({parsedResponse:t,request:e})},function(e){u.setStatus(a.Status.Failed),u.setFailureInfo(e),o(e)}).then(function(){n.logger.logEvent(u)})})},e.prototype.isValidUserInformation=function(e){return!!(e&&e.accessToken&&e.accessTokenExpiration>0&&e.authType)},e.prototype.isThirdPartyCookiesEnabled=function(e){return void 0===e.cookieInRequest||e.cookieInRequest},e}();n.AuthenticationHelper=v},{"../communicator/smartValue":8,"../constants":9,"../http/HttpWithRetries":26,"../logging/log":32,"../objectUtils":47,"../storage/clipperStorageKeys":55,"../stringUtils":58,"../urlUtils":59,"../userInfo":60,"./DataBoundary":12,"./userDataBoundaryHelper":21}],14:[function(e,t,n){"use strict";var r=e("../../clientType"),o=e("../webExtensionBase/webExtension");o.WebExtension.browser="browser"in window?browser:chrome;new o.WebExtension(r.ClientType.EdgeExtension,{debugLoggingInjectUrl:"edgeDebugLoggingInject.js",webClipperInjectUrl:"edgeInject.js",pageNavInjectUrl:"edgePageNavInject.js"})},{"../../clientType":2,"../webExtensionBase/webExtension":22}],15:[function(e,t,n){"use strict";var r=e("../clientType"),o=e("../constants"),i=e("../stringUtils"),a=e("../urlUtils"),s=e("../clipperUI/tooltipType"),u=e("../communicator/smartValue"),l=e("../http/HttpWithRetries"),c=e("../localization/localization"),p=e("../localization/localizationHelper"),f=e("../logging/log"),g=e("../storage/clipperStorageKeys"),d=e("../versioning/changeLog"),h=e("../versioning/changeLogHelper"),v=e("../versioning/version"),m=e("./authenticationHelper"),y=e("./tooltipHelper"),b=e("./workerPassthroughLogger"),C=function(){function e(t,n){this.setUnhandledExceptionLogging(),this.workers=[],this.logger=new b.WorkerPassthroughLogger(this.workers),e.extensionId=i.StringUtils.generateGuid(),this.clipperData=n,this.clipperData.setLogger(this.logger),this.auth=new m.AuthenticationHelper(this.clipperData,this.logger),this.tooltip=new y.TooltipHelper(this.clipperData);var r=!1,o=this.clipperData.getValue(g.ClipperStorageKeys.clipperId);o||(r=!0,o=e.generateClipperId(),this.clipperData.setValue(g.ClipperStorageKeys.clipperId,o),this.updateLastSeenVersionInStorageToCurrent()),this.clientInfo=new u.SmartValue({clipperType:t,clipperVersion:e.getExtensionVersion(),clipperId:o}),r&&this.onFirstRun(),this.initializeUserFlighting(),this.listenForOpportunityToShowPageNavTooltip()}return e.getExtensionId=function(){return e.extensionId},e.getExtensionVersion=function(){return e.version},e.shouldCheckForMajorUpdates=function(e,t){return!!t&&(!e||e.isLesserThan(t))},e.prototype.addWorker=function(e){var t=this;e.setOnUnloading(function(){e.destroy(),t.removeWorker(e)}),this.workers.push(e)},e.prototype.getWorkers=function(){return this.workers},e.prototype.removeWorker=function(e){var t=this.workers.indexOf(e);t>-1&&this.workers.splice(t,1)},e.isOnOneNoteDomain=function(e){return e.indexOf("onenote.com")>=0||e.indexOf("onenote-int.com")>=0},e.prototype.fetchAndStoreLocStrings=function(){var e=this,t=navigator.language||navigator.userLanguage;return p.LocalizationHelper.makeLocStringsFetchRequest(t).then(function(n){try{var r=JSON.parse(n.parsedResponse);return r&&(e.clipperData.setValue(g.ClipperStorageKeys.locale,t),e.clipperData.setValue(g.ClipperStorageKeys.locStrings,n.parsedResponse),
logManager.js:2:!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LogManager=e()}}(function(){var e;return function(){function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return e}()({1:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ChromeExtension=1]="ChromeExtension",e[e.EdgeExtension=2]="EdgeExtension",e[e.FirefoxExtension=3]="FirefoxExtension",e[e.SafariExtension=4]="SafariExtension"}(r=n.ClientType||(n.ClientType={}))},{}],2:[function(e,t,n){"use strict";var r,o=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(r=n.TooltipType||(n.TooltipType={}));var i;!function(e){function t(e){switch(e){case r.Pdf:return o.InvokeSource.PdfTooltip;case r.Product:return o.InvokeSource.ProductTooltip;case r.Recipe:return o.InvokeSource.RecipeTooltip;case r.Video:return o.InvokeSource.VideoTooltip;case r.WhatsNew:return o.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(i=n.TooltipTypeUtils||(n.TooltipTypeUtils={}))},{"../extensions/invokeSource":6}],3:[function(e,t,n){"use strict";var r=function(){function e(e){this.subscriptions=[],this.t=e}return e.prototype.subscribe=function(e,t){void 0===t&&(t={}),void 0===t.times&&(t.times=1/0),void 0===t.callOnSubscribe&&(t.callOnSubscribe=!0),t.callOnSubscribe&&e(this.t),t.times>0&&this.subscriptions.push({func:e,times:t.times})},e.prototype.unsubscribe=function(e){for(var t=0;t<this.subscriptions.length;t++)if(e===this.subscriptions[t].func)return void this.subscriptions.splice(t,1)},e.prototype.set=function(e){return this.t!==e&&(this.t=e,this.notifySubscribers()),this},e.prototype.get=function(){return this.t},e.prototype.forceUpdate=function(){this.notifySubscribers()},e.prototype.equals=function(e){return this.t===e},e.prototype.toString=function(){return this.t?this.t.toString():"undefined"},e.prototype.notifySubscribers=function(){for(var e=this.subscriptions.length,t=0;t<e;t++){this.subscriptions[t].times--,this.subscriptions[t].func(this.t);var n=this.subscriptions[t]&&0===this.subscriptions[t].times;n&&this.subscriptions.splice(t,1),this.subscriptions[t]&&!n||(e--,t--)}},e.subscribe=function(e,t){for(var n=0;n<e.length;n++)e[n].subscribe(function(){for(var n=[],r=0;r<e.length;r++)n.push(e[r].get());t.apply(this,n)})},e}();n.SmartValue=r},{}],4:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var n;!function(e){e.clipperInfo="ClipperInfo"}(n=e.Cookies||(e.Cookies={}));var r;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(r=e.Extension||(e.Extension={}));var o;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(o=e.Ids||(e.Ids={}));var i;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(i=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var u;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(u=e.KeyCodes||(e.KeyCodes={}));var l;!function(e){e.c="KeyC"}(l=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var p;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(p=e.Styles||(e.Styles={}));var f;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/webclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var n;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfromclipper",e.domain="domain"}(n=e.QueryParams||(e.QueryParams={}))}(f=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var h;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(h=e.Settings||(e.Settings={}));var d;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(d=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var v;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(v=e.AriaSet||(e.AriaSet={}))}(r=n.Constants||(n.Constants={}))},{}],5:[function(e,t,n){"use strict";var r;!function(e){e[e.PUBLIC=0]="PUBLIC",e[e.GLOBAL=1]="GLOBAL",e[e.EUDB=2]="EUDB",e[e.EMEA=3]="EMEA",e[e.UNKNOWN=4]="UNKNOWN"}(r=n.DataBoundary||(n.DataBoundary={}))},{}],6:[function(e,t,n){"use strict";var r;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(r=n.InvokeSource||(n.InvokeSource={}))},{}],7:[function(e,t,n){"use strict";var r;!function(t){function n(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(u){var t=u[e];if(t)return t}var n=c[e];if(n)return n;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function r(e){u=e}function o(e){return"font-family: "+i(e)+";"}function i(e){if(l[e])return l[e];var t="WebClipper.FontFamily."+s[e].toString(),r=n(t);return l[e]=a(r),l[e]}function a(e){if(!e)return"";for(var t=e.split(","),n=0;n<t.length;n++)t[n]=t[n].trim(),t[n].length>0&&t[n].indexOf(" ")>=0&&"'"!==t[n][0]&&"'"!==t[n][t.length-1]&&(t[n]="'"+t[n]+"'");return t.join(",")}var s;!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(s=t.FontFamily||(t.FontFamily={}));var u,l={},c=e("../../strings.json");t.getLocalizedString=n,t.setLocalizedStrings=r,t.getFontFamilyAsStyle=o,t.getFontFamily=i,t.formatFontFamily=a}(r=n.Localization||(n.Localization={}))},{"../../strings.json":41}],8:[function(e,t,n){"use strict";var r=e("./log"),o=function(){function e(){}return e.prototype.logJsonParseUnexpected=function(e){this.logFailure(r.Failure.Label.JsonParse,r.Failure.Type.Unexpected,void 0,e)},e}();n.Logger=o},{"./log":16}],9:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../objectUtils"),i=e("../settings"),a=e("./log"),s=e("./loggerDecorator"),u=e("./logHelpers"),l=e("../extensions/DataBoundary"),c=microsoft.applications.telemetry.EventProperties,p=function(e){function t(t,n){var r=e.call(this,n)||this;r.currentTenant=t,microsoft.applications.telemetry.LogManager.getDefaultToken()||microsoft.applications.telemetry.LogManager.initialize(t),r.logger=new microsoft.applications.telemetry.Logger,r.semanticContext=r.logger.getSemanticContext();var o="Debug console logger is ON - now logging to both Aria ("+i.Settings.getSetting("Misc_Data_Endpoint_Id").toUpperCase()+") and console.";return e.prototype.logTrace.call(r,a.Trace.Label.DebugMode,a.Trace.Level.Information,o),r}return r(t,e),t.prototype.reInitAriaLogger=function(e){microsoft.applications.telemetry.LogManager.isInitialized()&&(microsoft.applications.telemetry.LogManager.flush(),microsoft.applications.telemetry.LogManager.__backToUninitialized());var t=new microsoft.applications.telemetry.LogConfiguration;e!==l.DataBoundary[l.DataBoundary.GLOBAL]&&e!==l.DataBoundary[l.DataBoundary.PUBLIC]||(t.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),microsoft.applications.telemetry.LogManager.initialize(this.currentTenant,t),this.logger=new microsoft.applications.telemetry.Logger,this.semanticContext=this.logger.getSemanticContext()},t.prototype.generateSessionId=function(){return this.logger.getSessionId()},t.prototype.outputClickEvent=function(e){var t=u.LogHelpers.createClickEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputEvent=function(e){var t=u.LogHelpers.createLogEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputSessionStart=function(){var e=u.LogHelpers.createSessionStartEventAsJson(),t=this.createEventProperties(e);this.logger.logSession(a.Session.State.Started,t)},t.prototype.outputSessionEnd=function(e){var t=u.LogHelpers.createSessionEndEventAsJson(e),n=this.createEventProperties(t);this.logger.logSession(a.Session.State.Ended,n)},t.prototype.outputFailure=function(e,t,n,r){var o=u.LogHelpers.createFailureEventAsJson(e,t,n,r),i=this.createEventProperties(o);this.logger.logEvent(i)},t.prototype.outputUserFunnel=function(e){var t=u.LogHelpers.createFunnelEventAsJson(e),n=this.createEventProperties(t);this.logger.logEvent(n)},t.prototype.outputTrace=function(e,t,n){var r=u.LogHelpers.createTraceEventAsJson(e,t,n),o=this.createEventProperties(r);this.logger.logEvent(o)},t.prototype.outputSetContext=function(e,t){switch(e){case a.Context.Custom.AppInfoId:this.semanticContext.setAppId(t);break;case a.Context.Custom.AppInfoVersion:this.semanticContext.setAppVersion(t);break;case a.Context.Custom.DeviceInfoId:microsoft.applications.telemetry.LogManager.getSemanticContext().setDeviceId(t);break;case a.Context.Custom.UserInfoId:this.semanticContext.setUserId(t,0);break;case a.Context.Custom.UserInfoLanguage:this.semanticContext.setUserLanguage(t);break;case a.Context.Custom.SessionId:break;default:this.logger.setContext(a.Context.toString(e),t)}},t.prototype.onNavigateAway=function(){microsoft.applications.telemetry.LogManager.flush()},t.prototype.createEventProperties=function(e){var t=new c;for(var n in e)if(e.hasOwnProperty(n)){if(n===a.PropertyName.Reserved.EventType){t.name=e[n].toString();continue}var r=o.ObjectUtils.isNullOrUndefined(e[n])?a.unknownValue:e[n].toString();t.setProperty(n,r)}return t},t.prototype.formatUserLanguage=function(e){return e?e.replace("_","-"):void 0},t}(s.LoggerDecorator);n.AriaLoggerDecorator=p},{"../extensions/DataBoundary":5,"../objectUtils":35,"../settings":37,"./log":16,"./logHelpers":17,"./loggerDecorator":20}],10:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./communicatorLoggerPure"),i=e("./loggerDecorator"),a=function(e){function t(t,n){var r=e.call(this,{component:n})||this;return r.pureLogger=new o.CommunicatorLoggerPure(t),r}return r(t,e),t.prototype.outputEvent=function(e){this.pureLogger.logEvent(e)},t.prototype.outputFailure=function(e,t,n,r){this.pureLogger.logFailure(e,t,n,r)},t.prototype.outputUserFunnel=function(e){this.pureLogger.logUserFunnel(e)},t.prototype.outputSessionStart=function(){this.pureLogger.logSessionStart()},t.prototype.outputSessionEnd=function(e){this.pureLogger.logSessionEnd(e)},t.prototype.outputTrace=function(e,t,n){this.pureLogger.logTrace(e,t,n)},t.prototype.outputClickEvent=function(e){this.pureLogger.logClickEvent(e)},t.prototype.outputSetContext=function(e,t){this.pureLogger.setContextProperty(e,t)},t}(i.LoggerDecorator);n.CommunicatorLoggerDecorator=a},{"./communicatorLoggerPure":11,"./loggerDecorator":20}],11:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../constants"),i=e("./log"),a=e("./logger"),s=function(e){function t(t){var n=e.call(this)||this;return n.communicator=t,n}return r(t,e),t.prototype.logEvent=function(e){e.timerWasStopped()||e.stopTimer(),this.sendDataPackage(i.LogMethods.LogEvent,[e.getEventCategory(),e.getEventData()])},t.prototype.logFailure=function(e,t,n,r){this.sendDataPackage(i.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){this.sendDataPackage(i.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){this.sendDataPackage(i.LogMethods.LogSessionStart,arguments)},t.prototype.logSessionEnd=function(e){this.sendDataPackage(i.LogMethods.LogSessionEnd,arguments)},t.prototype.logTrace=function(e,t,n){n?this.sendDataPackage(i.LogMethods.LogTrace,[e,t,n]):this.sendDataPackage(i.LogMethods.LogTrace,[e,t])},t.prototype.pushToStream=function(e,t){this.sendDataPackage(i.LogMethods.PushToStream,arguments)},t.prototype.logClickEvent=function(e){this.sendDataPackage(i.LogMethods.LogClickEvent,arguments)},t.prototype.setContextProperty=function(e,t){this.sendDataPackage(i.LogMethods.SetContextProperty,arguments)},t.prototype.sendDataPackage=function(e,t){var n={methodName:e,methodArgs:Object.keys(t).map(function(e){return t[e]})};this.communicator.callRemoteFunction(o.Constants.FunctionKeys.telemetry,{param:n})},t}(a.Logger);n.CommunicatorLoggerPure=s},{"../constants":4,"./log":16,"./logger":19}],12:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./consoleLoggerPure"),i=e("./loggerDecorator"),a=function(e){function t(t,n){var r=e.call(this,n)||this;return r.pureConsoleLogger=new o.ConsoleLoggerPure(t),r}return r(t,e),t.prototype.outputEvent=function(e){this.pureConsoleLogger.logEvent(e)},t.prototype.outputFailure=function(e,t,n,r){this.pureConsoleLogger.logFailure(e,t,n,r)},t.prototype.outputUserFunnel=function(e){this.pureConsoleLogger.logUserFunnel(e)},t.prototype.outputSessionStart=function(){this.pureConsoleLogger.logSessionStart()},t.prototype.outputSessionEnd=function(e){this.pureConsoleLogger.logSessionEnd(e)},t.prototype.outputTrace=function(e,t,n){this.pureConsoleLogger.logTrace(e,t,n)},t.prototype.outputClickEvent=function(e){this.pureConsoleLogger.logClickEvent(e)},t.prototype.outputSetContext=function(e,t){this.pureConsoleLogger.setContextProperty(e,t)},t}(i.LoggerDecorator);n.ConsoleLoggerDecorator=a},{"./consoleLoggerPure":13,"./loggerDecorator":20}],13:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("./log"),i=e("./consoleLoggerShell"),a=e("./Logger"),s=e("./logHelpers"),u=function(e){function t(t){var n=e.call(this)||this;return n.consoleShell=new i.ConsoleLoggerShell(t),n}return r(t,e),t.prototype.logEvent=function(e){var t=s.LogHelpers.createLogEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logFailure=function(e,t,n,r){var o=s.LogHelpers.createFailureEventAsJson(e,t,n,r);this.consoleShell.logToConsole(o)},t.prototype.logUserFunnel=function(e){var t=s.LogHelpers.createFunnelEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logSessionStart=function(){var e=s.LogHelpers.createSessionStartEventAsJson();this.consoleShell.logToConsole(e)},t.prototype.logSessionEnd=function(e){var t=s.LogHelpers.createSessionEndEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.logTrace=function(e,t,n){var r=s.LogHelpers.createTraceEventAsJson(e,t,n);this.consoleShell.logToConsole(r)},t.prototype.pushToStream=function(e,t){},t.prototype.logClickEvent=function(e){var t=s.LogHelpers.createClickEventAsJson(e);this.consoleShell.logToConsole(t)},t.prototype.setContextProperty=function(e,t){this.consoleShell.setContextProperty(o.Context.toString(e),t)},t}(a.Logger);n.ConsoleLoggerPure=u},{"./Logger":8,"./consoleLoggerShell":14,"./log":16,"./logHelpers":17}],14:[function(e,t,n){"use strict";var r=e("./log"),o=function(){function e(e){this.context={},this.consoleOutput=e}return e.prototype.logToConsole=function(e){if(!e)throw new Error("'event' argument to logToConsole was: "+e);var t=e[r.PropertyName.Reserved.Level];e[r.PropertyName.Reserved.Status]!==r.Status[r.Status.Failed]&&e[r.PropertyName.Reserved.Category]!==r.PropertyName.Reserved.WebClipper+"."+r.Failure.category||(t=r.Trace.Level[r.Trace.Level.Error]);var n=this.consoleOutput,o="";o+="["+e[r.PropertyName.Reserved.EventName]+"]",o+=t?" ["+t+"]":"",o+=r.PropertyName.Reserved.Message in e?" "+e[r.PropertyName.Reserved.Message]:"";var i=this.combineContextAndEvent(e);switch(r.Trace.Level[t]){case r.Trace.Level.Warning:n.warn(o,i);break;case r.Trace.Level.Error:n.error(o,i);break;case r.Trace.Level.Verbose:case r.Trace.Level.Information:n.info(o,i);break;default:n.log(o,i)}},e.prototype.setContextProperty=function(e,t){this.context[e]=t},e.prototype.combineContextAndEvent=function(e){var t={};for(var n in this.context)this.context.hasOwnProperty(n)&&(t[n]=this.context[n]);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},e}();n.ConsoleLoggerShell=o},{"./log":16}],15:[function(e,t,n){"use strict";var r=e("../objectUtils"),o=e("./log"),i=function(){function e(){}return e.prototype.requirementsAreMet=function(e){return!0},e}();n.NoRequirements=i;var a=function(){function e(e){this.prodProperties=[o.Context.toString(o.Context.Custom.AppInfoId),o.Context.toString(o.Context.Custom.AppInfoVersion),o.Context.toString(o.Context.Custom.BrowserLanguage),o.Context.toString(o.Context.Custom.ExtensionLifecycleId),o.Context.toString(o.Context.Custom.ClipperType),o.Context.toString(o.Context.Custom.DeviceInfoId),o.Context.toString(o.Context.Custom.FlightInfo),o.Context.toString(o.Context.Custom.InPrivateBrowsing)],this.requiredProperties=e?e:this.prodProperties}return e.prototype.requirementsAreMet=function(e){if(r.ObjectUtils.isNullOrUndefined(e))return!1;for(var t=0;t<this.requiredProperties.length;++t){var n=this.requiredProperties[t];if(!e.hasOwnProperty(n))return!1}return!0},e}();n.ProductionRequirements=a},{"../objectUtils":35,"./log":16}],16:[function(e,t,n){"use strict";function r(e,t){switch(e.methodName){case i.LogMethods.LogEvent:var n=e.methodArgs[0],r=e.methodArgs[1];t.logEvent.apply(t,[o.Event.createEvent(n,r)]);break;case i.LogMethods.LogFailure:t.logFailure.apply(t,e.methodArgs);break;case i.LogMethods.PushToStream:t.pushToStream.apply(t,e.methodArgs);break;case i.LogMethods.LogFunnel:t.logUserFunnel.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionStart:t.logSessionStart.apply(t,e.methodArgs);break;case i.LogMethods.LogSessionEnd:t.logSessionEnd.apply(t,e.methodArgs);break;case i.LogMethods.LogClickEvent:t.logClickEvent.apply(t,e.methodArgs);break;case i.LogMethods.SetContextProperty:t.setContextProperty.apply(t,e.methodArgs);break;case i.LogMethods.LogTrace:default:t.logTrace.apply(t,e.methodArgs)}}var o=e("./submodules/event"),i=e("./submodules/logMethods");n.contextPropertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$/,n.enableConsoleLogging="enable_console_logging",n.reportData="ReportData",n.unknownValue="unknown",n.parseAndLogDataPackage=r;var a=e("./submodules/click");n.Click=a.Click;var s=e("./submodules/context");n.Context=s.Context;var u=e("./submodules/errorUtils");n.ErrorUtils=u.ErrorUtils;var l=e("./submodules/event");n.Event=l.Event;var c=e("./submodules/failure");n.Failure=c.Failure;var p=e("./submodules/funnel");n.Funnel=p.Funnel;var f=e("./submodules/logMethods");n.LogMethods=f.LogMethods;var g=e("./submodules/noop");n.NoOp=g.NoOp;var h=e("./submodules/propertyName");n.PropertyName=h.PropertyName;var d=e("./submodules/session");n.Session=d.Session;var v=e("./submodules/status");n.Status=v.Status;var m=e("./submodules/trace");n.Trace=m.Trace},{"./submodules/click":22,"./submodules/context":23,"./submodules/errorUtils":24,"./submodules/event":25,"./submodules/failure":26,"./submodules/funnel":27,"./submodules/logMethods":28,"./submodules/noop":29,"./submodules/propertyName":30,"./submodules/session":31,"./submodules/status":32,"./submodules/trace":33}],17:[function(e,t,n){"use strict";var r,o=e("./log");!function(e){function t(e,t){var n={};n[o.PropertyName.Reserved.EventType]=o.reportData,n[o.PropertyName.Reserved.Label]=t;var r=o.PropertyName.Reserved.WebClipper+"."+e;return n[o.PropertyName.Reserved.Category]=r,n[o.PropertyName.Reserved.EventName]=r+"."+t,n}function n(t){if(!t)throw new Error("Button clicked without an ID! Logged with ID "+JSON.stringify(t));var n=e.createBaseEventAsJson(o.Click.category,t);return n}function r(t){t.timerWasStopped()||t.stopTimer();
logManager.js:3:var n=t.getEventCategory(),r=e.createBaseEventAsJson(o.Event.Category[n],t.getLabel());switch(r[o.PropertyName.Reserved.Duration]=t.getDuration(),g(r,t.getCustomProperties()),n){case o.Event.Category.BaseEvent:break;case o.Event.Category.PromiseEvent:i(r,t);break;case o.Event.Category.StreamEvent:a(r,t);break;default:throw new Error("createLogEvent does not specify a case for event category: "+o.Event.Category[n])}return r}function i(e,t){var n=t.getStatus();e[o.PropertyName.Reserved.Status]=n,n===o.Status[o.Status.Failed]&&(e[o.PropertyName.Reserved.FailureInfo]=t.getFailureInfo(),e[o.PropertyName.Reserved.FailureType]=t.getFailureType())}function a(e,t){e[o.PropertyName.Reserved.Stream]=JSON.stringify(t.getEventData().Stream)}function s(t,n){var r=new o.Event.BaseEvent(o.Event.Label.SetContextProperty),i=e.createBaseEventAsJson(o.Event.Category[r.getEventCategory()],r.getLabel()),a=o.Context.toString(t);return i[o.PropertyName.Custom[o.PropertyName.Custom.Key]]=a,i[o.PropertyName.Custom[o.PropertyName.Custom.Value]]=n,i}function u(t,n,r,i){var a=e.createBaseEventAsJson(o.Failure.category,o.Failure.Label[t]);return a[o.PropertyName.Reserved.FailureType]=o.Failure.Type[n],r&&(a[o.PropertyName.Reserved.FailureInfo]=o.ErrorUtils.toString(r)),i&&(a[o.PropertyName.Reserved.Id]=i),a[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace(),a}function l(t){var n=e.createBaseEventAsJson(o.Funnel.category,o.Funnel.Label[t]);return n}function c(){var t=e.createBaseEventAsJson(o.Session.category,o.Session.State[o.Session.State.Started]);return t}function p(t){var n=e.createBaseEventAsJson(o.Session.category,o.Session.State[o.Session.State.Ended]);return n[o.PropertyName.Reserved.Trigger]=o.Session.EndTrigger[t],n}function f(t,n,r){var i=e.createBaseEventAsJson(o.Trace.category,o.Trace.Label[t]);switch(r&&(i[o.PropertyName.Reserved.Message]=r),i[o.PropertyName.Reserved.Level]=o.Trace.Level[n],n){case o.Trace.Level.Warning:i[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace()}return i}function g(e,t){if(e[o.PropertyName.Reserved.Status]===o.Status[o.Status.Failed]&&(e[o.PropertyName.Reserved.StackTrace]=o.Failure.getStackTrace()),t)for(var n in t)if(t.hasOwnProperty(n)){var r=void 0;r="object"==typeof t[n]?JSON.stringify(t[n]):t[n],e[n]=r}}function h(){try{if(localStorage.getItem(o.enableConsoleLogging))return!0}catch(e){}return!1}e.createBaseEventAsJson=t,e.createClickEventAsJson=n,e.createLogEventAsJson=r,e.createSetContextEventAsJson=s,e.createFailureEventAsJson=u,e.createFunnelEventAsJson=l,e.createSessionStartEventAsJson=c,e.createSessionEndEventAsJson=p,e.createTraceEventAsJson=f,e.addToLogEvent=g,e.isConsoleOutputEnabled=h}(r=n.LogHelpers||(n.LogHelpers={}))},{"./log":16}],18:[function(e,t,n){"use strict";function r(e,t){var n=u.Settings.getSetting("Aria_Token"),r=new v.ProductionRequirements;return t?o(n,r,t,e):s=new g.AriaLoggerDecorator(n,{contextStrategy:r,sessionId:e})}function o(e,t,n,r){var o=n?new p.CommunicatorLoggerDecorator(n):void 0,i=d.LogHelpers.isConsoleOutputEnabled()?new m.WebConsole:void 0,a=new h.ConsoleLoggerDecorator(i,{component:o});return s=new g.AriaLoggerDecorator(e,{contextStrategy:t,component:a,sessionId:r})}function i(e){s.reInitAriaLogger(e)}function a(e,t){var n=new XMLHttpRequest,r=f.PropertyName.Reserved.WebClipper+"."+e.category,o=u.Settings.getSetting("Misc_Data_Endpoint_Id"),i="https://www.onenote.com/webclipper/data/"+o;i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.event,f.reportData,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.label,e.label,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.category,r,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.Urls.QueryParams.eventName,r+"."+e.label,t),i=c.UrlUtils.addUrlQueryValue(i,l.Constants.HeaderValues.appIdKey.replace(/-/g,""),u.Settings.getSetting("App_Id"),t);for(var a in e.properties)e.properties.hasOwnProperty(a)&&(i=c.UrlUtils.addUrlQueryValue(i,a,e.properties[a],t));n.open("GET",i),n.send()}var s,u=e("../settings"),l=e("../constants"),c=e("../urlUtils"),p=e("../logging/communicatorLoggerDecorator"),f=e("../logging/log"),g=e("../logging/ariaLoggerDecorator_internal"),h=e("../logging/consoleLoggerDecorator"),d=e("../logging/logHelpers"),v=e("../logging/context"),m=e("../logging/webConsole");n.createExtLogger=r,n.reInitLoggerForDataBoundaryChange=i,n.sendMiscLogRequest=a},{"../constants":4,"../logging/ariaLoggerDecorator_internal":9,"../logging/communicatorLoggerDecorator":10,"../logging/consoleLoggerDecorator":12,"../logging/context":15,"../logging/log":16,"../logging/logHelpers":17,"../logging/webConsole":34,"../settings":37,"../urlUtils":39}],19:[function(e,t,n){arguments[4][8][0].apply(n,arguments)},{"./log":16,dup:8}],20:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../stringUtils"),i=e("./log"),a=e("./sessionLogger"),s=function(e){function t(t){var n=this,r=t&&t.contextStrategy?t.contextStrategy:void 0,o=t&&t.sessionId?t.sessionId:void 0;return n=e.call(this,{contextStrategy:r,sessionId:o})||this,n.component=t?t.component:void 0,n}return r(t,e),t.prototype.generateSessionId=function(){},t.prototype.handleSetUserSessionId=function(e){var t,n=this.sessionId.get(),r=this.generateSessionId();return n?t=n:e?t=e:r&&(t=r),this.component&&t?this.component.handleSetUserSessionId(t):this.component&&!t?t=this.component.handleSetUserSessionId():this.component||t||(t=this.currentSessionState===i.Session.State.Started?"cccccccc-"+o.StringUtils.generateGuid().substring(9):void 0),this.sessionId.set(t),this.setContextPropertyPure(i.Context.Custom.SessionId,t),this.outputSetContext(i.Context.Custom.SessionId,t),t},t.prototype.handleClickEvent=function(e){this.outputClickEvent(e),this.component&&this.component.executeClickEvent(e)},t.prototype.handleEvent=function(e){this.handleEventPure(e),this.component&&this.component.logEvent(e)},t.prototype.handleEventPure=function(e){this.outputEvent(e)},t.prototype.handleSessionStart=function(){this.outputSessionStart(),this.component&&this.component.executeSessionStart()},t.prototype.handleSessionEnd=function(e){this.outputSessionEnd(e),this.component&&this.component.executeSessionEnd(e)},t.prototype.handleFailure=function(e,t,n,r){this.outputFailure(e,t,n,r),this.component&&this.component.logFailure(e,t,n,r)},t.prototype.handleUserFunnel=function(e){this.outputUserFunnel(e),this.component&&this.component.logUserFunnel(e)},t.prototype.handleTrace=function(e,t,n){this.outputTrace(e,t,n),this.component&&this.component.logTrace(e,t,n)},t.prototype.handleSetContext=function(e,t){this.outputSetContext(e,t),this.component&&this.component.setContextProperty(e,t)},t}(a.SessionLogger);n.LoggerDecorator=s},{"../stringUtils":38,"./log":16,"./sessionLogger":21}],21:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("../communicator/smartValue"),i=e("../constants"),a=e("../objectUtils"),s=e("./log"),u=e("./logger"),l=function(e){function t(t){var n=e.call(this)||this;return n.contextProperties={},n.currentSessionState=s.Session.State.Ended,n.logQueue=[],n.streams={},n.userHasInteracted=!1,n.sessionId=void 0,n.sessionId=t&&t.sessionId?t.sessionId:new o.SmartValue,n.contextStrategy=t?t.contextStrategy:void 0,n}return r(t,e),t.prototype.hasUserInteracted=function(){return this.userHasInteracted},t.prototype.getUserSessionId=function(e){return this.sessionId.get()},t.prototype.sendFunnelInteractionEvent=function(e){var t=[i.Constants.Ids.signInButtonMsa,i.Constants.Ids.signInButtonOrgId,i.Constants.Ids.signOutButton,i.Constants.Ids.closeButton,i.Constants.Ids.clipButton,i.Constants.Ids.launchOneNoteButton,i.Constants.Ids.checkOutWhatsNewButton,i.Constants.Ids.proceedToWebClipperButton];this.hasUserInteracted()||t.indexOf(e)!==-1||(this.userHasInteracted=!0,this.logUserFunnel(s.Funnel.Label.Interact))},t.prototype.logEvent=function(e){return a.ObjectUtils.isNullOrUndefined(e)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleEvent(e):void this.pushDataPackage(s.LogMethods.LogEvent,arguments)},t.prototype.logFailure=function(e,t,n,r){return a.ObjectUtils.isNullOrUndefined(e)||a.ObjectUtils.isNullOrUndefined(t)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleFailure(e,t,n,r):void this.pushDataPackage(s.LogMethods.LogFailure,arguments)},t.prototype.logUserFunnel=function(e){return a.ObjectUtils.isNullOrUndefined(e)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleUserFunnel(e):void this.pushDataPackage(s.LogMethods.LogFunnel,arguments)},t.prototype.logSessionStart=function(){return this.areContextRequirementsMet()?(this.executeSessionStart(),void this.handleSetUserSessionId()):void this.pushDataPackage(s.LogMethods.LogSessionStart,arguments)},t.prototype.executeSessionStart=function(){if(this.currentSessionState===s.Session.State.Started){var e="Session already STARTED";return void this.logFailure(s.Failure.Label.SessionAlreadySet,s.Failure.Type.Unexpected,{error:e})}this.streams={},this.currentSessionState=s.Session.State.Started,this.handleSessionStart()},t.prototype.logSessionEnd=function(e){return this.areContextRequirementsMet()?(this.executeSessionEnd(e),void this.handleSetUserSessionId()):void this.pushDataPackage(s.LogMethods.LogSessionEnd,arguments)},t.prototype.executeSessionEnd=function(e){if(this.currentSessionState===s.Session.State.Ended){var t="Session already ENDED";return a.ObjectUtils.isNullOrUndefined(e)||(t+=". EndTrigger: "+s.Session.EndTrigger[e]),void this.logFailure(s.Failure.Label.SessionAlreadySet,s.Failure.Type.Unexpected,{error:t})}this.logAllStreams(),this.sessionId.set(void 0),this.userHasInteracted=!1,this.currentSessionState=s.Session.State.Ended,this.handleSessionEnd(e)},t.prototype.logTrace=function(e,t,n){return a.ObjectUtils.isNullOrUndefined(e)||a.ObjectUtils.isNullOrUndefined(t)?void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected):this.areContextRequirementsMet()?void this.handleTrace(e,t,n):void this.pushDataPackage(s.LogMethods.LogTrace,arguments)},t.prototype.pushToStream=function(e,t){if(a.ObjectUtils.isNullOrUndefined(e))return void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected);var n=s.Event.Label[e];t&&(this.streams[n]||(this.streams[n]=[]),this.streams[n].push(t))},t.prototype.logClickEvent=function(e){return this.areContextRequirementsMet()?(this.sendFunnelInteractionEvent(e),void this.executeClickEvent(e)):void this.pushDataPackage(s.LogMethods.LogClickEvent,arguments)},t.prototype.executeClickEvent=function(e){return e?(this.pushToStream(s.Event.Label.Click,e),void this.handleClickEvent(e)):void this.logFailure(s.Failure.Label.InvalidArgument,s.Failure.Type.Unexpected,{error:"Button clicked without an ID! Logged with ID "+JSON.stringify(e)})},t.prototype.setContextProperty=function(e,t){this.setContextPropertyPure(e,t),this.handleSetContext(e,t),this.areContextRequirementsMet()&&this.flushEventQueue()},t.prototype.setContextPropertyPure=function(e,t){var n=s.Context.toString(e);this.contextProperties[n]=t},t.prototype.areContextRequirementsMet=function(){return!this.contextStrategy||this.contextStrategy.requirementsAreMet(this.contextProperties)},t.prototype.flushEventQueue=function(){var e=this;this.isQueueFlushing||this.isQueueFlushed||(this.isQueueFlushing=!0,this.logQueue.forEach(function(t){switch(t.methodName){case s.LogMethods.LogEvent:e.logEvent.apply(e,t.methodArgs);break;case s.LogMethods.LogFailure:e.logFailure.apply(e,t.methodArgs);break;case s.LogMethods.PushToStream:e.pushToStream.apply(e,t.methodArgs);break;case s.LogMethods.LogFunnel:e.logUserFunnel.apply(e,t.methodArgs);break;case s.LogMethods.LogSessionStart:e.logSessionStart.apply(e,t.methodArgs);break;case s.LogMethods.LogSessionEnd:e.logSessionEnd.apply(e,t.methodArgs);break;case s.LogMethods.LogClickEvent:e.logClickEvent.apply(e,t.methodArgs);break;case s.LogMethods.SetContextProperty:e.setContextProperty.apply(e,t.methodArgs);break;case s.LogMethods.LogTrace:default:e.logTrace.apply(e,t.methodArgs)}}),this.isQueueFlushing=!1,this.isQueueFlushed=!0)},t.prototype.logAllStreams=function(){for(var e in this.streams)if(this.streams.hasOwnProperty(e)){for(var t=new s.Event.StreamEvent(s.Event.Label[e]),n=this.streams[e],r=0;r<n.length;r++)t.append(n[r]);this.handleEventPure(t)}},t.prototype.pushDataPackage=function(e,t){this.logQueue.push({methodName:e,methodArgs:t})},t}(u.Logger);n.SessionLogger=l},{"../communicator/smartValue":3,"../constants":4,"../objectUtils":35,"./log":16,"./logger":19}],22:[function(e,t,n){"use strict";var r;!function(e){e.category="Click";var t;!function(e){e.regionSelectionRemoveButton="RegionSelectionRemoveButton",e.sectionComponent="SectionComponent",e.sectionPickerLocationContainer="SectionPickerLocationContainer"}(t=e.Label||(e.Label={}))}(r=n.Click||(n.Click={}))},{}],23:[function(e,t,n){"use strict";var r;!function(e){function t(e){return r[n[e]]}var n,r={AppInfoId:"AppInfo.Id",AppInfoVersion:"AppInfo.Version",DeviceInfoId:"DeviceInfo.Id",ExtensionLifecycleId:"ExtensionLifecycle.Id",SessionId:"Session.Id",UserInfoId:"UserInfo.Id",UserInfoLanguage:"UserInfo.Language",AuthType:"AuthType",BrowserLanguage:"BrowserLanguage",ClipperType:"ClipperType",ContentType:"ContentType",FlightInfo:"FlightInfo",InPrivateBrowsing:"InPrivateBrowsing",PageLanguage:"PageLanguage"};!function(e){e[e.AppInfoId=0]="AppInfoId",e[e.AppInfoVersion=1]="AppInfoVersion",e[e.ExtensionLifecycleId=2]="ExtensionLifecycleId",e[e.DeviceInfoId=3]="DeviceInfoId",e[e.SessionId=4]="SessionId",e[e.UserInfoId=5]="UserInfoId",e[e.UserInfoLanguage=6]="UserInfoLanguage",e[e.AuthType=7]="AuthType",e[e.BrowserLanguage=8]="BrowserLanguage",e[e.ClipperType=9]="ClipperType",e[e.ContentType=10]="ContentType",e[e.FlightInfo=11]="FlightInfo",e[e.InPrivateBrowsing=12]="InPrivateBrowsing",e[e.PageLanguage=13]="PageLanguage"}(n=e.Custom||(e.Custom={})),e.toString=t}(r=n.Context||(n.Context={}))},{}],24:[function(e,t,n){"use strict";var r,o=e("../../clientType"),i=e("../../constants"),a=e("../../objectUtils"),s=e("../../localization/localization"),u=e("../log");!function(e){function t(e){if(e){var t={};t[g[g.Error].toLowerCase()]=e.error;var n=e;return n&&void 0!==n.statusCode&&(t[g[g.StatusCode].toLowerCase()]=n.statusCode,t[g[g.Response].toLowerCase()]=n.response,t[g[g.ResponseHeaders].toLowerCase()]=n.responseHeaders,void 0!==n.timeout&&(t[g[g.Timeout].toLowerCase()]=n.timeout)),JSON.stringify(t)}}function n(e){if(e){var t=e;return t&&void 0!==t.statusCode?void 0!==t.timeout?{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders,timeout:t.timeout}:{error:t.error,statusCode:t.statusCode,response:t.response,responseHeaders:t.responseHeaders}:{error:e.error}}}function r(t){var n={};n[i.Constants.Urls.QueryParams.failureType]=u.Failure.Type[t.properties.failureType],n[i.Constants.Urls.QueryParams.failureInfo]=e.toString(t.properties.failureInfo),n[i.Constants.Urls.QueryParams.stackTrace]=t.properties.stackTrace,a.ObjectUtils.isNullOrUndefined(t.properties.failureId)||(n[i.Constants.Urls.QueryParams.failureId]=t.properties.failureId);var r=t.clientInfo;f(n,r),LogManager.sendMiscLogRequest({label:u.Failure.Label[t.label],category:u.Failure.category,properties:n},!0)}function l(t,n,r,o){var i;throw i=o?JSON.stringify({message:o,error:n.toString()}):n.toString(),e.sendFailureLogRequest({label:u.Failure.Label.UnhandledExceptionThrown,properties:{failureType:u.Failure.Type.Unexpected,failureInfo:{error:i},failureId:"Channel "+t,stackTrace:u.Failure.getStackTrace(n)},clientInfo:r}),n}function c(e,t){void 0===t&&(t=!1);var n={};n[i.Constants.Urls.QueryParams.channel]=e.channel,n[i.Constants.Urls.QueryParams.timeoutInMs]=i.Constants.Settings.noOpTrackerTimeoutDuration.toString();var r=e.clientInfo;f(n,r),LogManager.sendMiscLogRequest({label:u.NoOp.Label[e.label],category:u.NoOp.category,properties:n},!0),t&&window&&window.alert(s.Localization.getLocalizedString("WebClipper.Error.NoOpError"))}function p(e,t){return void 0===t&&(t=!1),setTimeout(function(){c(e,t)},i.Constants.Settings.noOpTrackerTimeoutDuration)}function f(e,t){t&&(e[i.Constants.Urls.QueryParams.clientType]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:o.ClientType[t.get().clipperType],e[i.Constants.Urls.QueryParams.clipperVersion]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:t.get().clipperVersion,e[i.Constants.Urls.QueryParams.clipperId]=a.ObjectUtils.isNullOrUndefined(t.get())?u.unknownValue:t.get().clipperId)}var g;!function(e){e[e.Error=0]="Error",e[e.StatusCode=1]="StatusCode",e[e.Response=2]="Response",e[e.ResponseHeaders=3]="ResponseHeaders",e[e.Timeout=4]="Timeout"}(g||(g={})),e.toString=t,e.clone=n,e.sendFailureLogRequest=r,e.handleCommunicatorError=l,e.sendNoOpTrackerRequest=c,e.setNoOpTrackerRequestTimeout=p}(r=n.ErrorUtils||(n.ErrorUtils={}))},{"../../clientType":1,"../../constants":4,"../../localization/localization":7,"../../objectUtils":35,"../log":16}],25:[function(e,t,n){"use strict";var r,o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("../log"),a=e("../../objectUtils");!function(e){function t(t,n){switch(t){default:case e.Category.BaseEvent:return new e.BaseEvent(n);case e.Category.PromiseEvent:return new e.PromiseEvent(n);case e.Category.StreamEvent:return new e.StreamEvent(n)}}var n;!function(e){e[e.BaseEvent=0]="BaseEvent",e[e.PromiseEvent=1]="PromiseEvent",e[e.StreamEvent=2]="StreamEvent"}(n=e.Category||(e.Category={}));var r;!function(e){e[e.AddEmbeddedVideo=0]="AddEmbeddedVideo",e[e.AugmentationApiCall=1]="AugmentationApiCall",e[e.BookmarkPage=2]="BookmarkPage",e[e.CompressRegionSelection=3]="CompressRegionSelection",e[e.ClearNoOpTracker=4]="ClearNoOpTracker",e[e.Click=5]="Click",e[e.ClipAugmentationOptions=6]="ClipAugmentationOptions",e[e.ClipCommonOptions=7]="ClipCommonOptions",e[e.ClipPdfOptions=8]="ClipPdfOptions",e[e.ClipRegionOptions=9]="ClipRegionOptions",e[e.ClipSelectionOptions=10]="ClipSelectionOptions",e[e.ClipToOneNoteAction=11]="ClipToOneNoteAction",e[e.CloseClipper=12]="CloseClipper",e[e.ClosePageNavTooltip=13]="ClosePageNavTooltip",e[e.CreateNotebook=14]="CreateNotebook",e[e.CreatePage=15]="CreatePage",e[e.CreateSection=16]="CreateSection",e[e.DebugFeedback=17]="DebugFeedback",e[e.DeviceIdMap=18]="DeviceIdMap",e[e.FetchNonLocalData=19]="FetchNonLocalData",e[e.FullPageScreenshotCall=20]="FullPageScreenshotCall",e[e.GetBinaryRequest=21]="GetBinaryRequest",e[e.GetCleanDom=22]="GetCleanDom",e[e.GetExistingUserInformation=23]="GetExistingUserInformation",e[e.GetFlightingAssignments=24]="GetFlightingAssignments",e[e.GetLocale=25]="GetLocale",e[e.GetLocalizedStrings=26]="GetLocalizedStrings",e[e.GetNotebookByName=27]="GetNotebookByName",e[e.GetNotebooks=28]="GetNotebooks",e[e.GetPage=29]="GetPage",e[e.GetPageContent=30]="GetPageContent",e[e.GetPages=31]="GetPages",e[e.HandleSignInEvent=32]="HandleSignInEvent",e[e.HideClipperDueToSpaNavigate=33]="HideClipperDueToSpaNavigate",e[e.InvokeClipper=34]="InvokeClipper",e[e.InvokeTooltip=35]="InvokeTooltip",e[e.InvokeWhatsNew=36]="InvokeWhatsNew",e[e.LocalFilesNotAllowedPanelShown=37]="LocalFilesNotAllowedPanelShown",e[e.PagesSearch=38]="PagesSearch",e[e.PdfByteMetadata=39]="PdfByteMetadata",e[e.PdfDataUrlMetadata=40]="PdfDataUrlMetadata",e[e.ProcessPdfIntoDataUrls=41]="ProcessPdfIntoDataUrls",e[e.RegionSelectionCapturing=42]="RegionSelectionCapturing",e[e.RegionSelectionLoading=43]="RegionSelectionLoading",e[e.RegionSelectionProcessing=44]="RegionSelectionProcessing",e[e.RetrieveUserInformation=45]="RetrieveUserInformation",e[e.SendBatchRequest=46]="SendBatchRequest",e[e.SetContextProperty=47]="SetContextProperty",e[e.SetDoNotPromptRatings=48]="SetDoNotPromptRatings",e[e.ShouldShowRatingsPrompt=49]="ShouldShowRatingsPrompt",e[e.TooltipImpression=50]="TooltipImpression",e[e.UpdatePage=51]="UpdatePage",e[e.UserInfoUpdated=52]="UserInfoUpdated",e[e.WhatsNewImpression=53]="WhatsNewImpression"}(r=e.Label||(e.Label={}));var s=function(){function t(e){if(this._timerWasStopped=!1,this.isEventData(e)){var t=e;this._label=t.Label,this._duration=t.Duration,this._properties=t.Properties?JSON.parse(JSON.stringify(t.Properties)):void 0}else{var n=e;this._label=n,this.startTimer()}}return t.prototype.getDuration=function(){return this._duration},t.prototype.getEventCategory=function(){return e.Category.BaseEvent},t.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties()}},t.prototype.getLabel=function(){return e.Label[this._label]},t.prototype.getCustomProperties=function(){return this._properties?JSON.parse(JSON.stringify(this._properties)):void 0},t.prototype.setCustomProperty=function(e,t){if(this.isReservedPropertyName(e))throw new Error("Tried to overwrite key '"+i.PropertyName.Custom[e]+"' with value of "+JSON.stringify(t));this._properties||(this._properties={}),this._properties[i.PropertyName.Custom[e]]=t},t.prototype.startTimer=function(){this._startTime=(new Date).getTime()},t.prototype.stopTimer=function(){return!!this._startTime&&(this._duration=(new Date).getTime()-this._startTime,this._timerWasStopped=!0,!0)},t.prototype.timerWasStopped=function(){return this._timerWasStopped},t.prototype.isEventData=function(e){var t=e;return!(!t||a.ObjectUtils.isNullOrUndefined(t.Label))},t.prototype.isReservedPropertyName=function(e){for(var t in i.PropertyName.Reserved)if(i.PropertyName.Custom[e].toLowerCase()===t.toLowerCase())return!0;return!1},t}();e.BaseEvent=s;var u=function(t){function n(e){var n=t.call(this,e)||this;if(n._logStatus=i.Status.Succeeded,n._failureType=i.Failure.Type.Unexpected,n.isEventData(e)){var r=e;n._logStatus=r.LogStatus,n._failureType=r.FailureType,n._failureInfo=i.ErrorUtils.clone(r.FailureInfo)}return n}return o(n,t),n.prototype.getEventCategory=function(){return e.Category.PromiseEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),LogStatus:this._logStatus,FailureType:this._failureType,FailureInfo:i.ErrorUtils.clone(this._failureInfo)}},n.prototype.getStatus=function(){return i.Status[this._logStatus]},n.prototype.setStatus=function(e){this._logStatus=e,this._timerWasStopped||this.stopTimer()},n.prototype.getFailureInfo=function(){return i.ErrorUtils.toString(this._failureInfo)},n.prototype.setFailureInfo=function(e){this._failureInfo=i.ErrorUtils.clone(e)},n.prototype.getFailureType=function(){return i.Failure.Type[this._failureType]},n.prototype.setFailureType=function(e){this._failureType=e},n}(s);e.PromiseEvent=u;var l=function(t){function n(e){var n=t.call(this,e)||this;if(n._stream=[],n.isEventData(e)){var r=e;n._stream=r.Stream}return n}return o(n,t),n.prototype.getEventCategory=function(){return e.Category.StreamEvent},n.prototype.getEventData=function(){return{Label:this._label,Duration:this._duration,Properties:this.getCustomProperties(),Stream:this._stream}},n.prototype.append=function(e){this._stream.push(e)},n}(s);e.StreamEvent=l,e.createEvent=t}(r=n.Event||(n.Event={}))},{"../../objectUtils":35,"../log":16}],26:[function(e,t,n){"use strict";var r;!function(e){function t(e){return e||(e=new Error),e.stack}e.category="Failure";var n;!function(e){e[e.Unexpected=0]="Unexpected",e[e.Expected=1]="Expected"}(n=e.Type||(e.Type={})),e.getStackTrace=t;var r;!function(e){e[e.ClickedButtonWithNoId=0]="ClickedButtonWithNoId",e[e.EndSessionWithoutTrigger=1]="EndSessionWithoutTrigger",e[e.GetChangeLog=2]="GetChangeLog",e[e.GetComputedStyle=3]="GetComputedStyle",e[e.GetLocalizedString=4]="GetLocalizedString",e[e.GetSetting=5]="GetSetting",e[e.IFrameMessageHandlerHasNoOtherWindow=6]="IFrameMessageHandlerHasNoOtherWindow",e[e.InvalidArgument=7]="InvalidArgument",e[e.IsFeatureEnabled=8]="IsFeatureEnabled",e[e.JsonParse=9]="JsonParse",e[e.NotImplemented=10]="NotImplemented",e[e.OnLaunchOneNoteButton=11]="OnLaunchOneNoteButton",e[e.OrphanedWebClippersDueToExtensionRefresh=12]="OrphanedWebClippersDueToExtensionRefresh",e[e.RegionSelectionProcessing=13]="RegionSelectionProcessing",e[e.RenderFailurePanel=14]="RenderFailurePanel",e[e.ReservedPropertyOverwriteAttempted=15]="ReservedPropertyOverwriteAttempted",e[e.SessionAlreadySet=16]="SessionAlreadySet",e[e.SetLoggerNoop=17]="SetLoggerNoop",e[e.SetUndefinedLocalizedStrings=18]="SetUndefinedLocalizedStrings",e[e.TraceLevelErrorWarningMessage=19]="TraceLevelErrorWarningMessage",e[e.UnhandledApiCode=20]="UnhandledApiCode",e[e.UnhandledExceptionThrown=21]="UnhandledExceptionThrown",e[e.UserSetWithInvalidExpiredData=22]="UserSetWithInvalidExpiredData",e[e.WebExtensionWindowCreate=23]="WebExtensionWindowCreate",e[e.UnclippablePage=24]="UnclippablePage",e[e.UnsupportedBrowser=25]="UnsupportedBrowser"}(r=e.Label||(e.Label={}))}(r=n.Failure||(n.Failure={}))},{}],27:[function(e,t,n){"use strict";var r;!function(e){e.category="Funnel";var t;!function(e){e[e.Invoke=0]="Invoke",e[e.AuthAlreadySignedIn=1]="AuthAlreadySignedIn",e[e.AuthAttempted=2]="AuthAttempted",e[e.AuthSignInCompleted=3]="AuthSignInCompleted",e[e.AuthSignInFailed=4]="AuthSignInFailed",e[e.ClipAttempted=5]="ClipAttempted",e[e.Interact=6]="Interact",e[e.ViewInWac=7]="ViewInWac",e[e.SignOut=8]="SignOut"}(t=e.Label||(e.Label={}))}(r=n.Funnel||(n.Funnel={}))},{}],28:[function(e,t,n){"use strict";var r;!function(e){e[e.LogEvent=0]="LogEvent",e[e.LogFailure=1]="LogFailure",e[e.PushToStream=2]="PushToStream",e[e.LogFunnel=3]="LogFunnel",e[e.LogSession=4]="LogSession",e[e.LogSessionStart=5]="LogSessionStart",e[e.LogSessionEnd=6]="LogSessionEnd",e[e.LogTrace=7]="LogTrace",e[e.LogClickEvent=8]="LogClickEvent",e[e.SetContextProperty=9]="SetContextProperty"}(r=n.LogMethods||(n.LogMethods={}))},{}],29:[function(e,t,n){"use strict";var r;!function(e){e.category="NoOp";var t;!function(e){e[e.InitializeCommunicator=0]="InitializeCommunicator",e[e.WebClipperUiFrameDidNotExist=1]="WebClipperUiFrameDidNotExist",e[e.WebClipperUiFrameIsNotVisible=2]="WebClipperUiFrameIsNotVisible"}(t=e.Label||(e.Label={}))}(r=n.NoOp||(n.NoOp={}))},{}],30:[function(e,t,n){"use strict";var r;!function(e){var t;!function(e){e[e.AnnotationAdded=0]="AnnotationAdded",e[e.AugmentationModel=1]="AugmentationModel",e[e.AverageProcessingDurationPerPage=2]="AverageProcessingDurationPerPage",e[e.ByteLength=3]="ByteLength",e[e.BytesPerPdfPage=4]="BytesPerPdfPage",e[e.BytesTrimmed=5]="BytesTrimmed",e[e.Channel=6]="Channel",e[e.ClipMode=7]="ClipMode",e[e.CloseReason=8]="CloseReason",e[e.ContainsAtLeastOneHighlight=9]="ContainsAtLeastOneHighlight",e[e.ContentType=10]="ContentType",e[e.CorrelationId=11]="CorrelationId",e[e.CurrentPanel=12]="CurrentPanel",e[e.CurrentSectionStillExists=13]="CurrentSectionStillExists",e[e.DeviceIdInStorage=14]="DeviceIdInStorage",e[e.DeviceIdInCookie=15]="DeviceIdInCookie",e[e.DomSizeInBytes=16]="DomSizeInBytes",e[e.FeatureEnabled=17]="FeatureEnabled",e[e.FinalDataUrlLength=18]="FinalDataUrlLength",e[e.FontSize=19]="FontSize",e[e.ForceRetrieveFreshLocStrings=20]="ForceRetrieveFreshLocStrings",e[e.FreshUserInfoAvailable=21]="FreshUserInfoAvailable",e[e.FullPageScreenshotContentFound=22]="FullPageScreenshotContentFound",e[e.Height=23]="Height",e[e.InitialDataUrlLength=24]="InitialDataUrlLength",e[e.InvokeMode=25]="InvokeMode",e[e.InvokeSource=26]="InvokeSource",e[e.IsHighDpiScreen=27]="IsHighDpiScreen",e[e.IsRetryable=28]="IsRetryable",e[e.IsSerif=29]="IsSerif",e[e.Key=30]="Key",e[e.LastSeenTooltipTime=31]="LastSeenTooltipTime",e[e.LastUpdated=32]="LastUpdated",e[e.MaxDepth=33]="MaxDepth",e[e.NumPages=34]="NumPages",e[e.NumRegions=35]="NumRegions",e[e.NumTimesTooltipHasBeenSeen=36]="NumTimesTooltipHasBeenSeen",e[e.PageNavTooltipType=37]="PageNavTooltipType",e[e.PageTitleModified=38]="PageTitleModified",e[e.PdfAllPagesClipped=39]="PdfAllPagesClipped",e[e.PdfAttachmentClipped=40]="PdfAttachmentClipped",e[e.PdfFileSelectedPageCount=41]="PdfFileSelectedPageCount",e[e.PdfFileTotalPageCount=42]="PdfFileTotalPageCount",e[e.PdfIsBatched=43]="PdfIsBatched",e[e.PdfIsLocalFile=44]="PdfIsLocalFile",e[e.RatingsInfo=45]="RatingsInfo",e[e.ShouldShowRatingsPrompt=46]="ShouldShowRatingsPrompt",e[e.SignInCancelled=47]="SignInCancelled",e[e.StoredLocaleDifferentThanRequested=48]="StoredLocaleDifferentThanRequested",e[e.TimeToClearNoOpTracker=49]="TimeToClearNoOpTracker",e[e.TooltipType=50]="TooltipType",e[e.UpdateInterval=51]="UpdateInterval",e[e.UserInformationReturned=52]="UserInformationReturned",e[e.UserInformationStored=53]="UserInformationStored",e[e.UserUpdateReason=54]="UserUpdateReason",e[e.Value=55]="Value",e[e.Width=56]="Width",e[e.WriteableCookies=57]="WriteableCookies",e[e.DataBoundary=58]="DataBoundary"}(t=e.Custom||(e.Custom={}));var n;!function(e){e.Category="Category",e.Duration="Duration",e.EventName="EventName",e.EventType="EventType",e.FailureInfo="FailureInfo",e.FailureType="FailureType",e.Id="Id",e.Label="Label",e.Level="Level",e.Message="Message",e.Properties="Properties",e.StackTrace="StackTrace",e.Status="Status",e.Stream="Stream",e.Trigger="Trigger",e.WebClipper="WebClipper"}(n=e.Reserved||(e.Reserved={}))}(r=n.PropertyName||(n.PropertyName={}))},{}],31:[function(e,t,n){"use strict";var r;!function(e){e.category="Session";var t;!function(e){e[e.SignOut=0]="SignOut",e[e.Unload=1]="Unload"}(t=e.EndTrigger||(e.EndTrigger={}));var n;!function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(n=e.State||(e.State={}))}(r=n.Session||(n.Session={}))},{}],32:[function(e,t,n){"use strict";var r;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(r=n.Status||(n.Status={}))},{}],33:[function(e,t,n){"use strict";var r;!function(e){e.category="Trace";var t;!function(e){e[e.DefaultingToConsoleLogger=0]="DefaultingToConsoleLogger",e[e.DebugMode=1]="DebugMode",e[e.RequestForClipperInstalledPageUrl=2]="RequestForClipperInstalledPageUrl",e[e.General=3]="General"}(t=e.Label||(e.Label={}));var n;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Verbose=4]="Verbose"}(n=e.Level||(e.Level={}))}(r=n.Trace||(n.Trace={}))},{}],34:[function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.warn=function(e,t){console.warn(e,t)},e.prototype.error=function(e,t){console.error(e,t)},e.prototype.info=function(e,t){console.info(e,t)},e.prototype.log=function(e,t){console.log(e,t)},e}();n.WebConsole=r},{}],35:[function(e,t,n){"use strict";var r;!function(e){function t(e){return"number"==typeof e&&!isNaN(e)}function n(e){return null===e||void 0===e}e.isNumeric=t,e.isNullOrUndefined=n}(r=n.ObjectUtils||(n.ObjectUtils={}))},{}],36:[function(e,t,n){"use strict";var r;!function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(r=n.OperationResult||(n.OperationResult={}))},{}],37:[function(e,t,n){"use strict";var r,o=e("../settings.json");!function(t){function n(e){var t=o[e];if(t&&t.Value)return t.Value}function r(t){o=t?t:e("../settings.json")}t.getSetting=n,t.setSettingsJsonForTesting=r}(r=n.Settings||(n.Settings={}))},{"../settings.json":40}],38:[function(e,t,n){"use strict";var r,o=e("./objectUtils"),i=e("./operationResult"),a=e("./localization/localization"),s=e("lodash");!function(e){function t(e,t){if(o.ObjectUtils.isNullOrUndefined(e))return r("");if(e=e.trim(),""===e)return r("");for(var i=e.split(","),a=[],u=0;u<i.length;++u){var l=[],c=void 0,p=i[u].trim();if(""!==p){
unsupportedBrowser.js:1:!function(){function e(t,o,n){function i(a,s){if(!o[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[a]={exports:{}};t[a][0].call(c.exports,function(e){var o=t[a][1][e];return i(o||e)},c,c.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}return e}()({1:[function(e,t,o){"use strict";var n;!function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed"}(n=o.Status||(o.Status={}))},{}],2:[function(e,t,o){"use strict";var n,i=e("../extensions/invokeSource");!function(e){e[e.ChangeLog=0]="ChangeLog",e[e.Pdf=1]="Pdf",e[e.Product=2]="Product",e[e.Recipe=3]="Recipe",e[e.Video=4]="Video",e[e.WhatsNew=5]="WhatsNew"}(n=o.TooltipType||(o.TooltipType={}));var r;!function(e){function t(e){switch(e){case n.Pdf:return i.InvokeSource.PdfTooltip;case n.Product:return i.InvokeSource.ProductTooltip;case n.Recipe:return i.InvokeSource.RecipeTooltip;case n.Video:return i.InvokeSource.VideoTooltip;case n.WhatsNew:return i.InvokeSource.WhatsNewTooltip;default:throw Error("Invalid TooltipType passed in TooltipType.toInvokeSource")}}e.toInvokeSource=t}(r=o.TooltipTypeUtils||(o.TooltipTypeUtils={}))},{"../extensions/invokeSource":6}],3:[function(e,t,o){"use strict";var n=e("../constants"),i=e("../polyfills"),r=e("../extensions/extensionUtils"),a=e("../localization/localization"),s=e("../localization/localizationHelper"),l=e("./status"),p=function(){function e(){this.state=this.getInitialState()}return e.prototype.getInitialState=function(){return{localizedStringFetchAttemptCompleted:l.Status.NotStarted}},e.prototype.setState=function(e){m.startComputation();for(var t in e)e.hasOwnProperty(t)&&(this.state[t]=e[t]);m.endComputation()},e.componentize=function(){var e=this,t=function(){};return t.controller=function(t){return new e(t)},t.view=function(e,t){return e.props=t,e.render()},t},e.prototype.fetchLocalizedStrings=function(e){var t=this;this.setState({localizedStringFetchAttemptCompleted:l.Status.InProgress}),s.LocalizationHelper.makeLocStringsFetchRequest(e).then(function(e){try{a.Localization.setLocalizedStrings(JSON.parse(e.parsedResponse)),t.setState({localizedStringFetchAttemptCompleted:l.Status.Succeeded})}catch(e){t.setState({localizedStringFetchAttemptCompleted:l.Status.Failed})}}).catch(function(){t.setState({localizedStringFetchAttemptCompleted:l.Status.Failed})})},e.prototype.attemptingFetchLocalizedStrings=function(){return this.state.localizedStringFetchAttemptCompleted===l.Status.NotStarted||this.state.localizedStringFetchAttemptCompleted===l.Status.InProgress},e.prototype.render=function(){return this.state.localizedStringFetchAttemptCompleted===l.Status.NotStarted&&this.fetchLocalizedStrings(navigator.language||navigator.userLanguage),{tag:"div",attrs:{id:n.Constants.Ids.unsupportedBrowserContainer},children:[{tag:"div",attrs:{id:n.Constants.Ids.unsupportedBrowserPanel,class:"panelContent"},children:[{tag:"div",attrs:{className:n.Constants.Classes.heightAnimator,style:"min-height: 276px; max-height: 276px;"},children:[{tag:"div",attrs:{className:n.Constants.Classes.panelAnimator,style:"left: 0px; opacity: 1;"},children:[{tag:"div",attrs:{id:n.Constants.Ids.signInContainer},children:[{tag:"div",attrs:{className:"signInPadding"},children:[{tag:"img",attrs:{id:n.Constants.Ids.signInLogo,src:r.ExtensionUtils.getImageResourceUrl("onenote_logo_clipper.png")}},{tag:"div",attrs:{id:n.Constants.Ids.signInMessageLabelContainer,class:"messageLabelContainer"},children:[{tag:"span",attrs:{class:"messageLabel",style:a.Localization.getFontFamilyAsStyle(a.Localization.FontFamily.Regular)},children:[this.attemptingFetchLocalizedStrings()?"":a.Localization.getLocalizedString("WebClipper.Label.OneNoteClipper")]}]},{tag:"div",attrs:{class:"signInDescription"},children:[{tag:"span",attrs:{id:n.Constants.Ids.signInText,style:a.Localization.getFontFamilyAsStyle(a.Localization.FontFamily.Light)},children:[this.attemptingFetchLocalizedStrings()?"":a.Localization.getLocalizedString("WebClipper.Label.UnsupportedBrowser")]}]}]}]}]}]}]}]}},e}();i.Polyfills.init();var c=p.componentize();o.UnsupportedBrowser=c,m.mount(document.getElementById("clipperUIPlaceholder"),c)},{"../constants":4,"../extensions/extensionUtils":5,"../localization/localization":9,"../localization/localizationHelper":10,"../polyfills":12,"./status":1}],4:[function(e,t,o){"use strict";var n;!function(e){var t;!function(e){e.heightAnimator="height-animator",e.panelAnimator="panel-animator",e.clearfix="clearfix",e.change="change",e.changes="changes",e.changeBody="change-body",e.changeDescription="change-description",e.changeImage="change-image",e.changeTitle="change-title",e.checkboxCheck="checkboxCheck",e.textAreaInput="textAreaInput",e.textAreaInputMirror="textAreaInputMirror",e.popover="popover",e.popoverArrow="popover-arrow",e.deleteHighlightButton="delete-highlight",e.highlightable="highlightable",e.highlighted="highlighted",e.regionSelection="region-selection",e.regionSelectionImage="region-selection-image",e.regionSelectionRemoveButton="region-selection-remove-button",e.attachmentOverlay="attachment-overlay",e.centeredInCanvas="centered-in-canvas",e.overlay="overlay",e.overlayHidden="overlay-hidden",e.overlayNumber="overlay-number",e.pdfPreviewImage="pdf-preview-image",e.pdfPreviewImageCanvas="pdf-preview-image-canvas",e.unselected="unselected",e.localPdfPanelTitle="local-pdf-panel-title",e.localPdfPanelSubtitle="local-pdf-panel-subtitle",e.radioIndicatorFill="radio-indicator-fill",e.spinner="spinner",e.srOnly="sr-only",e.tooltip="tooltip",e.centeredInPreview="centered-in-preview"}(t=e.Classes||(e.Classes={}));var o;!function(e){e.clipperInfo="ClipperInfo"}(o=e.Cookies||(e.Cookies={}));var n;!function(e){var t;!function(e){e.conflictingExtension="conflictingExtension"}(t=e.NotificationIds||(e.NotificationIds={}))}(n=e.Extension||(e.Extension={}));var i;!function(e){e.annotationContainer="annotationContainer",e.annotationField="annotationField",e.annotationFieldMirror="annotationFieldMirror",e.annotationPlaceholder="annotationPlaceholder",e.bookmarkThumbnail="bookmarkThumbnail",e.bookmarkPreviewContentContainer="bookmarkPreviewContentContainer",e.bookmarkPreviewInnerContainer="bookmarkPreviewInnerContainer",e.clipperApiProgressContainer="clipperApiProgressContainer",e.clipProgressDelayedMessage="clipProgressDelayedMessage",e.clipProgressIndicatorMessage="clipProgressIndicatorMessage",e.dialogBackButton="dialogBackButton",e.dialogButtonContainer="dialogButtonContainer",e.dialogDebugMessageContainer="dialogDebugMessageContainer",e.dialogMessageContainer="dialogMessageContainer",e.dialogContentContainer="dialogContentContainer",e.dialogMessage="dialogMessage",e.dialogSignOutButton="dialogSignoutButton",e.dialogTryAgainButton="dialogTryAgainButton",e.highlightablePreviewBody="highlightablePreviewBody",e.apiErrorMessage="apiErrorMessage",e.backToHomeButton="backToHomeButton",e.clipperFailureContainer="clipperFailureContainer",e.refreshPageButton="refreshPageButton",e.tryAgainButton="tryAgainButton",e.clipperFooterContainer="clipperFooterContainer",e.currentUserControl="currentUserControl",e.currentUserDetails="currentUserDetails",e.currentUserEmail="currentUserEmail",e.currentUserId="currentUserId",e.currentUserName="currentUserName",e.feedbackButton="feedbackButton",e.feedbackImage="feedbackImage",e.signOutButton="signOutButton",e.userDropdownArrow="userDropdownArrow",e.userSettingsContainer="userSettingsContainer",e.feedbackLabel="feedbackLabel",e.footerButtonsContainer="footerButtonsContainer",e.clipperLoadingContainer="clipperLoadingContainer",e.closeButton="closeButton",e.closeButtonContainer="closeButtonContainer",e.mainController="mainController",e.saveToLocationContainer="saveToLocationContainer",e.clipButton="clipButton",e.clipButtonContainer="clipButtonContainer",e.optionLabel="optionLabel",e.radioAllPagesLabel="radioAllPagesLabel",e.radioPageRangeLabel="radioPageRangeLabel",e.rangeInput="rangeInput",e.previewBody="previewBody",e.previewContentContainer="previewContentContainer",e.previewHeader="previewHeader",e.previewHeaderContainer="previewHeaderContainer",e.previewHeaderInput="previewHeaderInput",e.previewHeaderInputMirror="previewHeaderInputMirror",e.previewTitleContainer="previewTitleContainer",e.previewSubtitleContainer="previewSubtitleContainer",e.previewInnerContainer="previewInnerContainer",e.previewAriaLiveDiv="previewAriaLiveDiv",e.previewOptionsContainer="previewOptionsContainer",e.previewInnerWrapper="previewInnerWrapper",e.previewOuterContainer="previewOuterContainer",e.previewUrlContainer="previewUrlContainer",e.previewNotesContainer="previewNotesContainer",e.fullPageControl="fullPageControl",e.fullPageHeaderTitle="fullPageHeaderTitle",e.localPdfFileTitle="localPdfFileTitle",e.pdfControl="pdfControl",e.pdfHeaderTitle="pdfHeaderTitle",e.pageRangeControl="pageRangeControl",e.checkboxToDistributePages="checkboxToDistributePages",e.pdfIsTooLargeToAttachIndicator="pdfIsTooLargeToAttachIndicator",e.checkboxToAttachPdf="checkboxToAttachPdf",e.moreClipOptions="moreClipOptions",e.addAnotherRegionButton="addAnotherRegionButton",e.addRegionControl="addRegionControl",e.regionControl="regionControl",e.regionHeaderTitle="regionHeaderTitle",e.decrementFontSize="decrementFontSize",e.fontSizeControl="fontSizeControl",e.highlightButton="highlightButton",e.highlightControl="highlightControl",e.incrementFontSize="incrementFontSize",e.serifControl="serifControl",e.sansSerif="sansSerif",e.serif="serif",e.bookmarkControl="bookmarkControl",e.bookmarkHeaderTitle="bookmarkHeaderTitle",e.ratingsButtonFeedbackNo="ratingsButtonFeedbackNo",e.ratingsButtonFeedbackYes="ratingsButtonFeedbackYes",e.ratingsButtonInitNo="ratingsButtonInitNo",e.ratingsButtonInitYes="ratingsButtonInitYes",e.ratingsButtonRateNo="ratingsButtonRateNo",e.ratingsButtonRateYes="ratingsButtonRateYes",e.ratingsPromptContainer="ratingsPromptContainer",e.regionInstructionsContainer="regionInstructionsContainer",e.regionClipCancelButton="regionClipCancelButton",e.innerFrame="innerFrame",e.outerFrame="outerFrame",e.regionSelectorContainer="regionSelectorContainer",e.spinnerText="spinnerText",e.locationPickerContainer="locationPickerContainer",e.sectionLocationContainer="sectionLocationContainer",e.signInButtonMsa="signInButtonMsa",e.signInButtonOrgId="signInButtonOrgId",e.signInContainer="signInContainer",e.signInErrorCookieInformation="signInErrorCookieInformation",e.signInErrorDebugInformation="signInErrorDebugInformation",e.signInErrorDebugInformationDescription="signInErrorDebugInformationDescription",e.signInErrorDebugInformationContainer="signInErrorDebugInformationContainer",e.signInErrorDebugInformationList="signInErrorDebugInformationList",e.signInErrorDescription="signInErrorDescription",e.signInErrorDescriptionContainer="signInErrorDescriptionContainer",e.signInErrorMoreInformation="signInErrorMoreInformation",e.signInLogo="signInLogo",e.signInMessageLabelContainer="signInMessageLabelContainer",e.signInText="signInText",e.signInToggleErrorDropdownArrow="signInToggleErrorDropdownArrow",e.signInToggleErrorInformationText="signInToggleErrorInformationText",e.clipperSuccessContainer="clipperSuccessContainer",e.launchOneNoteButton="launchOneNoteButton",e.pageNavAnimatedTooltip="pageNavAnimatedTooltip",e.unsupportedBrowserContainer="unsupportedBrowserContainer",e.unsupportedBrowserPanel="unsupportedBrowserPanel",e.changeLogSubPanel="changeLogSubPanel",e.checkOutWhatsNewButton="checkOutWhatsNewButton",e.proceedToWebClipperButton="proceedToWebClipperButton",e.whatsNewTitleSubPanel="whatsNewTitleSubPanel",e.clipperRootScript="oneNoteCaptureRootScript",e.clipperUiFrame="oneNoteWebClipper",e.clipperPageNavFrame="oneNoteWebClipperPageNav",e.clipperExtFrame="oneNoteWebClipperExtension",e.brandingContainer="brandingContainer"}(i=e.Ids||(e.Ids={}));var r;!function(e){e.accept="Accept",e.appIdKey="MS-Int-AppId",e.correlationId="X-CorrelationId",e.noAuthKey="X-NoAuth",e.userSessionIdKey="X-UserSessionId"}(r=e.HeaderValues||(e.HeaderValues={}));var a;!function(e){e.debugLoggingInjectedAndExtension="DEBUGLOGGINGINJECTED_AND_EXTENSION",e.extensionAndUi="EXTENSION_AND_UI",e.injectedAndUi="INJECTED_AND_UI",e.injectedAndExtension="INJECTED_AND_EXTENSION",e.extensionAndPageNavUi="EXTENSION_AND_PAGENAVUI",e.pageNavInjectedAndPageNavUi="PAGENAVINJECTED_AND_PAGENAVUI",e.pageNavInjectedAndExtension="PAGENAVINJECTED_AND_EXTENSION"}(a=e.CommunicationChannels||(e.CommunicationChannels={}));var s;!function(e){e.clipperStrings="CLIPPER_STRINGS",e.clipperStringsFrontLoaded="CLIPPER_STRINGS_FRONT_LOADED",e.closePageNavTooltip="CLOSE_PAGE_NAV_TOOLTIP",e.createHiddenIFrame="CREATE_HIDDEN_IFRAME",e.ensureFreshUserBeforeClip="ENSURE_FRESH_USER_BEFORE_CLIP",e.escHandler="ESC_HANDLER",e.getInitialUser="GET_INITIAL_USER",e.getPageNavTooltipProps="GET_PAGE_NAV_TOOLTIP_PROPS",e.getStorageValue="GET_STORAGE_VALUE",e.getMultipleStorageValues="GET_MULTIPLE_STORAGE_VALUES",e.getTooltipToRenderInPageNav="GET_TOOLTIP_TO_RENDER_IN_PAGE_NAV",e.hideUi="HIDE_UI",e.invokeClipper="INVOKE_CLIPPER",e.invokeClipperFromPageNav="INVOKE_CLIPPER_FROM_PAGE_NAV",e.invokeDebugLogging="INVOKE_DEBUG_LOGGING",e.invokePageNav="INVOKE_PAGE_NAV",e.extensionNotAllowedToAccessLocalFiles="EXTENSION_NOT_ALLOWED_TO_ACCESS_LOCAL_FILES",e.noOpTracker="NO_OP_TRACKER",e.onSpaNavigate="ON_SPA_NAVIGATE",e.refreshPage="REFRESH_PAGE",e.showRefreshClipperMessage="SHOW_REFRESH_CLIPPER_MESSAGE",e.setInjectOptions="SET_INJECT_OPTIONS",e.setInvokeOptions="SET_INVOKE_OPTIONS",e.setStorageValue="SET_STORAGE_VALUE",e.signInUser="SIGN_IN_USER",e.signOutUser="SIGN_OUT_USER",e.tabToLowestIndexedElement="TAB_TO_LOWEST_INDEXED_ELEMENT",e.takeTabScreenshot="TAKE_TAB_SCREENSHOT",e.telemetry="TELEMETRY",e.toggleClipper="TOGGLE_CLIPPER",e.unloadHandler="UNLOAD_HANDLER",e.updateFrameHeight="UPDATE_FRAME_HEIGHT",e.updatePageInfoIfUrlChanged="UPDATE_PAGE_INFO_IF_URL_CHANGED"}(s=e.FunctionKeys||(e.FunctionKeys={}));var l;!function(e){e.tab=9,e.enter=13,e.esc=27,e.c=67,e.down=40,e.up=38,e.left=37,e.right=39,e.space=32,e.home=36,e.end=35}(l=e.KeyCodes||(e.KeyCodes={}));var p;!function(e){e.c="KeyC"}(p=e.StringKeyCodes||(e.StringKeyCodes={}));var c;!function(e){e.clientInfo="CLIENT_INFO",e.isFullScreen="IS_FULL_SCREEN",e.pageInfo="PAGE_INFO",e.sessionId="SESSION_ID",e.user="USER"}(c=e.SmartValueKeys||(e.SmartValueKeys={}));var u;!function(e){e.sectionPickerContainerHeight=280,e.clipperUiWidth=322,e.customCursorSize=20,e.clipperUiTopRightOffset=20,e.clipperUiDropShadowBuffer=7,e.clipperUiInnerPadding=30;var t;!function(e){e.oneNoteHighlightColor="#fefe56"}(t=e.Colors||(e.Colors={}))}(u=e.Styles||(e.Styles={}));var d;!function(e){e.serviceDomain="https://www.onenote.com",e.augmentationApiUrl=e.serviceDomain+"/onaugmentation/clipperextract/v1.0/",e.changelogUrl=e.serviceDomain+"/whatsnext/webclipper",e.clipperFeedbackUrl=e.serviceDomain+"/feedback",e.clipperInstallPageUrl=e.serviceDomain+"/clipper/installed",e.fullPageScreenshotUrl=e.serviceDomain+"/onaugmentation/clipperDomEnhancer/v1.0/",e.localizedStringsUrlBase=e.serviceDomain+"/strings?ids=WebClipper.",e.msaDomain="https://login.live.com",e.orgIdDomain="https://login.microsoftonline.com",e.userDataBoundaryDomain="https://odc.officeapps.live.com/odc/v2.1/federationprovider";var t;!function(t){t.authRedirectUrl=e.serviceDomain+"/webclipper/auth",t.signInUrl=e.serviceDomain+"/webclipper/signin",t.signOutUrl=e.serviceDomain+"/weclipper/signout",t.userInformationUrl=e.serviceDomain+"/webclipper/userinfo"}(t=e.Authentication||(e.Authentication={}));var o;!function(e){e.authType="authType",e.category="category",e.changelogLocale="omkt",e.channel="channel",e.clientType="clientType",e.clipperId="clipperId",e.clipperVersion="clipperVersion",e.correlationId="correlationId",e.error="error",e.errorDescription="error_?description",e.event="event",e.eventName="eventName",e.failureId="failureId",e.failureInfo="failureInfo",e.failureType="failureType",e.inlineInstall="inlineInstall",e.label="label",e.noOpType="noOpType",e.stackTrace="stackTrace",e.timeoutInMs="timeoutInMs",e.url="url",e.userSessionId="userSessionId",e.wdFromClipper="wdfroclipper",e.domain="domain"}(o=e.QueryParams||(e.QueryParams={}))}(d=e.Urls||(e.Urls={}));var g;!function(e){e.oneNoteClipperUsage="OneNoteClipperUsage"}(g=e.LogCategories||(e.LogCategories={}));var h;!function(e){e.fontSizeStep=2,e.maxClipSuccessForRatingsPrompt=12,e.maximumJSTimeValue=864e13,e.maximumFontSize=72,e.maximumNumberOfTimesToShowTooltips=3,e.maximumMimeSizeLimit=249e5,e.minClipSuccessForRatingsPrompt=4,e.minimumFontSize=8,e.minTimeBetweenBadRatings=6048e6,e.noOpTrackerTimeoutDuration=2e4,e.numRetriesPerPatchRequest=3,e.pdfCheckCreatePageInterval=2e3,e.pdfClippingMessageDelay=5e3,e.pdfExtraPageLoadEachSide=1,e.pdfInitialPageLoadCount=3,e.timeBetweenDifferentTooltips=6048e5,e.timeBetweenSameTooltip=18144e5,e.timeBetweenTooltips=18144e5,e.timeUntilPdfPageNumbersFadeOutAfterScroll=1e3}(h=e.Settings||(e.Settings={}));var f;!function(e){e.setNameForArrowKeyNav="setnameforarrowkeynav"}(f=e.CustomHtmlAttributes||(e.CustomHtmlAttributes={}));var m;!function(e){e.modeButtonSet="ariaModeButtonSet",e.pdfPageSelection="pdfPageSelection",e.serifGroupSet="serifGroupSet"}(m=e.AriaSet||(e.AriaSet={}))}(n=o.Constants||(o.Constants={}))},{}],5:[function(e,t,o){"use strict";var n;!function(e){function t(e){return("images/"+e).toLowerCase()}e.getImageResourceUrl=t}(n=o.ExtensionUtils||(o.ExtensionUtils={}))},{}],6:[function(e,t,o){"use strict";var n;!function(e){e[e.Bookmarklet=0]="Bookmarklet",e[e.ContextMenu=1]="ContextMenu",e[e.ExtensionButton=2]="ExtensionButton",e[e.WhatsNewTooltip=3]="WhatsNewTooltip",e[e.PdfTooltip=4]="PdfTooltip",e[e.ProductTooltip=5]="ProductTooltip",e[e.RecipeTooltip=6]="RecipeTooltip",e[e.VideoTooltip=7]="VideoTooltip"}(n=o.InvokeSource||(o.InvokeSource={}))},{}],7:[function(e,t,o){"use strict";var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},i=e("./http"),r=e("../objectUtils"),a=e("../promiseUtils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.get=function(t,o,n,r,s){var l=this;void 0===n&&(n=i.Http.defaultTimeout),void 0===r&&(r=[200]);var p=function(){return e.createAndSendRequest.call(l,"GET",t,o,r,n)};return a.PromiseUtils.execWithRetry(p,s)},t.post=function(t,o,n,s,l,p){var c=this;if(void 0===s&&(s=[200]),void 0===l&&(l=i.Http.defaultTimeout),r.ObjectUtils.isNullOrUndefined(o))throw new Error("data must be a non-undefined object, but was: "+o);var u=function(){return e.createAndSendRequest.call(c,"POST",t,n,s,l,o)};return a.PromiseUtils.execWithRetry(u,p)},t}(i.Http);o.HttpWithRetries=s},{"../objectUtils":11,"../promiseUtils":13,"./http":8}],8:[function(e,t,o){"use strict";var n=e("../objectUtils"),i=function(){function e(){}return e.get=function(t,o,n,i){return void 0===n&&(n=e.defaultTimeout),void 0===i&&(i=[200]),e.createAndSendRequest("GET",t,o,i,n)},e.post=function(t,o,i,r,a){if(void 0===r&&(r=[200]),void 0===a&&(a=e.defaultTimeout),n.ObjectUtils.isNullOrUndefined(o))throw new Error("data must be a non-undefined object, but was: "+o);return e.createAndSendRequest("POST",t,i,r,a,o)},e.createAndSendRequest=function(t,o,n,i,r,a){if(void 0===i&&(i=[200]),void 0===r&&(r=e.defaultTimeout),!o)throw new Error("url must be a non-empty string, but was: "+o);return new Promise(function(s,l){var p=new XMLHttpRequest;p.open(t,o),p.onload=function(){i.indexOf(p.status)>-1?s(p):l(OneNoteApi.ErrorUtils.createRequestErrorObject(p,OneNoteApi.RequestErrorType.UNEXPECTED_RESPONSE_STATUS))},p.onerror=function(){l(OneNoteApi.ErrorUtils.createRequestErrorObject(p,OneNoteApi.RequestErrorType.NETWORK_ERROR))},p.ontimeout=function(){l(OneNoteApi.ErrorUtils.createRequestErrorObject(p,OneNoteApi.RequestErrorType.REQUEST_TIMED_OUT))},e.setHeaders(p,n),p.timeout=r,p.send(a)})},e.setHeaders=function(e,t){if(t)for(var o in t)e.setRequestHeader(o,t[o])},e}();i.defaultTimeout=3e4,o.Http=i},{"../objectUtils":11}],9:[function(e,t,o){"use strict";var n;!function(t){function o(e){if(!e)throw new Error("stringId must be a non-empty string, but was: "+e);if(l){var t=l[e];if(t)return t}var o=c[e];if(o)return o;throw new Error("getLocalizedString could not find a localized or fallback string: "+e)}function n(e){l=e}function i(e){return"font-family: "+r(e)+";"}function r(e){if(p[e])return p[e];var t="WebClipper.FontFamily."+s[e].toString(),n=o(t);return p[e]=a(n),p[e]}function a(e){if(!e)return"";for(var t=e.split(","),o=0;o<t.length;o++)t[o]=t[o].trim(),t[o].length>0&&t[o].indexOf(" ")>=0&&"'"!==t[o][0]&&"'"!==t[o][t.length-1]&&(t[o]="'"+t[o]+"'");return t.join(",")}var s;!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Light=2]="Light",e[e.Semibold=3]="Semibold",e[e.Semilight=4]="Semilight"}(s=t.FontFamily||(t.FontFamily={}));var l,p={},c=e("../../strings.json");t.getLocalizedString=o,t.setLocalizedStrings=n,t.getFontFamilyAsStyle=i,t.getFontFamily=r,t.formatFontFamily=a}(n=o.Localization||(o.Localization={}))},{"../../strings.json":17}],10:[function(e,t,o){"use strict";var n=e("../constants"),i=e("../urlUtils"),r=e("../http/HttpWithRetries"),a=function(){function e(){}return e.makeLocStringsFetchRequest=function(e){var t=i.UrlUtils.addUrlQueryValue(n.Constants.Urls.localizedStringsUrlBase,"locale",e);return r.HttpWithRetries.get(t).then(function(e){return Promise.resolve({request:e,parsedResponse:e.responseText})})},e}();o.LocalizationHelper=a},{"../constants":4,"../http/HttpWithRetries":7,"../urlUtils":15}],11:[function(e,t,o){"use strict";var n;!function(e){function t(e){return"number"==typeof e&&!isNaN(e)}function o(e){return null===e||void 0===e}e.isNumeric=t,e.isNullOrUndefined=o}(n=o.ObjectUtils||(o.ObjectUtils={}))},{}],12:[function(e,t,o){"use strict";var n,i=e("es6-promise");!function(e){function t(){o(),n(),r(),a()}function o(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var o=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>o.length)&&(t=o.length),t-=e.length;var n=o.lastIndexOf(e,t);return n!==-1&&n===t})}function n(){"function"!=typeof Object.assign&&(Object.assign=function(e){if(!e)throw new TypeError("Cannot convert undefined to object");for(var t=Object(e),o=1;o<arguments.length;o++){var n=arguments[o];if(n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t})}function r(){"undefined"==typeof Promise&&i.polyfill()}function a(){window.requestAnimationFrame||(window.requestAnimationFrame=window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(e){setTimeout(function(){e(Date.now())},16)})}e.init=t}(n=o.Polyfills||(o.Polyfills={}))},{"es6-promise":18}],13:[function(e,t,o){"use strict";var n;!function(e){function t(e){return new Promise(function(t){setTimeout(function(){t()},e)})}function o(e,t){return void 0===t&&(t={retryCount:3,retryWaitTimeInMs:3e3}),e().catch(function(n){return t.retryCount>0?new Promise(function(n,i){setTimeout(function(){t.retryCount--,o(e,t).then(function(e){n(e)}).catch(function(e){i(e)})},t.retryWaitTimeInMs)}):Promise.reject(n)})}e.wait=t,e.execWithRetry=o}(n=o.PromiseUtils||(o.PromiseUtils={}))},{}],14:[function(e,t,o){"use strict";var n,i=e("../settings.json");!function(t){function o(e){var t=i[e];if(t&&t.Value)return t.Value}function n(t){i=t?t:e("../settings.json")}t.getSetting=o,t.setSettingsJsonForTesting=n}(n=o.Settings||(o.Settings={}))},{"../settings.json":16}],15:[function(e,t,o){"use strict";var n,i=e("./objectUtils"),r=e("./settings"),a=e("./clipperUI/tooltipType");!function(e){function t(e,t){for(var o=0;o<t.length;++o){var n=t[o],i=a.TooltipType[n],s=r.Settings.getSetting(i+"Domains"),l=new RegExp(s.join("|"),"i");if(l.test(e))return n}}function o(e,t){if(!e)return t;var o=/\/(?=[^\/]+\.\w{3,4}$).+/g.exec(e);return o&&o[0]?o[0].slice(1):t}function n(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+"/"}function s(e){var t=document.createElement("a");t.href=e;var o=t.pathname;return l(o)}function l(e){return e=i.ObjectUtils.isNullOrUndefined(e)?"/":e,e.length>0&&"/"===e.charAt(0)?e:"/"+e}function p(e,t){if(e&&t){var o=t.replace(/[\[\]]/g,"\\$&"),n=new RegExp("[?&]"+o+"(=([^&#]*)|&|#|$)","i"),i=n.exec(e);if(i)return i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):""}}function c(e,t,o,n){if(void 0===n&&(n=!1),!e||!t||!o)return e;n&&(t=t.charAt(0).toUpperCase()+t.slice(1));var i=e.match(/^([^#]*)(#.*)?$/),r=i[1],a=i[2]?i[2]:"",s=r.indexOf("?");if(s===-1)return r+"?"+t+"="+o+a;if(s===r.length-1)return r+t+"="+o+a;for(var l=r.substring(s+1).split("&"),p=0;p<l.length;p++){var c=l[p].split("=");if(c[0]===t)return l[p]=c[0]+"="+o,r.substring(0,s+1)+l.join("&")+a}return r+"&"+t+"="+o+a}function u(e){return g(e,["PageNav_BlacklistedDomains"])}function d(e){return g(e,["AugmentationDefault_WhitelistedDomains","ProductDomains","RecipeDomains"])}function g(e,t){if(!e)return!1;var o=[];t.forEach(function(e){o=o.concat(r.Settings.getSetting(e))});for(var n=0,i=o;n<i.length;n++){var a=i[n];if(new RegExp(a).test(e))return!0}return!1}e.checkIfUrlMatchesAContentType=t,e.getFileNameFromUrl=o,e.getHostname=n,e.getPathname=s,e.getQueryValue=p,e.addUrlQueryValue=c,e.onBlacklistedDomain=u,e.onWhitelistedDomain=d}(n=o.UrlUtils||(o.UrlUtils={}))},{"./clipperUI/tooltipType":2,"./objectUtils":11,"./settings":14}],16:[function(e,t,o){t.exports={DummyObjectForTestingPurposes:{Description:"Do not remove under any circumstances!",Value:"Testing."},AugmentationDefault_WhitelistedDomains:{Description:"The set of domains on which we are changing the default clip mode to Augmentation.",Value:["^https?:\\/\\/www\\.onenote\\.com","[^\\w]wikipedia","[^\\w]nytimes","[^\\w]lifehacker","[^\\w]msn","[^\\w]theguardian","[^\\w]forbes","[^\\w]bbc","[^\\w]huffingtonpost","[^\\w]businessinsider","[^\\w]washingtonpost","[^\\w]medium","[^\\w]buzzfeed","[^\\w]bbc","[^\\w]theverge","[^\\w]techcrunch","[^\\w]amazon","[^\\w]allrecipes","[^\\w]foodnetwork","[^\\w]seriouseats","[^\\w]epicurious","[^\\w]support.office.com","[^\\w]blogs.office.com","[^\\w]blogs.technet.com","[^\\w]youtube\\.com\\/watch(\\?v=(\\w+)|.*\\&v=(\\w+))","[^\\w]youtube\\.com\\/embed\\/(\\w+)","[^\\w]vimeo\\.com.*?\\/(\\d+)($|\\?|\\#|\\/$)","[^\\w]vimeo\\.com.*?\\/(\\d+)\\/\\w+:\\w+(\\/|$)","[^\\w]vimeo\\.com.*?\\/ondemand\\/\\w+$","[^\\w]khanacademy\\.org(.*)/v/(.*)","\\/(\\d{2}|\\d{4})\\/\\d{1,2}\\/","\\/(\\d{2}|\\d{4})-\\d{1,2}-\\d{1,2}\\/"]},PageNav_BlacklistedDomains:{Description:"The set of domains where we do not want to show any PageNav tooltip experience",Value:["^(http(s)?)://(login\\.live\\.com)","^(http(s)?)://(login\\.microsoftonline\\.com)"]},PdfDomains:{Description:"PDF regexes",Value:["^.*(\\.pdf)$"]},RecipeDomains:{Description:"The set of domains where we want to show a Recipe tooltip",Value:["^(http(s)?)://(12tomatoes\\.com/)()([^/]*-[^/]*)/$","^(http(s)?)://(abc\\.go\\.com/shows/the-chew/recipes/)([^/]*-[^/]*)$","^(http(s)?)://(([^ ]{1,18})?)(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://((\\.{1,18}\\.)?)(allrecipes\\.)(com)/(recipe/[^/]+(/)?(/detail\\.aspx\\??)?)$","^(http(s)?)://()(allrecipes\\.com)()/([r|R]ecipe/[^/]+/Detail\\.aspx)$","^(http(s)?)://()(allrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(cookieandkate\\.com)()/(\\d{4})/(.+)$","^(http(s)?)://(cooking\\.)(nytimes\\.com)()/(recipes/(.*))$","^(http(s)?)://()(cookpad\\.com)()/(recipe/[0-9]+$)$","^(http(s)?)://()(damndelicious\\.net)()/\\d+/\\d+/\\d+/.+/$","^(http(s)?)://(food52\\.com)()/recipes/[0-9]+-.+$","^(http(s)?)://(minimalistbaker.com)/([^/]*-[^/]*)/$","^(http(s)?)://(paleoleap.com)/([^/]*-[^/]*)/$","^(http(s)?)://(pinchofyum.com)/([^/]*-[^/]*)$","^(http(s)?)://(recipe\\.rakuten\\.co\\.jp)()/recipe/[0-9]+/$","^(http(s)?)://()(thepioneerwoman\\.com)()/(cooking/.+/)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([r|R]ecipe/[^/]+/(Detail\\.aspx)?)$","^(http(s)?)://((www\\.)?)(allrecipes\\.com)()/([R|r]ecipe/.*)$","^(http(s)?)://(www\\.)(bbc\\.co\\.uk/food/recipes/[^/]*_\\d+)$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)()/(recipes/[0-9]+/(.*))$","^(http(s)?)://(www\\.)(bbcgoodfood\\.com)/recipes/([^/]*-[^/]*)$","^(http(s)?)://(www\\.)(bettycrocker\\.com)()/(recipes/[^\\/]+/[0-9a-f-]{36}/?)$","^(http(s)?)://(www\\.)(bonappetit\\.com)()/(recipe/(.*))$","^(http(s)?)://(www\\.budgetbytes\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://((www\\.)?)(chowhound\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.cookingclassy\\.com)/\\d{4}/\\d{2}/(.*)/","^(http(s)?)://(www\\.delish\\.com)/cooking/recipe-ideas/recipes/a\\d+/[^/]*-[^/]*/","^(http(s)?)://(www\\.)(eatingwell\\.com)()/(recipe/\\d+/.+/)$","^(http(s)?)://(www\\.)(epicurious\\.com)()/(recipes/food/views/.*)$","^(http(s)?)://(www\\.)(food\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(foodandwine\\.com)()/(recipes\\/.+)$","^(http(s)?)://(www\\.)(foodnetwork)(\\.ca)/(recipe/(.*))$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipe-collections/.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes.*)$","^(http(s)?)://(www\\.)(foodnetwork\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/(([0-9]+|recipe)/.*)$","^(http(s)?)://(www\\.)(marthastewart\\.com)()/([0-9]+/[^/]+)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*-[0-9]*/)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/.*)$","^(http(s)?)://(www\\.)(myrecipes\\.com)()/(recipe/[^/]+.*)$","^(http(s)?)://(www\\.)(realsimple\\.com)()/(food-recipes/browse-all-recipes/[^\\/]+/index\\.html)$","^(http(s)?)://((www)?\\.)(seriouseats\\.com)()/([Rr]ecipes\\/.*\\.(html|HTML)(.*)?)$","^(http(s)?)://(www\\.)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/[^/]*/)$","^(http(s)?)://((www\\.)?)(simplyrecipes\\.com)()/(recipes/.*)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/([R|r]ecipes/[^/]+$)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^/]*/?)$","^(http(s)?)://(www\\.)(tasteofhome\\.com)()/(recipes/[^\\/]+/?)$","^(http(s)?)://(www\\.)(yummly\\.com)()/(recipe/[^/]+)$","^(http(s)?)://((www\\.)?)(yummly\\.com)()/(recipe/.*)$","^(http(s)?)://(.*)(yummly\\.com)()/(recipe/.+)$"]},ProductDomains:{Description:"The set of domains where we want to show a Product tooltip",Value:["^(http(s)?)://store\\.steampowered.com/app/\\d+/.*$","^(http(s)?)://(www\\.)(amazon\\.com)()/(gp/product/[^/]+/.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/(dp/[^/]+.*)$","^(http(s)?)://(www\\.)(amazon\\.com)()/([^/]+/dp/[^/]+)$","^(http(s)?)://(www\\.)(amazon\\.in)()/((.+/)?(dp|gp/product)\\/\\w{10,13}([^\\w].*)?)$","^(http(s)?)://(www\\.)(amazon\\.)([a-zA-Z\\.]+)/([^/]+/dp/.*)$","^(http(s)?)://(www\\.)(bedbathandbeyond\\.com)(/store/product/)([^/]*-[^/]*/)(\\d+.*)","^(http(s)?)://(www\\.)(ebay\\.com)()/(itm/[^/]+/.*)$","^(http(s)?)://(www\\.)(etsy\\.com)()/(listing)/(\\d+/.*)$","^(http(s)?)://(www\\.)(homedepot\\.com)()/(p/[^/]+/.*)$","^(http(s)?)://(www\\.)(newegg\\.com)()/(Product/Product\\.aspx\\?Item=.+)$","^(http(s)?)://(www\\.)(overstock\\.com)()/(.+/.+/[0-9]+/product\\.html.*)$","^(http(s)?)://(www\\.)(staples\\.com)()/(.*/product_[^/]+)$","^(http(s)?)://(www\\.)(target\\.com)()/(p/.+)$","^(http(s)?)://(www\\.)(walmart\\.com)()/(ip/.*)$"]},App_Id:{Description:"For identifying the Web Clipper during interaction with external services",Value:"OneNote Web Clipper"},Misc_Data_Endpoint_Id:{Description:"The id of the data endpoint used for miscellaneous logging",Value:"production"},Aria_Token:{Description:"For sending log events to the Aria production tenant 'OneNote Web Clipper (production)'",Value:"c7f3f24bc5f746d7b9d8f8e422fdd8a5-1cb58166-2598-485f-897c-1d3c8e62d30e-7560"
